using DocumentFormat.OpenXml.Packaging;
using SharedModels;

using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

using DocumentFormat.OpenXml;
using DocumentFormat.OpenXml.Drawing;
using DocumentFormat.OpenXml.Drawing.Charts;
using Newtonsoft.Json;
using DocumentFormat.OpenXml.Presentation;
using DocumentFormat.OpenXml.Spreadsheet;
using A = DocumentFormat.OpenXml.Drawing;
using P = DocumentFormat.OpenXml.Presentation;
using C = DocumentFormat.OpenXml.Drawing.Charts;
using System.Xml.Linq;
using System.Security.Cryptography;
using P14 = DocumentFormat.OpenXml.Office2010.PowerPoint;
using Ap = DocumentFormat.OpenXml.ExtendedProperties;
using System.Text.RegularExpressions;
using DocumentFormat.OpenXml.Drawing.ChartDrawing;
using DocumentFormat.OpenXml.Wordprocessing;
using System.Security.Policy;
using DocumentFormat.OpenXml.Office2013.Drawing.Chart;
using WebApplicationAPI.Models;

namespace ClassLibrary1
{
    public class DllTemplates
    {

        public const string DEFAULT_COLOR = "000000";
        public const int DEFAULT_FONT_SIZE = 1200;

        //FIT TO CONCEPT  HISTORICAL DATA
        public void FitToConceptTemplateForAll(string destination, List<FitToConceptModel> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    if (presentationDocument != null)
                    {
                        SlidePart slidePart = presentationDocument?.PresentationPart?.SlideParts?.First();
                        if (slidePart != null)
                        {
                            ChartPart chartPart = slidePart?.ChartParts?.First();
                            if (chartPart != null)
                            {
                                EmbeddedPackagePart embeddedPackagePart = chartPart?.EmbeddedPackagePart;
                                BarChart barChart = chartPart?.ChartSpace?.Descendants<BarChart>().First();

                                if (embeddedPackagePart != null)
                                {
                                    using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                    {
                                        if (spreadsheet != null)
                                        {
                                            WorksheetPart worksheetPart = spreadsheet?.WorkbookPart?.WorksheetParts?.First();

                                            if (worksheetPart != null)
                                            {
                                                SheetData sheetData = worksheetPart?.Worksheet?.Elements<SheetData>().FirstOrDefault();

                                                int excelDataIndex = 2;
                                                Cell cellVariableObj;

                                                apiData.Sort((x, y) => x.Average.CompareTo(y.Average));

                                                foreach (var apiVariables in apiData)
                                                {
                                                    cellVariableObj =
                                                        sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                    if (cellVariableObj != null)
                                                    {
                                                        cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                        cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                    }

                                                    cellVariableObj =
                                                        sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                    if (cellVariableObj != null)
                                                    {
                                                        cellVariableObj.CellValue = new CellValue(apiVariables.Average.ToString());
                                                        cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                    }
                                                    excelDataIndex++;
                                                }

                                                for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                                {
                                                    Row row = sheetData?.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                    if (row != null)
                                                    {
                                                        row.Remove();
                                                    }
                                                }
                                            }
                                        }

                                        char[] columns = { 'B' };
                                        int columnIndex = 0;

                                        if (barChart != null)
                                        {
                                            foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                           barChart?.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                            {
                                                if (columnIndex < columns.Length)
                                                {
                                                    char column = columns[columnIndex];

                                                    NumberReference numberReference =
                                                        barChartSeries?.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First().
                                                        Elements<NumberReference>().First();

                                                    if (numberReference != null)
                                                    {
                                                        numberReference.Formula =
                                                            new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                        NumberingCache numberingCache = numberReference?.Elements<NumberingCache>().First();

                                                        numberingCache.RemoveAllChildren();

                                                        int idx = 0;

                                                        foreach (var api in apiData)
                                                        {
                                                            numberingCache.Append(new NumericPoint()
                                                            {
                                                                Index = (uint)idx,
                                                                NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.Average.ToString("F2"))
                                                            });
                                                            idx++;
                                                        }
                                                    }
                                                }

                                                StringReference stringReference = barChartSeries?.Elements<CategoryAxisData>()
                                                                                    .First().Elements<StringReference>().First();

                                                if (stringReference != null)
                                                {
                                                    stringReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.
                                                        Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                                    StringCache stringCache = stringReference?.Elements<StringCache>().First();
                                                    stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                                    int catIdx = 0;

                                                    foreach (var api in apiData)
                                                    {
                                                        stringCache.Append(new StringPoint()
                                                        {
                                                            Index = (uint)catIdx,
                                                            NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                        });
                                                        catIdx++;
                                                    }
                                                }

                                                double historicalAvg = 0.00;

                                                /////////////original case/////////////////
                                                //if (apiData.FirstOrDefault().TestName.Equals("[Refreshed Hist. Mean]"))
                                                //{
                                                //    historicalAvg = Math.Round(apiData.FirstOrDefault().Average, 2);
                                                //}

                                                var meanValue = apiData.Where(x => x.TestName.Contains("Refreshed Hist. Mean")).ToList();

                                                if (meanValue.Count == 1)
                                                {
                                                    var value = meanValue[0].Average;
                                                    historicalAvg = Math.Round(value, 2);
                                                }

                                                C.DataLabels dataLabels = barChartSeries?.GetFirstChild<C.DataLabels>();

                                                int i = 0;

                                                if (dataLabels != null)
                                                {
                                                    if (meanValue != null)
                                                    {
                                                        foreach (var dataPoint in apiData)
                                                        {
                                                            C.DataLabel dataLabel = new C.DataLabel();
                                                            C.Index index = new C.Index() { Val = (uint)i };

                                                            C.ChartText chartText = new C.ChartText();
                                                            C.RichText richText = new C.RichText();
                                                            A.BodyProperties bodyProperties = new A.BodyProperties();
                                                            A.ListStyle listStyle = new A.ListStyle();

                                                            A.Paragraph paragraph = new A.Paragraph();
                                                            A.Run run = new A.Run();
                                                            A.RunProperties runProperties = new A.RunProperties() { Language = "en-US" };

                                                            double percentageValue = Math.Round(dataPoint.Average, 4);

                                                            A.Text text;

                                                            if (percentageValue <= historicalAvg)
                                                            {
                                                                text = new A.Text();
                                                                text.Text = $"{percentageValue:0.00}";
                                                            }
                                                            else
                                                            {
                                                                text = new A.Text();
                                                                text.Text = $"{percentageValue:0.00}*";
                                                            }

                                                            run.Append(runProperties);
                                                            run.Append(text);
                                                            paragraph.Append(run);

                                                            richText.Append(bodyProperties);
                                                            richText.Append(listStyle);
                                                            richText.Append(paragraph);

                                                            chartText.Append(richText);

                                                            dataLabel.Append(index);
                                                            dataLabel.Append(chartText);

                                                            dataLabel.Append(new C.ShowLegendKey() { Val = false });
                                                            dataLabel.Append(new C.ShowValue() { Val = true });
                                                            dataLabel.Append(new C.ShowCategoryName() { Val = false });
                                                            dataLabel.Append(new C.ShowSeriesName() { Val = false });
                                                            dataLabel.Append(new C.ShowPercent() { Val = false });
                                                            dataLabel.Append(new C.ShowBubbleSize() { Val = false });

                                                            C.ExtensionList extList = new C.ExtensionList();

                                                            C.Extension ext1 = new C.Extension() { Uri = "{CE6537A1-D6FC-4f65-9D91-7224C49458BB}" };
                                                            extList.Append(ext1);

                                                            C.Extension ext2 = new C.Extension() { Uri = "{C3380CC4-5D6E-409C-BE32-E72D297353CC}" };
                                                            extList.Append(ext2);

                                                            dataLabel.Append(extList);

                                                            dataLabels.Append(dataLabel);

                                                            i++;
                                                        }
                                                    }
                                                    else
                                                    {
                                                        foreach (var dataPoint in apiData)
                                                        {
                                                            C.DataLabel dataLabel = new C.DataLabel();
                                                            C.Index index = new C.Index() { Val = (uint)i };

                                                            C.ChartText chartText = new C.ChartText();
                                                            C.RichText richText = new C.RichText();
                                                            A.BodyProperties bodyProperties = new A.BodyProperties();
                                                            A.ListStyle listStyle = new A.ListStyle();

                                                            A.Paragraph paragraph = new A.Paragraph();
                                                            A.Run run = new A.Run();
                                                            A.RunProperties runProperties = new A.RunProperties() { Language = "en-US" };

                                                            double percentageValue = Math.Round(dataPoint.Average, 4);

                                                            A.Text text = new A.Text();
                                                            text.Text = $"{percentageValue:0.00}";

                                                            run.Append(runProperties);
                                                            run.Append(text);
                                                            paragraph.Append(run);

                                                            richText.Append(bodyProperties);
                                                            richText.Append(listStyle);
                                                            richText.Append(paragraph);

                                                            chartText.Append(richText);

                                                            dataLabel.Append(index);
                                                            dataLabel.Append(chartText);

                                                            dataLabel.Append(new C.ShowLegendKey() { Val = false });
                                                            dataLabel.Append(new C.ShowValue() { Val = true });
                                                            dataLabel.Append(new C.ShowCategoryName() { Val = false });
                                                            dataLabel.Append(new C.ShowSeriesName() { Val = false });
                                                            dataLabel.Append(new C.ShowPercent() { Val = false });
                                                            dataLabel.Append(new C.ShowBubbleSize() { Val = false });

                                                            C.ExtensionList extList = new C.ExtensionList();

                                                            C.Extension ext1 = new C.Extension() { Uri = "{CE6537A1-D6FC-4f65-9D91-7224C49458BB}" };
                                                            extList.Append(ext1);

                                                            C.Extension ext2 = new C.Extension() { Uri = "{C3380CC4-5D6E-409C-BE32-E72D297353CC}" };
                                                            extList.Append(ext2);

                                                            dataLabel.Append(extList);

                                                            dataLabels.Append(dataLabel);

                                                            i++;
                                                        }
                                                    }


                                                }


                                            }
                                        }
                                    }
                                }

                                Slide slide1 = slidePart?.Slide;
                                if (slide1 != null)
                                {
                                    CommonSlideData commonSlideData1 = slide1?.GetFirstChild<CommonSlideData>();
                                    if (commonSlideData1 != null)
                                    {
                                        ShapeTree shapeTree1 = commonSlideData1?.GetFirstChild<ShapeTree>();
                                        if (shapeTree1 != null)
                                        {
                                            var testNameShapes = shapeTree1?.Elements<P.Shape>()
                                            .Where(shape => shape.InnerText.Contains("TESTNAME"))
                                            .OrderBy(shape =>
                                            {
                                                var match = Regex.Match(shape.InnerText, @"TESTNAME(\d+)");
                                                return match.Success ? int.Parse(match.Groups[1].Value) : int.MaxValue;
                                            })
                                            .ToList();

                                            if (testNameShapes != null && testNameShapes.Count > 0)
                                            {
                                                for (int i = 0; i < testNameShapes.Count && i < apiData.Count; i++)
                                                {
                                                    var shape = testNameShapes[i];
                                                    var apiItem = apiData[apiData.Count - i - 1];

                                                    P.TextBody textBody = shape?.GetFirstChild<P.TextBody>();
                                                    if (textBody != null)
                                                    {
                                                        A.Paragraph paragraph = textBody?.Elements<A.Paragraph>().FirstOrDefault();
                                                        if (paragraph != null)
                                                        {
                                                            A.Run run = paragraph?.Elements<A.Run>().FirstOrDefault();
                                                            if (run != null)
                                                            {
                                                                A.RunProperties runProperties = run?.GetFirstChild<A.RunProperties>();
                                                                if (runProperties != null)
                                                                {
                                                                    runProperties.FontSize = DEFAULT_FONT_SIZE;
                                                                    if (apiData[apiData.Count - i - 1].TestNameBold == true)
                                                                    {
                                                                        runProperties.Bold = apiData[apiData.Count - i - 1].TestNameBold;
                                                                    }
                                                                    else
                                                                    {
                                                                        runProperties.Bold = false;
                                                                    }
                                                                }

                                                                A.SolidFill solidFill1 = runProperties?.GetFirstChild<A.SolidFill>();
                                                                if (solidFill1 != null)
                                                                {
                                                                    A.RgbColorModelHex rgbColor1 = solidFill1?.GetFirstChild<A.RgbColorModelHex>();
                                                                    if (rgbColor1 != null)
                                                                    {
                                                                        if (apiData[apiData.Count - i - 1].TestNameColor != null)
                                                                        {
                                                                            rgbColor1.Val = apiData[apiData.Count - i - 1].TestNameColor.TrimStart('#');
                                                                        }
                                                                        else
                                                                        {
                                                                            rgbColor1.Val = DEFAULT_COLOR;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            A.Text text = run?.GetFirstChild<A.Text>();
                                                            if (text != null)
                                                            {
                                                                if (apiData[apiData.Count - i - 1].TestName != null)
                                                                {
                                                                    text.Text = apiData[apiData.Count - i - 1].TestName.ToString();
                                                                }
                                                                else
                                                                {
                                                                    text.Text = "";
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                                slide1.Save();
                                chartPart.ChartSpace.Save();
                            }
                            slidePart.Slide.Save();
                        }
                        presentationDocument.Save();
                    }
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }


        // OVERALL IMPRESSIONS
        public void OverallImpressionsTemplateForAll(string destination, List<OverallImpressionsModel> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    if (presentationDocument != null)
                    {
                        SlidePart slidePart = presentationDocument.PresentationPart.SlideParts.First();
                        if (slidePart != null)
                        {
                            ChartPart chartPart = slidePart.ChartParts.First();
                            if (chartPart != null)
                            {
                                EmbeddedPackagePart embeddedPackagePart = chartPart.EmbeddedPackagePart;
                                BarChart barChart = chartPart.ChartSpace.Descendants<BarChart>().First();

                                if (embeddedPackagePart != null)
                                {
                                    using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                    {
                                        if (spreadsheet != null)
                                        {
                                            WorksheetPart worksheetPart = spreadsheet.WorkbookPart.WorksheetParts.First();

                                            if (worksheetPart != null)
                                            {
                                                SheetData sheetData = worksheetPart.Worksheet.Elements<SheetData>().FirstOrDefault();

                                                int excelDataIndex = 2;
                                                Cell cellVariableObj;

                                                apiData.Sort((x, y) => x.Positive.CompareTo(y.Positive));

                                                if (sheetData != null)
                                                {
                                                    foreach (var apiVariables in apiData)
                                                    {
                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>()
                                                            .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                        }

                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>()
                                                            .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.Positive.ToString());
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                        }

                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>()
                                                                .FirstOrDefault(c => c.CellReference == "C" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.Neutral.ToString());
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                        }

                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>().
                                                                FirstOrDefault(c => c.CellReference == "D" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.Negative.ToString());
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                        }
                                                        excelDataIndex++;
                                                    }

                                                    for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                                    {
                                                        Row row = sheetData.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                        if (row != null)
                                                        {
                                                            row.Remove();
                                                        }
                                                    }
                                                }
                                            }
                                        }

                                        char[] columns = { 'B', 'C', 'D' };
                                        int columnIndex = 0;

                                        if (barChart != null)
                                        {
                                            foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                            barChart.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                            {
                                                if (columnIndex < columns.Length)
                                                {
                                                    char column = columns[columnIndex];

                                                    NumberReference numberReference =
                                                        barChartSeries.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First().
                                                        Elements<NumberReference>().First();

                                                    numberReference.Formula =
                                                        new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                    NumberingCache numberingCache = numberReference.Elements<NumberingCache>().First();
                                                    numberingCache.RemoveAllChildren();
                                                    numberingCache.Append(new C.FormatCode("0.0"));

                                                    int idx = 0;

                                                    foreach (var api in apiData)
                                                    {
                                                        double chartValue;

                                                        switch (column)
                                                        {
                                                            case 'B':
                                                                chartValue = api.Positive;
                                                                break;

                                                            case 'C':
                                                                chartValue = api.Neutral;
                                                                break;

                                                            case 'D':
                                                                chartValue = api.Negative;
                                                                break;

                                                            default:
                                                                chartValue = 0;
                                                                break;
                                                        }

                                                        numberingCache.Append(new NumericPoint()
                                                        {
                                                            Index = (uint)idx,
                                                            //NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(chartValue.ToString())
                                                            NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue((Math.Round(chartValue * 10) / 10).ToString("F2"))
                                                        });

                                                        if (chartValue == 0)
                                                        {
                                                            DocumentFormat.OpenXml.Drawing.Charts.DataLabels dataLabels =
                                                                barChartSeries.GetFirstChild<DocumentFormat.OpenXml.Drawing.Charts.DataLabels>();

                                                            DocumentFormat.OpenXml.Drawing.Charts.DataLabel dataLabel =
                                                                new DocumentFormat.OpenXml.Drawing.Charts.DataLabel();

                                                            dataLabel.Append(new DocumentFormat.OpenXml.Drawing.Charts.Index()
                                                            {
                                                                Val = (uint)idx
                                                            });

                                                            dataLabel.Append(new Delete() { Val = true });
                                                            dataLabels.Append(dataLabel);
                                                        }
                                                        idx++;
                                                    }

                                                    if (column == 'D')
                                                    {
                                                        C.DataLabels dataLabels2 = barChartSeries.GetFirstChild<C.DataLabels>();

                                                        C.DataLabelPosition dataLabelPosition2 =
                                                            dataLabels2.AppendChild(new C.DataLabelPosition()
                                                            {
                                                                Val = C.DataLabelPositionValues.InsideEnd
                                                            });

                                                        C.TextProperties textProperties2 = dataLabels2.GetFirstChild<C.TextProperties>();
                                                        A.Paragraph paragraph2 = textProperties2.GetFirstChild<A.Paragraph>();
                                                        A.ParagraphProperties paragraphProperties2 = paragraph2.GetFirstChild<A.ParagraphProperties>();
                                                        A.DefaultRunProperties defaultRunProperties2 = paragraphProperties2.GetFirstChild<A.DefaultRunProperties>();
                                                        A.SolidFill solidFill2 = defaultRunProperties2.GetFirstChild<A.SolidFill>();

                                                        solidFill2.SchemeColor.Remove();

                                                        SchemeColor schemeColor = solidFill2.AppendChild(
                                                            new SchemeColor() { Val = A.SchemeColorValues.Background1 });
                                                    }
                                                    columnIndex++;
                                                }

                                                StringReference stringReference = barChartSeries.Elements<CategoryAxisData>()
                                                                                    .First().Elements<StringReference>().First();

                                                stringReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.
                                                        Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                                StringCache stringCache = stringReference.Elements<StringCache>().First();

                                                stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                                int catIdx = 0;

                                                foreach (var api in apiData)
                                                {
                                                    stringCache.Append(new StringPoint()
                                                    {
                                                        Index = (uint)catIdx,
                                                        NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                    });

                                                    StringPoint stringPoint = stringCache.Elements<StringPoint>().First();
                                                    catIdx++;
                                                }
                                            }
                                        }
                                    }
                                }

                                Slide slide1 = slidePart.Slide;
                                if (slide1 != null)
                                {
                                    CommonSlideData commonSlideData1 = slide1.GetFirstChild<CommonSlideData>();
                                    if (commonSlideData1 != null)
                                    {
                                        ShapeTree shapeTree1 = commonSlideData1.GetFirstChild<ShapeTree>();

                                        if (shapeTree1 != null)
                                        {
                                            var testNameShapes = shapeTree1.Elements<P.Shape>()
                                                      .Where(shape => shape.InnerText.Contains("TESTNAME"))
                                                      .ToList();

                                            if (testNameShapes != null && testNameShapes.Count > 0)
                                            {
                                                for (int i = 0; i < testNameShapes.Count && i < apiData.Count; i++)
                                                {
                                                    var shape = testNameShapes[i];
                                                    var apiItem = apiData[i];

                                                    if (shape != null)
                                                    {
                                                        P.TextBody textBody = shape.GetFirstChild<P.TextBody>();
                                                        if (textBody != null)
                                                        {
                                                            A.Paragraph paragraph = textBody.Elements<A.Paragraph>().FirstOrDefault();
                                                            if (paragraph != null)
                                                            {
                                                                A.Run run = paragraph.Elements<A.Run>().FirstOrDefault();
                                                                if (run != null)
                                                                {
                                                                    A.RunProperties runProperties = run.GetFirstChild<A.RunProperties>();
                                                                    if (runProperties != null)
                                                                    {
                                                                        runProperties.FontSize = DEFAULT_FONT_SIZE;

                                                                        if (apiItem.TestNameBold == true)
                                                                        {
                                                                            runProperties.Bold = apiItem.TestNameBold;
                                                                        }
                                                                        else
                                                                        {
                                                                            runProperties.Bold = false;
                                                                        }
                                                                    }

                                                                    A.SolidFill solidFill1 = runProperties.GetFirstChild<A.SolidFill>();
                                                                    if (solidFill1 != null)
                                                                    {
                                                                        A.RgbColorModelHex rgbColor1 = solidFill1.GetFirstChild<A.RgbColorModelHex>();
                                                                        if (rgbColor1 != null)
                                                                        {
                                                                            if (apiItem.TestNameColor != null)
                                                                            {
                                                                                rgbColor1.Val = apiItem.TestNameColor.TrimStart('#');
                                                                            }
                                                                            else
                                                                            {
                                                                                rgbColor1.Val = DEFAULT_COLOR;
                                                                            }
                                                                        }
                                                                    }

                                                                    A.Text text = run.GetFirstChild<A.Text>();
                                                                    if (text != null)
                                                                    {
                                                                        if (apiItem.TestName != null)
                                                                        {
                                                                            text.Text = apiItem.TestName;
                                                                        }
                                                                        else
                                                                        {
                                                                            text.Text = "";
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                                slide1.Save();
                            }
                            chartPart.ChartSpace.Save();
                        }
                        slidePart.Slide.Save();
                    }
                    presentationDocument.Save();
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }

        //ATTRIBUTE EVALUATION HISTORICAL DATA
        public void Attribute1TemplateForAll(string destination,
                                                  List<Aev1> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    if (presentationDocument != null)
                    {
                        SlidePart slidePart = presentationDocument?.PresentationPart?.SlideParts.First();
                        if (slidePart != null)
                        {
                            ChartPart chartPart = slidePart?.ChartParts.First();
                            if (chartPart != null)
                            {
                                EmbeddedPackagePart embeddedPackagePart = chartPart?.EmbeddedPackagePart;
                                BarChart barChart = chartPart?.ChartSpace?.Descendants<BarChart>().First();

                                if (embeddedPackagePart != null)
                                {
                                    using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                    {
                                        WorksheetPart worksheetPart = spreadsheet?.WorkbookPart.WorksheetParts.First();

                                        if (worksheetPart != null)
                                        {
                                            SheetData sheetData = worksheetPart?.Worksheet.Elements<SheetData>().FirstOrDefault();

                                            if (sheetData != null)
                                            {
                                                int excelDataIndex = 2;
                                                Cell cellVariableObj;

                                                apiData.Sort((x, y) => (x.Average ?? 0).CompareTo(y.Average ?? 0));

                                                foreach (var apiVariables in apiData)
                                                {
                                                    cellVariableObj =
                                                        sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                    if (cellVariableObj != null)
                                                    {
                                                        cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                        cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                    }

                                                    cellVariableObj =
                                                        sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                    if (cellVariableObj != null)
                                                    {
                                                        cellVariableObj.CellValue = new CellValue(apiVariables.Average.ToString());
                                                        cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                    }
                                                    excelDataIndex++;
                                                }

                                                for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                                {
                                                    Row row = sheetData?.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                    if (row != null)
                                                    {
                                                        row.Remove();
                                                    }
                                                }
                                            }
                                        }

                                        char[] columns = { 'B' };
                                        int columnIndex = 0;

                                        if (barChart != null)
                                        {
                                            foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                                barChart?.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                            {
                                                if (columnIndex < columns.Length)
                                                {
                                                    char column = columns[columnIndex];

                                                    NumberReference numberReference =
                                                        barChartSeries?.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First()?.
                                                        Elements<NumberReference>().First();

                                                    numberReference.Formula =
                                                        new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                    NumberingCache numberingCache = numberReference?.Elements<NumberingCache>().First();
                                                    numberingCache.RemoveAllChildren();

                                                    int idx = 0;

                                                    foreach (var api in apiData)
                                                    {
                                                        long chartValue;

                                                        numberingCache.Append(new NumericPoint()
                                                        {
                                                            Index = (uint)idx,
                                                            NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.Average.ToString())
                                                        });
                                                        idx++;
                                                    }
                                                }

                                                StringReference stringReference = barChartSeries?.Elements<CategoryAxisData>()
                                                                                    .First()?.Elements<StringReference>().First();

                                                stringReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.
                                                        Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                                StringCache stringCache = stringReference?.Elements<StringCache>().First();

                                                stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                                int catIdx = 0;

                                                foreach (var api in apiData)
                                                {
                                                    stringCache.Append(new StringPoint()
                                                    {
                                                        Index = (uint)catIdx,
                                                        NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                    });

                                                    StringPoint stringPoint = stringCache?.Elements<StringPoint>().First();
                                                    catIdx++;
                                                }

                                                uint i = 0;
                                                double historicalAvg = 0.00;

                                                //////////////////// original code////////////////
                                                //if (apiData.FirstOrDefault().TestName.Equals("[Refreshed Hist. Mean]"))
                                                //{
                                                //    historicalAvg = Math.Round(apiData.FirstOrDefault().Average, 2);
                                                //}

                                                var meanValue = apiData.Where(x => x.TestName.Contains("Refreshed Hist. Mean")).ToList();

                                                if (meanValue.Count == 1)
                                                {
                                                    var value = meanValue[0].Average;
                                                    historicalAvg = (double)Math.Round((decimal)value, 2);
                                                }

                                                C.DataLabels dataLabels = barChartSeries?.GetFirstChild<C.DataLabels>();

                                                if (dataLabels != null)
                                                {
                                                    foreach (var api in apiData)
                                                    {
                                                        C.DataLabel dataLabel = new C.DataLabel();
                                                        C.Index index = new C.Index() { Val = (uint)i };

                                                        C.ChartText chartText = new C.ChartText();
                                                        C.RichText richText = new C.RichText();
                                                        A.BodyProperties bodyProperties = new A.BodyProperties();

                                                        A.ShapeAutoFit shapeAutoFit = new A.ShapeAutoFit();

                                                        bodyProperties.Append(shapeAutoFit);

                                                        A.ListStyle listStyle = new A.ListStyle();
                                                        A.Paragraph paragraph = new A.Paragraph();

                                                        A.ParagraphProperties paragraphProperties1 = new A.ParagraphProperties();
                                                        A.DefaultRunProperties defaultRunProperties1 = new A.DefaultRunProperties()
                                                        {
                                                            Bold = false,
                                                            Italic = false,
                                                            Strike = TextStrikeValues.NoStrike,
                                                            Underline = TextUnderlineValues.None,
                                                            Kerning = 1200,
                                                            Baseline = 0,
                                                            FontSize = 1200
                                                        };

                                                        A.SolidFill solidFill1 = new SolidFill();
                                                        A.RgbColorModelHex rgbColorModelHex1 = new A.RgbColorModelHex() { Val = "000000" };

                                                        A.LatinFont latin1 = new A.LatinFont() { Typeface = "+mn-lt" };
                                                        A.EastAsianFont eastAsianFont1 = new A.EastAsianFont() { Typeface = "+mn-ea" };
                                                        A.ComplexScriptFont complexScriptFont = new A.ComplexScriptFont() { Typeface = "+mn-cs" };

                                                        defaultRunProperties1.Append(solidFill1);
                                                        defaultRunProperties1.Append(latin1);
                                                        defaultRunProperties1.Append(eastAsianFont1);
                                                        defaultRunProperties1.Append(complexScriptFont);

                                                        paragraphProperties1.Append(defaultRunProperties1);

                                                        A.Run run = new A.Run();
                                                        A.RunProperties runProperties = new A.RunProperties() { Language = "en-US", FontSize = 1200 };

                                                        /////////////////////////////////Original///////////////////////////////////
                                                        //A.Text text = new A.Text() { Text = $"{api.Average.ToString("F2")}" };

                                                        double percentageValue = (double)Math.Round((decimal)api.Average, 4);

                                                        A.Text text;
                                                        text = new A.Text();

                                                        if (historicalAvg == 0.0)
                                                        {
                                                            text.Text = $"{percentageValue:0.00}";
                                                        }
                                                        else
                                                        {
                                                            if (percentageValue <= historicalAvg)
                                                            {
                                                                text = new A.Text();
                                                                text.Text = $"{percentageValue:0.00}";
                                                            }
                                                            else
                                                            {
                                                                text = new A.Text();
                                                                text.Text = $"{percentageValue:0.00}*";
                                                            }
                                                        }

                                                        run.Append(runProperties);
                                                        run.Append(text);
                                                        paragraph.Append(run);

                                                        richText.Append(bodyProperties);
                                                        richText.Append(listStyle);
                                                        richText.Append(paragraph);

                                                        chartText.Append(richText);

                                                        C.ShapeProperties shapeProperties = new C.ShapeProperties();
                                                        A.NoFill noFill = new A.NoFill();
                                                        A.Outline outline1 = new A.Outline();
                                                        A.NoFill noFill2 = new A.NoFill();

                                                        outline1.Append(noFill2);

                                                        A.EffectList effectList = new A.EffectList();

                                                        shapeProperties.Append(noFill);
                                                        shapeProperties.Append(outline1);
                                                        shapeProperties.Append(effectList);

                                                        C.TextProperties textProperties = new C.TextProperties();
                                                        A.BodyProperties bodyProperties1 = new A.BodyProperties();

                                                        A.ShapeAutoFit shapeAutoFit2 = new A.ShapeAutoFit();
                                                        bodyProperties1.Append(shapeAutoFit2);

                                                        A.ListStyle listStyle1 = new A.ListStyle();

                                                        A.Paragraph paragraph1 = new A.Paragraph();
                                                        A.ParagraphProperties paragraphProperties2 = new A.ParagraphProperties();
                                                        A.DefaultRunProperties defaultRunProperties2 = new A.DefaultRunProperties();

                                                        A.SolidFill solidFill2 = new A.SolidFill();
                                                        A.RgbColorModelHex rgbColorModelHex2 = new A.RgbColorModelHex() { Val = "000000" };

                                                        solidFill2.Append(rgbColorModelHex2);

                                                        A.LatinFont latinFont2 = new A.LatinFont() { Typeface = "+mn-lt" };
                                                        A.EastAsianFont eastAsianFont2 = new A.EastAsianFont() { Typeface = "+mn-ea" };
                                                        A.ComplexScriptFont complexScriptFont2 = new A.ComplexScriptFont() { Typeface = "+mn-cs" };

                                                        defaultRunProperties2.Append(solidFill2);

                                                        paragraphProperties2.Append(defaultRunProperties2);

                                                        A.EndParagraphRunProperties endParagraphRunProperties2 =
                                                            new A.EndParagraphRunProperties() { Language = "en-US" };

                                                        paragraph1.Append(endParagraphRunProperties2);
                                                        paragraph1.Append(paragraphProperties2);

                                                        textProperties.Append(bodyProperties1);
                                                        textProperties.Append(listStyle1);
                                                        textProperties.Append(paragraph1);

                                                        dataLabel.Append(index);
                                                        dataLabel.Append(chartText);
                                                        dataLabel.Append(shapeProperties);
                                                        dataLabel.Append(textProperties);

                                                        dataLabels.Append(dataLabel);

                                                        i++;
                                                    }

                                                }
                                            }
                                        }
                                    }
                                }

                                Slide slide1 = slidePart?.Slide;
                                if (slide1 != null)
                                {
                                    CommonSlideData commonSlideData1 = slide1?.GetFirstChild<CommonSlideData>();
                                    if (commonSlideData1 != null)
                                    {
                                        ShapeTree shapeTree1 = commonSlideData1?.GetFirstChild<ShapeTree>();
                                        if (shapeTree1 != null)
                                        {
                                            var attributeTitle = shapeTree1?.Elements<P.Shape>()
                                                            .Where(shape => shape.InnerText.Contains("<<AttributeEvaluationTitle>>")).ToList();

                                            if (attributeTitle != null)
                                            {
                                                for (int i = 0; i < attributeTitle.Count; i++)
                                                {
                                                    var res = attributeTitle[i];

                                                    if (res != null)
                                                    {
                                                        var textbody = res?.GetFirstChild<P.TextBody>();
                                                        if (textbody != null)
                                                        {
                                                            var paragraph = textbody?.GetFirstChild<A.Paragraph>();
                                                            if (paragraph != null)
                                                            {
                                                                foreach (var runEl in paragraph.Elements<A.Run>())
                                                                {
                                                                    var text = runEl?.GetFirstChild<A.Text>();
                                                                    if (text != null)
                                                                    {
                                                                        if (text.Text.Contains("Attribute"))
                                                                        {
                                                                            //do nothing
                                                                        }
                                                                        if (text.Text.Contains(" Evaluations (<<"))
                                                                        {
                                                                            text.Text = "Evaluations (";
                                                                        }
                                                                        if (text.Text.Contains("AttributeEvaluationTitle"))
                                                                        {
                                                                            text.Text = $"Attribute #1";
                                                                        }
                                                                        if (text.Text.Contains(">>) Results"))
                                                                        {
                                                                            text.Text = ") Results";
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            var circleTitle = shapeTree1?.Elements<P.Shape>()
                                                            .Where(shape => shape.InnerText.Contains("AttributeEvaluationDescription")).ToList();

                                            if (circleTitle != null)
                                            {
                                                for (int i = 0; i < circleTitle.Count; i++)
                                                {
                                                    var circleText = circleTitle[i];

                                                    var textBody = circleText?.GetFirstChild<P.TextBody>();
                                                    if (textBody != null)
                                                    {
                                                        var paragraph = textBody?.GetFirstChild<A.Paragraph>();
                                                        if (paragraph != null)
                                                        {
                                                            foreach (var run in paragraph?.Elements<A.Run>())
                                                            {
                                                                var text = run?.GetFirstChild<A.Text>();
                                                                if (text != null)
                                                                {
                                                                    if (text.Text.Contains("<<"))
                                                                    {
                                                                        text.Text = "";
                                                                    }
                                                                    if (text.Text.Contains("AttributeEvaluationDescription"))
                                                                    {
                                                                        text.Text = $"Attribute #1";
                                                                    }
                                                                    if (text.Text.Contains(">>"))
                                                                    {
                                                                        text.Text = "";
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                }
                                            }

                                            var testNameShapes = shapeTree1?.Elements<P.Shape>()
                                                .Where(shape => shape.InnerText.Contains("TESTNAME"))
                                                .OrderBy(shape =>
                                                {
                                                    var match = Regex.Match(shape.InnerText, @"TESTNAME(\d+)");
                                                    return match.Success ? int.Parse(match.Groups[1].Value) : int.MaxValue;
                                                })
                                                .ToList();

                                            if (testNameShapes != null && testNameShapes.Count > 0)
                                            {
                                                for (int i = 0; i < testNameShapes.Count && i < apiData.Count; i++)
                                                {
                                                    var shape = testNameShapes[i];
                                                    var apiItem = apiData[apiData.Count - i - 1];

                                                    P.TextBody textBody = shape?.GetFirstChild<P.TextBody>();
                                                    if (textBody != null)
                                                    {
                                                        A.Paragraph paragraph = textBody?.Elements<A.Paragraph>().FirstOrDefault();
                                                        if (paragraph != null)
                                                        {
                                                            A.Run run = paragraph?.Elements<A.Run>().FirstOrDefault();
                                                            if (run != null)
                                                            {
                                                                A.RunProperties runProperties = run?.GetFirstChild<A.RunProperties>();

                                                                if (runProperties != null)
                                                                {
                                                                    runProperties.FontSize = DEFAULT_FONT_SIZE;
                                                                    if (apiData[apiData.Count - i - 1].TestNameBold == true)
                                                                    {
                                                                        runProperties.Bold = apiData[apiData.Count - i - 1].TestNameBold;
                                                                    }
                                                                    else
                                                                    {
                                                                        runProperties.Bold = false;
                                                                    }
                                                                }

                                                                A.SolidFill solidFill1 = runProperties?.GetFirstChild<A.SolidFill>();
                                                                if (solidFill1 != null)
                                                                {
                                                                    A.RgbColorModelHex rgbColor1 = solidFill1?.GetFirstChild<A.RgbColorModelHex>();
                                                                    if (rgbColor1 != null)
                                                                    {
                                                                        if (apiData[apiData.Count - i - 1].TestNameColor != null)
                                                                        {
                                                                            rgbColor1.Val = apiData[apiData.Count - i - 1].TestNameColor.TrimStart('#');
                                                                        }
                                                                        else
                                                                        {
                                                                            rgbColor1.Val = DEFAULT_COLOR;

                                                                        }
                                                                    }
                                                                }

                                                                A.Text text = run?.GetFirstChild<A.Text>();
                                                                if (text != null)
                                                                {
                                                                    if (apiData[apiData.Count - i - 1].TestName != null)
                                                                    {
                                                                        text.Text = apiData[apiData.Count - i - 1].TestName.Trim(' ', '(', '?', ')').ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        text.Text = "";
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                        slide1.Save();
                                    }
                                }
                                chartPart.ChartSpace.Save();
                            }
                            slidePart.Slide.Save();
                        }
                        presentationDocument.Save();
                    }
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }

        //ATTRIBUTE EVALUATION HISTORICAL DATA
        public void Attribute2TemplateForAll(string destination,
                                                  List<Aev2> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    if (presentationDocument != null)
                    {
                        SlidePart slidePart = presentationDocument?.PresentationPart?.SlideParts.First();
                        if (slidePart != null)
                        {
                            ChartPart chartPart = slidePart?.ChartParts.First();
                            if (chartPart != null)
                            {
                                EmbeddedPackagePart embeddedPackagePart = chartPart?.EmbeddedPackagePart;
                                BarChart barChart = chartPart?.ChartSpace?.Descendants<BarChart>().First();

                                if (embeddedPackagePart != null)
                                {
                                    using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                    {
                                        WorksheetPart worksheetPart = spreadsheet?.WorkbookPart.WorksheetParts.First();

                                        if (worksheetPart != null)
                                        {
                                            SheetData sheetData = worksheetPart?.Worksheet.Elements<SheetData>().FirstOrDefault();

                                            if (sheetData != null)
                                            {
                                                int excelDataIndex = 2;
                                                Cell cellVariableObj;

                                                apiData.Sort((x, y) => (x.Average ?? 0).CompareTo(y.Average ?? 0));

                                                foreach (var apiVariables in apiData)
                                                {
                                                    cellVariableObj =
                                                        sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                    if (cellVariableObj != null)
                                                    {
                                                        cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                        cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                    }

                                                    cellVariableObj =
                                                        sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                    if (cellVariableObj != null)
                                                    {
                                                        cellVariableObj.CellValue = new CellValue(apiVariables.Average.ToString());
                                                        cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                    }
                                                    excelDataIndex++;
                                                }

                                                for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                                {
                                                    Row row = sheetData?.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                    if (row != null)
                                                    {
                                                        row.Remove();
                                                    }
                                                }
                                            }
                                        }

                                        char[] columns = { 'B' };
                                        int columnIndex = 0;

                                        if (barChart != null)
                                        {
                                            foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                                barChart?.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                            {
                                                if (columnIndex < columns.Length)
                                                {
                                                    char column = columns[columnIndex];

                                                    NumberReference numberReference =
                                                        barChartSeries?.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First()?.
                                                        Elements<NumberReference>().First();

                                                    numberReference.Formula =
                                                        new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                    NumberingCache numberingCache = numberReference?.Elements<NumberingCache>().First();
                                                    numberingCache.RemoveAllChildren();

                                                    int idx = 0;

                                                    foreach (var api in apiData)
                                                    {
                                                        long chartValue;

                                                        numberingCache.Append(new NumericPoint()
                                                        {
                                                            Index = (uint)idx,
                                                            NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.Average.ToString())
                                                        });
                                                        idx++;
                                                    }
                                                }

                                                StringReference stringReference = barChartSeries?.Elements<CategoryAxisData>()
                                                                                    .First()?.Elements<StringReference>().First();

                                                stringReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.
                                                        Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                                StringCache stringCache = stringReference?.Elements<StringCache>().First();

                                                stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                                int catIdx = 0;

                                                foreach (var api in apiData)
                                                {
                                                    stringCache.Append(new StringPoint()
                                                    {
                                                        Index = (uint)catIdx,
                                                        NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                    });

                                                    StringPoint stringPoint = stringCache?.Elements<StringPoint>().First();
                                                    catIdx++;
                                                }

                                                uint i = 0;
                                                double historicalAvg = 0.00;

                                                //////////////////// original code////////////////
                                                //if (apiData.FirstOrDefault().TestName.Equals("[Refreshed Hist. Mean]"))
                                                //{
                                                //    historicalAvg = Math.Round(apiData.FirstOrDefault().Average, 2);
                                                //}

                                                var meanValue = apiData.Where(x => x.TestName.Contains("Refreshed Hist. Mean")).ToList();

                                                if (meanValue.Count == 1)
                                                {
                                                    var value = meanValue[0].Average;
                                                    historicalAvg = (double)Math.Round((decimal)value, 2);
                                                }

                                                C.DataLabels dataLabels = barChartSeries?.GetFirstChild<C.DataLabels>();

                                                if (dataLabels != null)
                                                {
                                                    foreach (var api in apiData)
                                                    {
                                                        C.DataLabel dataLabel = new C.DataLabel();
                                                        C.Index index = new C.Index() { Val = (uint)i };

                                                        C.ChartText chartText = new C.ChartText();
                                                        C.RichText richText = new C.RichText();
                                                        A.BodyProperties bodyProperties = new A.BodyProperties();

                                                        A.ShapeAutoFit shapeAutoFit = new A.ShapeAutoFit();

                                                        bodyProperties.Append(shapeAutoFit);

                                                        A.ListStyle listStyle = new A.ListStyle();
                                                        A.Paragraph paragraph = new A.Paragraph();

                                                        A.ParagraphProperties paragraphProperties1 = new A.ParagraphProperties();
                                                        A.DefaultRunProperties defaultRunProperties1 = new A.DefaultRunProperties()
                                                        {
                                                            Bold = false,
                                                            Italic = false,
                                                            Strike = TextStrikeValues.NoStrike,
                                                            Underline = TextUnderlineValues.None,
                                                            Kerning = 1200,
                                                            Baseline = 0,
                                                            FontSize = 1200
                                                        };

                                                        A.SolidFill solidFill1 = new SolidFill();
                                                        A.RgbColorModelHex rgbColorModelHex1 = new A.RgbColorModelHex() { Val = "000000" };

                                                        A.LatinFont latin1 = new A.LatinFont() { Typeface = "+mn-lt" };
                                                        A.EastAsianFont eastAsianFont1 = new A.EastAsianFont() { Typeface = "+mn-ea" };
                                                        A.ComplexScriptFont complexScriptFont = new A.ComplexScriptFont() { Typeface = "+mn-cs" };

                                                        defaultRunProperties1.Append(solidFill1);
                                                        defaultRunProperties1.Append(latin1);
                                                        defaultRunProperties1.Append(eastAsianFont1);
                                                        defaultRunProperties1.Append(complexScriptFont);

                                                        paragraphProperties1.Append(defaultRunProperties1);

                                                        A.Run run = new A.Run();
                                                        A.RunProperties runProperties = new A.RunProperties() { Language = "en-US", FontSize = 1200 };

                                                        /////////////////////////////////Original///////////////////////////////////
                                                        //A.Text text = new A.Text() { Text = $"{api.Average.ToString("F2")}" };

                                                        double percentageValue = (double)Math.Round((decimal)api.Average, 4);

                                                        A.Text text;
                                                        text = new A.Text();

                                                        if (historicalAvg == 0.0)
                                                        {
                                                            text.Text = $"{percentageValue:0.00}";
                                                        }
                                                        else
                                                        {
                                                            if (percentageValue <= historicalAvg)
                                                            {
                                                                text = new A.Text();
                                                                text.Text = $"{percentageValue:0.00}";
                                                            }
                                                            else
                                                            {
                                                                text = new A.Text();
                                                                text.Text = $"{percentageValue:0.00}*";
                                                            }
                                                        }

                                                        run.Append(runProperties);
                                                        run.Append(text);
                                                        paragraph.Append(run);

                                                        richText.Append(bodyProperties);
                                                        richText.Append(listStyle);
                                                        richText.Append(paragraph);

                                                        chartText.Append(richText);

                                                        C.ShapeProperties shapeProperties = new C.ShapeProperties();
                                                        A.NoFill noFill = new A.NoFill();
                                                        A.Outline outline1 = new A.Outline();
                                                        A.NoFill noFill2 = new A.NoFill();

                                                        outline1.Append(noFill2);

                                                        A.EffectList effectList = new A.EffectList();

                                                        shapeProperties.Append(noFill);
                                                        shapeProperties.Append(outline1);
                                                        shapeProperties.Append(effectList);

                                                        C.TextProperties textProperties = new C.TextProperties();
                                                        A.BodyProperties bodyProperties1 = new A.BodyProperties();

                                                        A.ShapeAutoFit shapeAutoFit2 = new A.ShapeAutoFit();
                                                        bodyProperties1.Append(shapeAutoFit2);

                                                        A.ListStyle listStyle1 = new A.ListStyle();

                                                        A.Paragraph paragraph1 = new A.Paragraph();
                                                        A.ParagraphProperties paragraphProperties2 = new A.ParagraphProperties();
                                                        A.DefaultRunProperties defaultRunProperties2 = new A.DefaultRunProperties();

                                                        A.SolidFill solidFill2 = new A.SolidFill();
                                                        A.RgbColorModelHex rgbColorModelHex2 = new A.RgbColorModelHex() { Val = "000000" };

                                                        solidFill2.Append(rgbColorModelHex2);

                                                        A.LatinFont latinFont2 = new A.LatinFont() { Typeface = "+mn-lt" };
                                                        A.EastAsianFont eastAsianFont2 = new A.EastAsianFont() { Typeface = "+mn-ea" };
                                                        A.ComplexScriptFont complexScriptFont2 = new A.ComplexScriptFont() { Typeface = "+mn-cs" };

                                                        defaultRunProperties2.Append(solidFill2);

                                                        paragraphProperties2.Append(defaultRunProperties2);

                                                        A.EndParagraphRunProperties endParagraphRunProperties2 =
                                                            new A.EndParagraphRunProperties() { Language = "en-US" };

                                                        paragraph1.Append(endParagraphRunProperties2);
                                                        paragraph1.Append(paragraphProperties2);

                                                        textProperties.Append(bodyProperties1);
                                                        textProperties.Append(listStyle1);
                                                        textProperties.Append(paragraph1);

                                                        dataLabel.Append(index);
                                                        dataLabel.Append(chartText);
                                                        dataLabel.Append(shapeProperties);
                                                        dataLabel.Append(textProperties);

                                                        dataLabels.Append(dataLabel);

                                                        i++;
                                                    }

                                                }
                                            }
                                        }
                                    }
                                }

                                Slide slide1 = slidePart?.Slide;
                                if (slide1 != null)
                                {
                                    CommonSlideData commonSlideData1 = slide1?.GetFirstChild<CommonSlideData>();
                                    if (commonSlideData1 != null)
                                    {
                                        ShapeTree shapeTree1 = commonSlideData1?.GetFirstChild<ShapeTree>();
                                        if (shapeTree1 != null)
                                        {
                                            var attributeTitle = shapeTree1?.Elements<P.Shape>()
                                                            .Where(shape => shape.InnerText.Contains("<<AttributeEvaluationTitle>>")).ToList();

                                            if (attributeTitle != null)
                                            {
                                                for (int i = 0; i < attributeTitle.Count; i++)
                                                {
                                                    var res = attributeTitle[i];

                                                    if (res != null)
                                                    {
                                                        var textbody = res?.GetFirstChild<P.TextBody>();
                                                        if (textbody != null)
                                                        {
                                                            var paragraph = textbody?.GetFirstChild<A.Paragraph>();
                                                            if (paragraph != null)
                                                            {
                                                                foreach (var runEl in paragraph.Elements<A.Run>())
                                                                {
                                                                    var text = runEl?.GetFirstChild<A.Text>();
                                                                    if (text != null)
                                                                    {
                                                                        if (text.Text.Contains("Attribute"))
                                                                        {
                                                                            //do nothing
                                                                        }
                                                                        if (text.Text.Contains(" Evaluations (<<"))
                                                                        {
                                                                            text.Text = "Evaluations (";
                                                                        }
                                                                        if (text.Text.Contains("AttributeEvaluationTitle"))
                                                                        {
                                                                            text.Text = $"Attribute #2";
                                                                        }
                                                                        if (text.Text.Contains(">>) Results"))
                                                                        {
                                                                            text.Text = ") Results";
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            var circleTitle = shapeTree1?.Elements<P.Shape>()
                                                            .Where(shape => shape.InnerText.Contains("AttributeEvaluationDescription")).ToList();

                                            if (circleTitle != null)
                                            {
                                                for (int i = 0; i < circleTitle.Count; i++)
                                                {
                                                    var circleText = circleTitle[i];

                                                    var textBody = circleText?.GetFirstChild<P.TextBody>();
                                                    if (textBody != null)
                                                    {
                                                        var paragraph = textBody?.GetFirstChild<A.Paragraph>();
                                                        if (paragraph != null)
                                                        {
                                                            foreach (var run in paragraph?.Elements<A.Run>())
                                                            {
                                                                var text = run?.GetFirstChild<A.Text>();
                                                                if (text != null)
                                                                {
                                                                    if (text.Text.Contains("<<"))
                                                                    {
                                                                        text.Text = "";
                                                                    }
                                                                    if (text.Text.Contains("AttributeEvaluationDescription"))
                                                                    {
                                                                        text.Text = $"Attribute #2";
                                                                    }
                                                                    if (text.Text.Contains(">>"))
                                                                    {
                                                                        text.Text = "";
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                }
                                            }

                                            var testNameShapes = shapeTree1?.Elements<P.Shape>()
                                                .Where(shape => shape.InnerText.Contains("TESTNAME"))
                                                .OrderBy(shape =>
                                                {
                                                    var match = Regex.Match(shape.InnerText, @"TESTNAME(\d+)");
                                                    return match.Success ? int.Parse(match.Groups[1].Value) : int.MaxValue;
                                                })
                                                .ToList();

                                            if (testNameShapes != null && testNameShapes.Count > 0)
                                            {
                                                for (int i = 0; i < testNameShapes.Count && i < apiData.Count; i++)
                                                {
                                                    var shape = testNameShapes[i];
                                                    var apiItem = apiData[apiData.Count - i - 1];

                                                    P.TextBody textBody = shape?.GetFirstChild<P.TextBody>();
                                                    if (textBody != null)
                                                    {
                                                        A.Paragraph paragraph = textBody?.Elements<A.Paragraph>().FirstOrDefault();
                                                        if (paragraph != null)
                                                        {
                                                            A.Run run = paragraph?.Elements<A.Run>().FirstOrDefault();
                                                            if (run != null)
                                                            {
                                                                A.RunProperties runProperties = run?.GetFirstChild<A.RunProperties>();

                                                                if (runProperties != null)
                                                                {
                                                                    runProperties.FontSize = DEFAULT_FONT_SIZE;
                                                                    if (apiData[apiData.Count - i - 1].TestNameBold == true)
                                                                    {
                                                                        runProperties.Bold = apiData[apiData.Count - i - 1].TestNameBold;
                                                                    }
                                                                    else
                                                                    {
                                                                        runProperties.Bold = false;
                                                                    }
                                                                }

                                                                A.SolidFill solidFill1 = runProperties?.GetFirstChild<A.SolidFill>();
                                                                if (solidFill1 != null)
                                                                {
                                                                    A.RgbColorModelHex rgbColor1 = solidFill1?.GetFirstChild<A.RgbColorModelHex>();
                                                                    if (rgbColor1 != null)
                                                                    {
                                                                        if (apiData[apiData.Count - i - 1].TestNameColor != null)
                                                                        {
                                                                            rgbColor1.Val = apiData[apiData.Count - i - 1].TestNameColor.TrimStart('#');
                                                                        }
                                                                        else
                                                                        {
                                                                            rgbColor1.Val = DEFAULT_COLOR;

                                                                        }
                                                                    }
                                                                }

                                                                A.Text text = run?.GetFirstChild<A.Text>();
                                                                if (text != null)
                                                                {
                                                                    if (apiData[apiData.Count - i - 1].TestName != null)
                                                                    {
                                                                        text.Text = apiData[apiData.Count - i - 1].TestName.Trim(' ', '(', '?', ')').ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        text.Text = "";
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                        slide1.Save();
                                    }
                                }
                                chartPart.ChartSpace.Save();
                            }
                            slidePart.Slide.Save();
                        }
                        presentationDocument.Save();
                    }
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }

        // ATTRIBUTE EVALUATION AGGREGRATE
        public void AttributeEvalAggregTemplateForAll(string destination, List<Aev3> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    if (presentationDocument != null)
                    {
                        SlidePart slidePart = presentationDocument?.PresentationPart?.SlideParts.First();
                        if (slidePart != null)
                        {
                            ChartPart chartPart = slidePart?.ChartParts.First();
                            if (chartPart != null)
                            {
                                EmbeddedPackagePart embeddedPackagePart = chartPart?.EmbeddedPackagePart;
                                BarChart barChart = chartPart?.ChartSpace?.Descendants<BarChart>().First();

                                if (embeddedPackagePart != null)
                                {
                                    using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                    {
                                        WorksheetPart worksheetPart = spreadsheet?.WorkbookPart?.WorksheetParts.First();
                                        if (worksheetPart != null)
                                        {
                                            SheetData sheetData = worksheetPart?.Worksheet?.Elements<SheetData>().FirstOrDefault();

                                            int excelDataIndex = 2;
                                            Cell cellVariableObj;

                                            apiData.Sort((x, y) => (x.Average ?? 0).CompareTo(y.Average ?? 0));

                                            if (sheetData != null)
                                            {
                                                foreach (var apiVariables in apiData)
                                                {
                                                    cellVariableObj =
                                                        sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                    if (cellVariableObj != null)
                                                    {
                                                        cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                        cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                    }

                                                    cellVariableObj =
                                                        sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                    if (cellVariableObj != null)
                                                    {
                                                        cellVariableObj.CellValue = new CellValue(apiVariables.Average.ToString());
                                                        cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                    }
                                                    excelDataIndex++;
                                                }

                                                for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                                {
                                                    Row row = sheetData?.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                    if (row != null)
                                                    {
                                                        row.Remove();
                                                    }
                                                }
                                            }
                                        }

                                        char[] columns = { 'B' };
                                        int columnIndex = 0;

                                        if (barChart != null)
                                        {
                                            foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                            barChart?.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                            {
                                                if (columnIndex < columns.Length)
                                                {
                                                    char column = columns[columnIndex];

                                                    NumberReference numberReference =
                                                        barChartSeries?.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First()?.
                                                        Elements<NumberReference>().First();

                                                    numberReference.Formula =
                                                        new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                    NumberingCache numberingCache = numberReference?.Elements<NumberingCache>().First();
                                                    numberingCache.RemoveAllChildren();

                                                    int idx = 0;

                                                    foreach (var api in apiData)
                                                    {
                                                        numberingCache.Append(new NumericPoint()
                                                        {
                                                            Index = (uint)idx,
                                                            NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.Average.ToString())
                                                        });
                                                        idx++;
                                                    }
                                                }

                                                StringReference stringReference = barChartSeries?.Elements<CategoryAxisData>()
                                                                                    .First().Elements<StringReference>().First();

                                                stringReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.
                                                        Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                                StringCache stringCache = stringReference?.Elements<StringCache>().First();
                                                stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                                int catIdx = 0;

                                                foreach (var api in apiData)
                                                {
                                                    stringCache.Append(new StringPoint()
                                                    {
                                                        Index = (uint)catIdx,
                                                        NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                    });
                                                    catIdx++;
                                                }

                                                uint i = 0;

                                                C.DataLabels dataLabels = barChartSeries.GetFirstChild<C.DataLabels>();

                                                if (dataLabels != null)
                                                {
                                                    foreach (var api in apiData)
                                                    {
                                                        C.DataLabel dataLabel = new C.DataLabel();
                                                        C.Index index = new C.Index() { Val = (uint)i };

                                                        C.ChartText chartText = new C.ChartText();
                                                        C.RichText richText = new C.RichText();
                                                        A.BodyProperties bodyProperties = new A.BodyProperties();

                                                        A.ShapeAutoFit shapeAutoFit = new A.ShapeAutoFit();

                                                        bodyProperties.Append(shapeAutoFit);

                                                        A.ListStyle listStyle = new A.ListStyle();
                                                        A.Paragraph paragraph = new A.Paragraph();

                                                        A.ParagraphProperties paragraphProperties1 = new A.ParagraphProperties();
                                                        A.DefaultRunProperties defaultRunProperties1 = new A.DefaultRunProperties()
                                                        {
                                                            Bold = false,
                                                            Italic = false,
                                                            Strike = TextStrikeValues.NoStrike,
                                                            Underline = TextUnderlineValues.None,
                                                            Kerning = 1200,
                                                            Baseline = 0,
                                                            FontSize = 1200
                                                        };

                                                        A.SolidFill solidFill1 = new SolidFill();
                                                        A.RgbColorModelHex rgbColorModelHex1 = new A.RgbColorModelHex() { Val = "000000" };

                                                        A.LatinFont latin1 = new A.LatinFont() { Typeface = "+mn-lt" };
                                                        A.EastAsianFont eastAsianFont1 = new A.EastAsianFont() { Typeface = "+mn-ea" };
                                                        A.ComplexScriptFont complexScriptFont = new A.ComplexScriptFont() { Typeface = "+mn-cs" };

                                                        defaultRunProperties1.Append(solidFill1);
                                                        defaultRunProperties1.Append(latin1);
                                                        defaultRunProperties1.Append(eastAsianFont1);
                                                        defaultRunProperties1.Append(complexScriptFont);

                                                        paragraphProperties1.Append(defaultRunProperties1);

                                                        A.Run run = new A.Run();
                                                        A.RunProperties runProperties = new A.RunProperties() { Language = "en-US", FontSize = 1200 };

                                                        var x = (double)Math.Round((decimal)api.Average, 4);

                                                        A.Text text = new A.Text() { Text = $"{x.ToString("F2")}" };
                                                        run.Append(runProperties);
                                                        run.Append(text);
                                                        paragraph.Append(run);

                                                        richText.Append(bodyProperties);
                                                        richText.Append(listStyle);
                                                        richText.Append(paragraph);

                                                        chartText.Append(richText);

                                                        C.ShapeProperties shapeProperties = new C.ShapeProperties();
                                                        A.NoFill noFill = new A.NoFill();
                                                        A.Outline outline1 = new A.Outline();
                                                        A.NoFill noFill2 = new A.NoFill();

                                                        outline1.Append(noFill2);

                                                        A.EffectList effectList = new A.EffectList();

                                                        shapeProperties.Append(noFill);
                                                        shapeProperties.Append(outline1);
                                                        shapeProperties.Append(effectList);

                                                        C.TextProperties textProperties = new C.TextProperties();
                                                        A.BodyProperties bodyProperties1 = new A.BodyProperties();

                                                        A.ShapeAutoFit shapeAutoFit2 = new A.ShapeAutoFit();
                                                        bodyProperties1.Append(shapeAutoFit2);

                                                        A.ListStyle listStyle1 = new A.ListStyle();

                                                        A.Paragraph paragraph1 = new A.Paragraph();
                                                        A.ParagraphProperties paragraphProperties2 = new A.ParagraphProperties();
                                                        A.DefaultRunProperties defaultRunProperties2 = new A.DefaultRunProperties();

                                                        A.SolidFill solidFill2 = new A.SolidFill();
                                                        A.RgbColorModelHex rgbColorModelHex2 = new A.RgbColorModelHex() { Val = "000000" };

                                                        solidFill2.Append(rgbColorModelHex2);

                                                        A.LatinFont latinFont2 = new A.LatinFont() { Typeface = "+mn-lt" };
                                                        A.EastAsianFont eastAsianFont2 = new A.EastAsianFont() { Typeface = "+mn-ea" };
                                                        A.ComplexScriptFont complexScriptFont2 = new A.ComplexScriptFont() { Typeface = "+mn-cs" };

                                                        defaultRunProperties2.Append(solidFill2);

                                                        paragraphProperties2.Append(defaultRunProperties2);

                                                        A.EndParagraphRunProperties endParagraphRunProperties2 =
                                                            new A.EndParagraphRunProperties() { Language = "en-US" };

                                                        paragraph1.Append(endParagraphRunProperties2);
                                                        paragraph1.Append(paragraphProperties2);

                                                        textProperties.Append(bodyProperties1);
                                                        textProperties.Append(listStyle1);
                                                        textProperties.Append(paragraph1);

                                                        dataLabel.Append(index);
                                                        dataLabel.Append(chartText);
                                                        dataLabel.Append(shapeProperties);
                                                        dataLabel.Append(textProperties);

                                                        dataLabels.Append(dataLabel);

                                                        i++;
                                                    }

                                                }
                                            }
                                        }
                                    }
                                }

                                Slide slide1 = slidePart?.Slide;
                                if (slide1 != null)
                                {
                                    CommonSlideData commonSlideData1 = slide1?.GetFirstChild<CommonSlideData>();
                                    if (commonSlideData1 != null)
                                    {
                                        ShapeTree shapeTree1 = commonSlideData1?.GetFirstChild<ShapeTree>();
                                        if (shapeTree1 != null)
                                        {
                                            var testNameShapes = shapeTree1?.Elements<P.Shape>()
                                                   .Where(shape => shape.InnerText.Contains("TESTNAME"))
                                                   .OrderBy(shape =>
                                                   {
                                                       var match = Regex.Match(shape.InnerText, @"TESTNAME(\d+)");
                                                       return match.Success ? int.Parse(match.Groups[1].Value) : int.MaxValue;
                                                   })
                                                   .ToList();

                                            if (testNameShapes != null && testNameShapes.Count > 0)
                                            {
                                                for (int i = 0; i < testNameShapes.Count && i < apiData.Count; i++)
                                                {
                                                    var shape = testNameShapes[i];
                                                    var apiItem = apiData[apiData.Count - i - 1];

                                                    P.TextBody textBody = shape?.GetFirstChild<P.TextBody>();
                                                    if (textBody != null)
                                                    {
                                                        A.Paragraph paragraph = textBody?.Elements<A.Paragraph>().FirstOrDefault();
                                                        if (paragraph != null)
                                                        {
                                                            A.Run run = paragraph?.Elements<A.Run>().FirstOrDefault();

                                                            if (run != null)
                                                            {
                                                                A.RunProperties runProperties = run?.GetFirstChild<A.RunProperties>();

                                                                if (runProperties != null)
                                                                {
                                                                    runProperties.FontSize = DEFAULT_FONT_SIZE;
                                                                    if (apiData[apiData.Count - i - 1].TestNameBold == true)
                                                                    {
                                                                        runProperties.Bold = apiData[apiData.Count - i - 1].TestNameBold;
                                                                    }
                                                                    else
                                                                    {
                                                                        runProperties.Bold = false;
                                                                    }
                                                                }

                                                                A.SolidFill solidFill1 = runProperties?.GetFirstChild<A.SolidFill>();
                                                                if (solidFill1 != null)
                                                                {
                                                                    A.RgbColorModelHex rgbColor1 = solidFill1?.GetFirstChild<A.RgbColorModelHex>();
                                                                    if (rgbColor1 != null)
                                                                    {
                                                                        if (apiData[apiData.Count - i - 1].TestNameColor != null)
                                                                        {
                                                                            rgbColor1.Val = apiData[apiData.Count - i - 1].TestNameColor.TrimStart('#');
                                                                        }
                                                                        else
                                                                        {
                                                                            rgbColor1.Val = DEFAULT_COLOR;
                                                                        }
                                                                    }
                                                                }

                                                                A.Text text = run?.GetFirstChild<A.Text>();
                                                                if (text != null)
                                                                {
                                                                    if (apiData[apiData.Count - i - 1].TestName != null)
                                                                    {
                                                                        text.Text = apiData[apiData.Count - i - 1].TestName.Trim(' ', '(', '?', ')').ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        text.Text = "";
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                            slide1.Save();
                                        }
                                    }
                                    chartPart.ChartSpace.Save();
                                }
                                slidePart.Slide.Save();
                            }
                            presentationDocument.Save();
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }

        //MEMORABILITY HISTORICAL DATA
        public void MemorabilityTemplateForAll(string destination, List<Memorability> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    if (presentationDocument != null)
                    {
                        SlidePart slidePart = presentationDocument?.PresentationPart?.SlideParts.First();
                        if (slidePart != null)
                        {
                            ChartPart chartPart = slidePart?.ChartParts?.First();
                            if (chartPart != null)
                            {
                                EmbeddedPackagePart embeddedPackagePart = chartPart?.EmbeddedPackagePart;
                                BarChart barChart = chartPart?.ChartSpace?.Descendants<BarChart>().First();

                                if (embeddedPackagePart != null)
                                {
                                    using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                    {
                                        if (spreadsheet != null)
                                        {
                                            WorksheetPart worksheetPart = spreadsheet?.WorkbookPart?.WorksheetParts.First();

                                            if (worksheetPart != null)
                                            {
                                                SheetData sheetData = worksheetPart?.Worksheet?.Elements<SheetData>().FirstOrDefault();

                                                int excelDataIndex = 2;
                                                Cell cellVariableObj;

                                                apiData.Sort((x, y) => (x.Average ?? 0).CompareTo(y.Average ?? 0));

                                                if (sheetData != null)
                                                {
                                                    foreach (var apiVariables in apiData)
                                                    {
                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>()
                                                            .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                        }

                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>()
                                                            .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.Average.ToString());
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                        }
                                                        excelDataIndex++;
                                                    }

                                                    for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                                    {
                                                        Row row = sheetData?.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                        if (row != null)
                                                        {
                                                            row.Remove();
                                                        }
                                                    }
                                                }
                                            }
                                        }

                                        char[] columns = { 'B' };
                                        int columnIndex = 0;

                                        if (barChart != null)
                                        {
                                            foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                               barChart?.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                            {
                                                if (columnIndex < columns.Length)
                                                {
                                                    char column = columns[columnIndex];

                                                    NumberReference numberReference =
                                                        barChartSeries?.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First()?.
                                                        Elements<NumberReference>().First();

                                                    if (numberReference != null)
                                                    {
                                                        numberReference.Formula =
                                                        new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                        NumberingCache numberingCache = numberReference?.Elements<NumberingCache>().First();
                                                        numberingCache.RemoveAllChildren();

                                                        int idx = 0;

                                                        foreach (var api in apiData)
                                                        {
                                                            long chartValue;

                                                            numberingCache.Append(new NumericPoint()
                                                            {
                                                                Index = (uint)idx,
                                                                NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.Average.ToString())
                                                            });
                                                            idx++;
                                                        }
                                                    }
                                                }

                                                StringReference stringReference = barChartSeries?.Elements<CategoryAxisData>()
                                                                                    .First().Elements<StringReference>().First();

                                                if (stringReference != null)
                                                {
                                                    stringReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.
                                                        Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                                    StringCache stringCache = stringReference?.Elements<StringCache>().First();
                                                    stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                                    int catIdx = 0;

                                                    foreach (var api in apiData)
                                                    {
                                                        stringCache.Append(new StringPoint()
                                                        {
                                                            Index = (uint)catIdx,
                                                            NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                        });

                                                        catIdx++;
                                                    }
                                                }

                                                double historicalAvg = 0.0;

                                                ///////////////////////////// Original///////////////////////////////////
                                                //if (apiData.FirstOrDefault().TestName.Equals("[Refreshed Hist. Mean]"))
                                                //{
                                                //    historicalAvg = Math.Round(apiData.FirstOrDefault().Average, 2);
                                                //}

                                                var meanValue = apiData.Where(x => x.TestName.Contains("Refreshed Hist. Mean")).ToList();

                                                if (meanValue.Count == 1)
                                                {
                                                    var value = meanValue[0].Average;
                                                    historicalAvg = (double)(Math.Round((decimal)value, 2));
                                                }

                                                C.DataLabels dataLabels = barChartSeries?.GetFirstChild<C.DataLabels>();

                                                int i = 0;

                                                if (dataLabels != null)
                                                {
                                                    foreach (var dataPoint in apiData)
                                                    {
                                                        C.DataLabel dataLabel = new C.DataLabel();
                                                        C.Index index = new C.Index() { Val = (uint)i };

                                                        C.ChartText chartText = new C.ChartText();
                                                        C.RichText richText = new C.RichText();
                                                        A.BodyProperties bodyProperties = new A.BodyProperties();
                                                        A.ListStyle listStyle = new A.ListStyle();

                                                        A.Paragraph paragraph = new A.Paragraph();
                                                        A.Run run = new A.Run();
                                                        A.RunProperties runProperties = new A.RunProperties() { Language = "en-US" };

                                                        double apiDecimalValue = (double)(Math.Round((decimal)dataPoint.Average, 2));

                                                        double percentageValue = (double)(Math.Round((decimal)dataPoint.Average * 100, 2));

                                                        A.Text text;

                                                        text = new A.Text();

                                                        ////////////////////////////Original////////////////////////////////
                                                        //text.Text = $"{percentageValue:0.0}%";

                                                        if (historicalAvg == 0.0)
                                                        {
                                                            text.Text = $"{percentageValue:0.0}%";
                                                        }
                                                        else
                                                        {
                                                            if (apiDecimalValue <= historicalAvg)
                                                            {
                                                                text = new A.Text();
                                                                text.Text = $"{percentageValue:0.0}%";
                                                            }
                                                            else
                                                            {
                                                                text = new A.Text();
                                                                text.Text = $"{percentageValue:0.0}%*";
                                                            }
                                                        }

                                                        run.Append(runProperties);
                                                        run.Append(text);
                                                        paragraph.Append(run);

                                                        richText.Append(bodyProperties);
                                                        richText.Append(listStyle);
                                                        richText.Append(paragraph);

                                                        chartText.Append(richText);

                                                        dataLabel.Append(index);
                                                        dataLabel.Append(chartText);

                                                        dataLabel.Append(new C.ShowLegendKey() { Val = false });
                                                        dataLabel.Append(new C.ShowValue() { Val = true });
                                                        dataLabel.Append(new C.ShowCategoryName() { Val = false });
                                                        dataLabel.Append(new C.ShowSeriesName() { Val = false });
                                                        dataLabel.Append(new C.ShowPercent() { Val = false });
                                                        dataLabel.Append(new C.ShowBubbleSize() { Val = false });

                                                        C.ExtensionList extList = new C.ExtensionList();

                                                        C.Extension ext1 = new C.Extension() { Uri = "{CE6537A1-D6FC-4f65-9D91-7224C49458BB}" };
                                                        extList.Append(ext1);

                                                        C.Extension ext2 = new C.Extension() { Uri = "{C3380CC4-5D6E-409C-BE32-E72D297353CC}" };
                                                        extList.Append(ext2);

                                                        dataLabel.Append(extList);

                                                        dataLabels.Append(dataLabel);

                                                        i++;
                                                    }

                                                }
                                            }
                                        }
                                    }
                                }

                                Slide slide1 = slidePart?.Slide;
                                if (slide1 != null)
                                {
                                    CommonSlideData commonSlideData1 = slide1?.GetFirstChild<CommonSlideData>();
                                    if (commonSlideData1 != null)
                                    {
                                        ShapeTree shapeTree1 = commonSlideData1?.GetFirstChild<ShapeTree>();
                                        if (shapeTree1 != null)
                                        {
                                            var testNameShapes = shapeTree1?.Elements<P.Shape>()
                                                         .Where(shape => shape.InnerText.Contains("TESTNAME"))
                                                         .OrderBy(shape =>
                                                         {
                                                             var match = Regex.Match(shape.InnerText, @"TESTNAME(\d+)");
                                                             return match.Success ? int.Parse(match.Groups[1].Value) : int.MaxValue;
                                                         })
                                                         .ToList();

                                            if (testNameShapes != null && testNameShapes.Count > 0)
                                            {
                                                for (int i = 0; i < testNameShapes.Count && i < apiData.Count; i++)
                                                {
                                                    var shape = testNameShapes[i];
                                                    var apiItem = apiData[apiData.Count - i - 1];

                                                    if (shape != null)
                                                    {
                                                        P.TextBody textBody = shape?.GetFirstChild<P.TextBody>();
                                                        if (textBody != null)
                                                        {
                                                            A.Paragraph paragraph = textBody?.Elements<A.Paragraph>().FirstOrDefault();
                                                            if (paragraph != null)
                                                            {
                                                                A.Run run = paragraph?.Elements<A.Run>().FirstOrDefault();
                                                                if (run != null)
                                                                {
                                                                    A.RunProperties runProperties = run?.GetFirstChild<A.RunProperties>();
                                                                    if (runProperties != null)
                                                                    {
                                                                        runProperties.FontSize = DEFAULT_FONT_SIZE;
                                                                        if (apiData[apiData.Count - i - 1].TestNameBold == true)
                                                                        {
                                                                            runProperties.Bold = apiData[apiData.Count - i - 1].TestNameBold;
                                                                        }
                                                                        else
                                                                        {
                                                                            runProperties.Bold = false;
                                                                        }
                                                                    }

                                                                    A.SolidFill solidFill1 = runProperties?.GetFirstChild<A.SolidFill>();
                                                                    if (solidFill1 != null)
                                                                    {
                                                                        A.RgbColorModelHex rgbColor1 = solidFill1?.GetFirstChild<A.RgbColorModelHex>();
                                                                        if (rgbColor1 != null)
                                                                        {
                                                                            if (apiData[apiData.Count - i - 1].TestNameColor != null)
                                                                            {
                                                                                rgbColor1.Val = apiData[apiData.Count - i - 1].TestNameColor.TrimStart('#');
                                                                            }
                                                                            else
                                                                            {
                                                                                rgbColor1.Val = DEFAULT_COLOR;
                                                                            }
                                                                        }
                                                                    }

                                                                    A.Text text = run?.GetFirstChild<A.Text>();
                                                                    if (text != null)
                                                                    {
                                                                        if (apiData[apiData.Count - i - 1].TestName != null)
                                                                        {
                                                                            text.Text = apiData[apiData.Count - i - 1].TestName.ToString();
                                                                        }
                                                                        else
                                                                        {
                                                                            text.Text = "";
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    slide1.Save();
                                }
                                chartPart.ChartSpace.Save();
                            }
                            slidePart.Slide.Save();
                        }
                    }
                    presentationDocument.Save();
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }


        //PERSONAL PREFERENCE HISTORICAL DATA
        public void PersonalPreferencesTemplateForAll(string destination, List<PersonalPreference> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    if (presentationDocument != null)
                    {
                        SlidePart slidePart = presentationDocument?.PresentationPart?.SlideParts.First();
                        if (slidePart != null)
                        {
                            ChartPart chartPart = slidePart?.ChartParts.First();
                            if (chartPart != null)
                            {
                                EmbeddedPackagePart embeddedPackagePart = chartPart?.EmbeddedPackagePart;
                                BarChart barChart = chartPart?.ChartSpace?.Descendants<BarChart>().First();

                                if (embeddedPackagePart != null)
                                {
                                    using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                    {
                                        WorksheetPart worksheetPart = spreadsheet?.WorkbookPart.WorksheetParts.First();

                                        if (worksheetPart != null)
                                        {
                                            SheetData sheetData = worksheetPart?.Worksheet?.Elements<SheetData>().FirstOrDefault();

                                            int excelDataIndex = 2;
                                            Cell cellVariableObj;

                                            apiData.Sort((x, y) => (x.Average ?? 0).CompareTo(y.Average ?? 0));

                                            if (sheetData != null)
                                            {
                                                foreach (var apiVariables in apiData)
                                                {
                                                    cellVariableObj =
                                                        sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                    if (cellVariableObj != null)
                                                    {
                                                        cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                        cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                    }

                                                    cellVariableObj =
                                                        sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                    if (cellVariableObj != null)
                                                    {
                                                        cellVariableObj.CellValue = new CellValue(apiVariables.Average.ToString());
                                                        cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                    }
                                                    excelDataIndex++;
                                                }

                                                for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                                {
                                                    Row row = sheetData?.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                    if (row != null)
                                                    {
                                                        row.Remove();
                                                    }
                                                }
                                            }
                                        }

                                        char[] columns = { 'B' };
                                        int columnIndex = 0;

                                        if (barChart != null)
                                        {
                                            foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                                    barChart?.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                            {
                                                if (columnIndex < columns.Length)
                                                {
                                                    char column = columns[columnIndex];

                                                    NumberReference numberReference =
                                                        barChartSeries?.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First()?.
                                                        Elements<NumberReference>().First();

                                                    if (numberReference != null)
                                                    {
                                                        numberReference.Formula =
                                                        new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                        NumberingCache numberingCache = numberReference?.Elements<NumberingCache>().First();
                                                        numberingCache.RemoveAllChildren();

                                                        int idx = 0;

                                                        foreach (var api in apiData)
                                                        {
                                                            long chartValue;

                                                            numberingCache.Append(new NumericPoint()
                                                            {
                                                                Index = (uint)idx,
                                                                NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.Average.ToString())
                                                            });
                                                            idx++;
                                                        }
                                                    }
                                                }

                                                StringReference stringReference = barChartSeries?.Elements<CategoryAxisData>()
                                                                                    .First().Elements<StringReference>().First();

                                                if (stringReference != null)
                                                {
                                                    stringReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.
                                                        Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                                    StringCache stringCache = stringReference?.Elements<StringCache>().First();
                                                    stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                                    int catIdx = 0;

                                                    foreach (var api in apiData)
                                                    {
                                                        stringCache.Append(new StringPoint()
                                                        {
                                                            Index = (uint)catIdx,
                                                            NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                        });
                                                        catIdx++;
                                                    }
                                                }

                                                double historicalAvg = 0.00;

                                                /////////////////////////////////Original ////////////////////////////////////
                                                //if (apiData.FirstOrDefault().TestName.Equals("[Refreshed Hist. Mean]"))
                                                //{
                                                //    historicalAvg = Math.Round(apiData.FirstOrDefault().Average, 2);
                                                //}

                                                var meanValue = apiData.Where(x => x.TestName.Contains("Refreshed Hist. Mean")).ToList();

                                                if (meanValue.Count == 1)
                                                {
                                                    var value = meanValue[0].Average;
                                                    historicalAvg = (double)Math.Round((decimal)value, 2);
                                                }

                                                C.DataLabels dataLabels = barChartSeries?.GetFirstChild<C.DataLabels>();

                                                int i = 0;

                                                if (dataLabels != null)
                                                {
                                                    foreach (var dataPoint in apiData)
                                                    {
                                                        C.DataLabel dataLabel = new C.DataLabel();
                                                        C.Index index = new C.Index() { Val = (uint)i };

                                                        C.ChartText chartText = new C.ChartText();
                                                        C.RichText richText = new C.RichText();
                                                        A.BodyProperties bodyProperties = new A.BodyProperties();
                                                        A.ListStyle listStyle = new A.ListStyle();

                                                        A.Paragraph paragraph = new A.Paragraph();
                                                        A.Run run = new A.Run();
                                                        A.RunProperties runProperties = new A.RunProperties() { Language = "en-US" };
                                                        
                                                        double percentageValue = (double)(Math.Round((decimal)dataPoint.Average, 4));

                                                        A.Text text;
                                                        text = new A.Text();

                                                        ////////////////////////// Original /////////////////////////////////
                                                        //text.Text = $"{percentageValue:0.00}";

                                                        if (historicalAvg == 0.0)
                                                        {
                                                            text.Text = $"{percentageValue:0.00}";
                                                        }
                                                        else
                                                        {
                                                            if (percentageValue <= historicalAvg)
                                                            {
                                                                text = new A.Text();
                                                                text.Text = $"{percentageValue:0.00}";
                                                            }
                                                            else
                                                            {
                                                                text = new A.Text();
                                                                text.Text = $"{percentageValue:0.00}*";
                                                            }
                                                        }

                                                        run.Append(runProperties);
                                                        run.Append(text);
                                                        paragraph.Append(run);

                                                        richText.Append(bodyProperties);
                                                        richText.Append(listStyle);
                                                        richText.Append(paragraph);

                                                        chartText.Append(richText);

                                                        dataLabel.Append(index);
                                                        dataLabel.Append(chartText);

                                                        dataLabel.Append(new C.ShowLegendKey() { Val = false });
                                                        dataLabel.Append(new C.ShowValue() { Val = true });
                                                        dataLabel.Append(new C.ShowCategoryName() { Val = false });
                                                        dataLabel.Append(new C.ShowSeriesName() { Val = false });
                                                        dataLabel.Append(new C.ShowPercent() { Val = false });
                                                        dataLabel.Append(new C.ShowBubbleSize() { Val = false });

                                                        C.ExtensionList extList = new C.ExtensionList();

                                                        C.Extension ext1 = new C.Extension() { Uri = "{CE6537A1-D6FC-4f65-9D91-7224C49458BB}" };
                                                        extList.Append(ext1);

                                                        C.Extension ext2 = new C.Extension() { Uri = "{C3380CC4-5D6E-409C-BE32-E72D297353CC}" };
                                                        extList.Append(ext2);

                                                        dataLabel.Append(extList);

                                                        dataLabels.Append(dataLabel);

                                                        i++;
                                                    }
                                                }

                                                int j = 0;

                                                //foreach (var dataPoints in barChartSeries.Elements<C.DataPoint>().ToList())
                                                //{
                                                //    var charSpaceForBlip = dataPoints.GetFirstChild<C.ChartShapeProperties>();
                                                //    var blip = charSpaceForBlip.GetFirstChild<A.BlipFill>();

                                                //    if (j == 0)
                                                //    {
                                                //        if (blip != null)
                                                //        {
                                                //            blip.Remove();
                                                //        }

                                                //        var existingSolidFill = charSpaceForBlip.GetFirstChild<A.SolidFill>();
                                                //        if (existingSolidFill != null)
                                                //        {
                                                //            existingSolidFill.Remove();
                                                //        }

                                                //        A.SolidFill solidFill1 = new A.SolidFill();
                                                //        A.RgbColorModelHex rgbColorModelHex1 = new A.RgbColorModelHex() { Val = apiData[j].AverageColor.TrimStart('#') };

                                                //        solidFill1.Append(rgbColorModelHex1);

                                                //        var line = charSpaceForBlip.GetFirstChild<A.Outline>();
                                                //        var effectList = charSpaceForBlip.GetFirstChild<A.EffectList>();

                                                //        if (line != null)
                                                //        {
                                                //            charSpaceForBlip.InsertBefore(solidFill1, line);
                                                //        }
                                                //        else if (effectList != null)
                                                //        {
                                                //            charSpaceForBlip.InsertBefore(solidFill1, effectList);
                                                //        }
                                                //        else
                                                //        {
                                                //            charSpaceForBlip.Append(solidFill1);
                                                //        }

                                                //        //Console.WriteLine(solidFill1.GetFirstChild<RgbColorModelHex>().Val + " " + j);
                                                //    }
                                                //    if (j > 0 && j < apiData.Count)
                                                //    {
                                                //        C.ChartShapeProperties chartShapeProperties = dataPoints.GetFirstChild<C.ChartShapeProperties>();
                                                //        A.SolidFill solidFillFromChart = chartShapeProperties.GetFirstChild<A.SolidFill>();

                                                //        if (solidFillFromChart != null)
                                                //        {
                                                //            solidFillFromChart.Remove();
                                                //        }

                                                //        A.SolidFill solidFill = new A.SolidFill();
                                                //        A.RgbColorModelHex rgb = new A.RgbColorModelHex() { Val = apiData[j].AverageColor.TrimStart('#') };

                                                //        solidFill.Append(rgb);

                                                //        var line = chartShapeProperties.GetFirstChild<A.Outline>();
                                                //        var effectList = chartShapeProperties.GetFirstChild<A.EffectList>();

                                                //        if (line != null)
                                                //        {
                                                //            chartShapeProperties.InsertBefore(solidFill, line);
                                                //        }
                                                //        else if (effectList != null)
                                                //        {
                                                //            chartShapeProperties.InsertBefore(solidFill, effectList);
                                                //        }
                                                //        else
                                                //        {
                                                //            chartShapeProperties.Append(solidFill);
                                                //        }
                                                //        //Console.WriteLine(solidFill.GetFirstChild<RgbColorModelHex>().Val + " " + j);
                                                //    }
                                                //    j++;
                                                //}
                                            }
                                        }
                                    }
                                }

                                Slide slide1 = slidePart?.Slide;
                                if (slide1 != null)
                                {
                                    CommonSlideData commonSlideData1 = slide1?.GetFirstChild<CommonSlideData>();
                                    if (commonSlideData1 != null)
                                    {
                                        ShapeTree shapeTree1 = commonSlideData1?.GetFirstChild<ShapeTree>();
                                        if (shapeTree1 != null)
                                        {
                                            var selectedShapes = shapeTree1?.Elements<P.Shape>().Where(shape => shape.InnerText.Contains("TESTNAME"))
                                                .OrderBy(shape =>
                                                {
                                                    var match = Regex.Match(shape.InnerText, @"TESTNAME(\d+)");
                                                    return match.Success ? int.Parse(match.Groups[1].Value) : int.MaxValue;
                                                }).ToList();

                                            if (shapeTree1 != null)
                                            {
                                                for (int i = 0; i < selectedShapes.Count && i < apiData.Count; i++)
                                                {
                                                    var shape = selectedShapes[i];
                                                    var apiItem = apiData[apiData.Count - i - 1];

                                                    if (shape != null)
                                                    {
                                                        P.TextBody textBody = shape?.GetFirstChild<P.TextBody>();
                                                        if (textBody != null)
                                                        {
                                                            A.Paragraph paragraph = textBody?.Elements<A.Paragraph>().FirstOrDefault();
                                                            if (paragraph != null)
                                                            {
                                                                A.Run run = paragraph?.Elements<A.Run>().FirstOrDefault();

                                                                if (run != null)
                                                                {
                                                                    A.RunProperties runProperties = run?.GetFirstChild<A.RunProperties>();
                                                                    if (runProperties != null)
                                                                    {
                                                                        runProperties.FontSize = DEFAULT_FONT_SIZE;
                                                                        if (apiData[apiData.Count - i - 1].TestNameBold == true)
                                                                        {
                                                                            runProperties.Bold = apiData[apiData.Count - i - 1].TestNameBold;
                                                                        }
                                                                        else
                                                                        {
                                                                            runProperties.Bold = false;
                                                                        }
                                                                    }

                                                                    A.SolidFill solidFill1 = runProperties?.GetFirstChild<A.SolidFill>();
                                                                    if (solidFill1 != null)
                                                                    {
                                                                        A.RgbColorModelHex rgbColor1 = solidFill1?.GetFirstChild<A.RgbColorModelHex>();
                                                                        if (rgbColor1 != null)
                                                                        {
                                                                            if (apiData[apiData.Count - i - 1].TestNameColor != null)
                                                                            {
                                                                                rgbColor1.Val = apiData[apiData.Count - i - 1].TestNameColor.TrimStart('#');
                                                                            }
                                                                            else
                                                                            {
                                                                                rgbColor1.Val = DEFAULT_COLOR;
                                                                            }
                                                                        }
                                                                    }

                                                                    A.Text text = run?.GetFirstChild<A.Text>();
                                                                    if (text != null)
                                                                    {
                                                                        if (apiData[apiData.Count - i - 1].TestName != null)
                                                                        {
                                                                            text.Text = apiData[apiData.Count - i - 1].TestName.ToString();
                                                                        }
                                                                        else
                                                                        {
                                                                            text.Text = "";
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    slide1.Save();
                                    chartPart.ChartSpace.Save();
                                    slidePart.Slide.Save();
                                }
                            }
                        }
                    }
                    presentationDocument.Save();
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }


        // SUFFIX TEMPLATE
        public void SuffixTemplateForAll(string destination, List<Suffix> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    string strPageName = "";

                    if (presentationDocument != null)
                    {
                        SlidePart slidePart = presentationDocument.PresentationPart.SlideParts.First();

                        if (slidePart != null)
                        {
                            ChartPart chartPart = slidePart.ChartParts.First();

                            if (chartPart != null)
                            {
                                EmbeddedPackagePart embeddedPackagePart = chartPart.EmbeddedPackagePart;
                                BarChart barChart = chartPart.ChartSpace.Descendants<BarChart>().First();

                                if (embeddedPackagePart != null)
                                {
                                    using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                    {
                                        if (spreadsheet != null)
                                        {
                                            WorksheetPart worksheetPart = spreadsheet.WorkbookPart.WorksheetParts.First();

                                            if (worksheetPart != null)
                                            {
                                                SheetData sheetData = worksheetPart.Worksheet.Elements<SheetData>().FirstOrDefault();

                                                int excelDataIndex = 2;
                                                Cell cellVariableObj;

                                                apiData.Sort((x, y) => (x.Negative).CompareTo(y.Negative));

                                                if (sheetData != null)
                                                {
                                                    foreach (var apiVariables in apiData)
                                                    {
                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>()
                                                            .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                        }

                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>()
                                                            .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.Negative.ToString());
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                        }

                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>()
                                                                .FirstOrDefault(c => c.CellReference == "C" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.Positive.ToString());
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                        }
                                                        excelDataIndex++;
                                                    }

                                                    for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                                    {
                                                        Row row = sheetData.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                        if (row != null)
                                                        {
                                                            row.Remove();
                                                        }
                                                    }
                                                }
                                            }
                                        }

                                        char[] columns = { 'B', 'C' };
                                        int columnIndex = 0;

                                        if (chartPart != null)
                                        {
                                            foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                            barChart.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                            {
                                                if (columnIndex < columns.Length)
                                                {
                                                    char column = columns[columnIndex];

                                                    NumberReference numberReference =
                                                        barChartSeries.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First().
                                                        Elements<NumberReference>().First();

                                                    numberReference.Formula =
                                                        new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                    NumberingCache numberingCache = numberReference.Elements<NumberingCache>().First();
                                                    numberingCache.RemoveAllChildren();
                                                    numberingCache.Append(new C.FormatCode("0.0"));

                                                    int idx = 0;

                                                    foreach (var api in apiData)
                                                    {
                                                        double chartValue;

                                                        switch (column)
                                                        {
                                                            case 'B':
                                                                chartValue = api.Negative;
                                                                break;

                                                            //case 'C':
                                                            //    chartValue = api.Neutral;
                                                            //    break;

                                                            case 'C':
                                                                chartValue = api.Positive;
                                                                break;

                                                            default:
                                                                chartValue = 0;
                                                                break;
                                                        }

                                                        numberingCache.Append(new NumericPoint()
                                                        {
                                                            Index = (uint)idx,
                                                            NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue((Math.Round(chartValue * 10) / 10).ToString("F2"))
                                                        });
                                                        idx++;

                                                    }
                                                    columnIndex++;
                                                }

                                                StringReference stringReference = barChartSeries.Elements<CategoryAxisData>()
                                                                                    .First().Elements<StringReference>().First();

                                                stringReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.
                                                        Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                                StringCache stringCache = stringReference.Elements<StringCache>().First();

                                                stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                                int catIdx = 0;

                                                foreach (var api in apiData)
                                                {
                                                    stringCache.Append(new StringPoint()
                                                    {
                                                        Index = (uint)catIdx,
                                                        NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                    });

                                                    StringPoint stringPoint = stringCache.Elements<StringPoint>().First();
                                                    catIdx++;
                                                }
                                            }
                                        }


                                        //C.Chart chart1 = chartPart.ChartSpace.GetFirstChild<C.Chart>();
                                        //C.PlotArea plotArea1 = chart1.GetFirstChild<C.PlotArea>();

                                        //C.ValueAxis valueAxis1 = plotArea1.GetFirstChild<C.ValueAxis>();
                                        //C.Scaling scaling1 = valueAxis1.GetFirstChild<C.Scaling>();

                                        //C.MinAxisValue minAxisValue1 = scaling1.AppendChild(new C.MinAxisValue() { Val = 0 });

                                        //C.CategoryAxis categoryAxis1 = plotArea1.GetFirstChild<C.CategoryAxis>();
                                        //C.Delete delete1 = categoryAxis1.GetFirstChild<C.Delete>();
                                        //C.ChartShapeProperties chartShapeProperties1 = categoryAxis1.GetFirstChild<C.ChartShapeProperties>();
                                        //C.TextProperties textProperties1 = categoryAxis1.GetFirstChild<C.TextProperties>();
                                        //delete1.Val = true;

                                        //if (chartShapeProperties1 != null)
                                        //{
                                        //    chartShapeProperties1.Remove();
                                        //}

                                        //if (textProperties1 != null)
                                        //{
                                        //    textProperties1.Remove();
                                        //}
                                    }
                                }

                                Slide slide1 = slidePart.Slide;

                                if (slide1 != null)
                                {
                                    CommonSlideData commonSlideData1 = slide1.GetFirstChild<CommonSlideData>();

                                    if (commonSlideData1 != null)
                                    {
                                        ShapeTree shapeTree1 = commonSlideData1.GetFirstChild<ShapeTree>();

                                        if (shapeTree1 != null)
                                        {
                                            var firstShape = shapeTree1.GetFirstChild<P.Shape>();

                                            if (firstShape != null)
                                            {
                                                var firstShapeTextBody = firstShape.GetFirstChild<P.TextBody>();
                                                if (firstShapeTextBody != null)
                                                {
                                                    var firstParagraph = firstShapeTextBody.GetFirstChild<A.Paragraph>();

                                                    if (firstParagraph != null)
                                                    {
                                                        foreach (var run in firstParagraph.Elements<A.Run>())
                                                        {
                                                            if (run != null)
                                                            {
                                                                A.Text text2 = run.GetFirstChild<A.Text>();
                                                                if (text2.Text.Contains("Appendix - <<"))
                                                                {
                                                                    text2.Text = "Appendix - ";
                                                                }

                                                                else if (text2.Text.Contains("SuffixTitle"))
                                                                {
                                                                    text2.Text = $"Some group";
                                                                }

                                                                else if (text2.Text.Contains(">>* Results"))
                                                                {
                                                                    text2.Text = "* Results";
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            var description = shapeTree1?.Elements<P.Shape>()
                                                        .Where(shape => shape.InnerText.Contains("<<Description>>")).ToList();

                                            if (description.Count > 0 && description != null)
                                            {
                                                var textBody = description[0]?.GetFirstChild<P.TextBody>();
                                                if (textBody != null)
                                                {
                                                    var paragraph = textBody?.GetFirstChild<A.Paragraph>();
                                                    if (paragraph != null)
                                                    {
                                                        var run = paragraph?.GetFirstChild<A.Run>();
                                                        if (run != null)
                                                        {
                                                            var text = run.GetFirstChild<A.Text>();
                                                            if (text != null)
                                                            {
                                                                if (text.Text.Contains("<<Description>>"))
                                                                {
                                                                    if (strPageName.Trim().ToUpper() == "EXISTING ABBREVIATION ID")
                                                                    {
                                                                        text.Text = "Respondents were asked if there are any existing abbreviations/acronyms that use the following four-letter suffixes.";
                                                                    }
                                                                    else if (strPageName.Trim().ToUpper() == "EXISTING SUFFIX ID")
                                                                    {
                                                                        text.Text = "Respondents were asked if there any existing over-the-counter or prescription pharmaceutical brand names that use the following four-letter suffix.";
                                                                    }
                                                                    else if (strPageName.Trim().ToUpper() == "SUFFIX MEANING")
                                                                    {
                                                                        text.Text = "This measurement is designed to find what meaning is conveyed by each four-letter suffix.";
                                                                    }
                                                                    else
                                                                    {
                                                                        text.Text = "This measurement is designed to find what meaning is conveyed by each four-letter suffix.";
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            var testNameShapes = shapeTree1.Elements<P.Shape>()
                                               .Where(shape => shape.InnerText.Contains("TESTNAME"))
                                               .OrderBy(shape =>
                                               {
                                                   var match = Regex.Match(shape.InnerText, @"TESTNAME(\d+)");
                                                   return match.Success ? int.Parse(match.Groups[1].Value) : int.MaxValue;
                                               })
                                               .ToList();

                                            if (testNameShapes != null && testNameShapes.Count > 0)
                                            {
                                                for (int i = 0; i < testNameShapes.Count && i < apiData.Count; i++)
                                                {
                                                    var shape = testNameShapes[i];
                                                    var apiItem = apiData[apiData.Count - i - 1];

                                                    if (shape != null)
                                                    {
                                                        P.TextBody textBody = shape.GetFirstChild<P.TextBody>();
                                                        if (textBody != null)
                                                        {
                                                            A.Paragraph paragraph = textBody.Elements<A.Paragraph>().FirstOrDefault();
                                                            if (paragraph != null)
                                                            {
                                                                A.Run run = paragraph.Elements<A.Run>().FirstOrDefault();
                                                                if (run != null)
                                                                {
                                                                    A.RunProperties runProperties = run.GetFirstChild<A.RunProperties>();

                                                                    if (runProperties != null)
                                                                    {
                                                                        runProperties.FontSize = DEFAULT_FONT_SIZE;

                                                                        if (apiData[apiData.Count - i - 1].TestNameBold == true)
                                                                        {
                                                                            runProperties.Bold = apiData[apiData.Count - i - 1].TestNameBold;
                                                                        }
                                                                        else
                                                                        {
                                                                            runProperties.Bold = false;
                                                                        }
                                                                    }

                                                                    A.SolidFill solidFill1 = runProperties.GetFirstChild<A.SolidFill>();
                                                                    if (solidFill1 != null)
                                                                    {
                                                                        A.RgbColorModelHex rgbColor1 = solidFill1.GetFirstChild<A.RgbColorModelHex>();
                                                                        if (rgbColor1 != null)
                                                                        {
                                                                            if (apiData[apiData.Count - i - 1].TestNameColor != null)
                                                                            {
                                                                                rgbColor1.Val = apiData[apiData.Count - i - 1].TestNameColor.TrimStart('#');
                                                                            }
                                                                            else
                                                                            {
                                                                                rgbColor1.Val = DEFAULT_COLOR;
                                                                            }
                                                                        }
                                                                    }

                                                                    A.Text text = run.GetFirstChild<A.Text>();
                                                                    if (text != null)
                                                                    {
                                                                        if (apiData[apiData.Count - i - 1].TestName != null)
                                                                        {
                                                                            text.Text = apiData[apiData.Count - i - 1].TestName.ToString();
                                                                        }
                                                                        else
                                                                        {
                                                                            text.Text = "";
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    slide1.Save();
                                }
                            }

                            chartPart.ChartSpace.Save();
                        }

                        slidePart.Slide.Save();
                    }

                    presentationDocument.Save();
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }


        // VERBAL UNDERSTANDING BAR TEMPLATE
        public void VerbalUnderstandingBarTemplateForAll(string destination, List<VerbalUnderstanding> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    if (presentationDocument != null)
                    {
                        SlidePart slidePart = presentationDocument?.PresentationPart?.SlideParts.First();

                        if (slidePart != null)
                        {
                            ChartPart chartPart = slidePart?.ChartParts?.First();

                            if (chartPart != null)
                            {
                                EmbeddedPackagePart embeddedPackagePart = chartPart?.EmbeddedPackagePart;
                                BarChart barChart = chartPart?.ChartSpace?.Descendants<BarChart>().First();

                                if (embeddedPackagePart != null)
                                {
                                    using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                    {
                                        if (spreadsheet != null)
                                        {
                                            WorksheetPart worksheetPart = spreadsheet?.WorkbookPart?.WorksheetParts.First();

                                            if (worksheetPart != null)
                                            {
                                                SheetData sheetData = worksheetPart?.Worksheet?.Elements<SheetData>().FirstOrDefault();

                                                int excelDataIndex = 2;
                                                Cell cellVariableObj;
                                                
                                                apiData.Sort((x, y) => (x.Average ?? 0).CompareTo(y.Average ?? 0));

                                                if (sheetData != null)
                                                {
                                                    foreach (var apiVariables in apiData)
                                                    {
                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>()
                                                            .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                        }

                                                        cellVariableObj =
                                                            sheetData.Descendants<Cell>()
                                                            .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                        if (cellVariableObj != null)
                                                        {
                                                            cellVariableObj.CellValue = new CellValue(apiVariables.Average.ToString());
                                                            cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                        }
                                                        excelDataIndex++;
                                                    }

                                                    for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                                    {
                                                        Row row = sheetData?.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                        if (row != null)
                                                        {
                                                            row.Remove();
                                                        }
                                                    }
                                                }
                                            }
                                        }

                                        char[] columns = { 'B' };
                                        int columnIndex = 0;

                                        if (barChart != null)
                                        {
                                            foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                                barChart?.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                            {
                                                if (columnIndex < columns.Length)
                                                {
                                                    char column = columns[columnIndex];

                                                    NumberReference numberReference =
                                                        barChartSeries?.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First()?.
                                                        Elements<NumberReference>().First();

                                                    if (numberReference != null)
                                                    {
                                                        numberReference.Formula =
                                                            new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                        NumberingCache numberingCache = numberReference?.Elements<NumberingCache>().First();
                                                        numberingCache.RemoveAllChildren();

                                                        int idx = 0;

                                                        foreach (var api in apiData)
                                                        {
                                                            long chartValue;

                                                            numberingCache.Append(new NumericPoint()
                                                            {
                                                                Index = (uint)idx,
                                                                NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.Average.ToString())
                                                            });
                                                            idx++;
                                                        }
                                                    }
                                                }

                                                StringReference stringReference = barChartSeries?.Elements<CategoryAxisData>()
                                                                                    .First()?.Elements<StringReference>().First();

                                                if (stringReference != null)
                                                {
                                                    stringReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.
                                                        Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                                    StringCache stringCache = stringReference?.Elements<StringCache>().First();
                                                    stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                                    int catIdx = 0;

                                                    foreach (var api in apiData)
                                                    {
                                                        stringCache.Append(new StringPoint()
                                                        {
                                                            Index = (uint)catIdx,
                                                            NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                        });

                                                        StringPoint stringPoint = stringCache?.Elements<StringPoint>().First();
                                                        catIdx++;
                                                    }
                                                }

                                                C.DataLabels dataLabels = barChartSeries?.GetFirstChild<C.DataLabels>();

                                                int i = 0;

                                                if (dataLabels != null)
                                                {
                                                    foreach (var dataPoint in apiData)
                                                    {
                                                        C.DataLabel dataLabel = new C.DataLabel();
                                                        C.Index index = new C.Index() { Val = (uint)i };

                                                        C.ChartText chartText = new C.ChartText();
                                                        C.RichText richText = new C.RichText();
                                                        A.BodyProperties bodyProperties = new A.BodyProperties();
                                                        A.ListStyle listStyle = new A.ListStyle();

                                                        A.Paragraph paragraph = new A.Paragraph();
                                                        A.Run run = new A.Run();
                                                        A.RunProperties runProperties = new A.RunProperties() { Language = "en-US" };

                                                        double percentageValue = Math.Round((double)dataPoint.Average, 2);

                                                        A.Text text = new A.Text();
                                                        text.Text = $"{percentageValue:0.00}";

                                                        run.Append(runProperties);
                                                        run.Append(text);
                                                        paragraph.Append(run);

                                                        richText.Append(bodyProperties);
                                                        richText.Append(listStyle);
                                                        richText.Append(paragraph);

                                                        chartText.Append(richText);

                                                        dataLabel.Append(index);
                                                        dataLabel.Append(chartText);

                                                        dataLabel.Append(new C.ShowLegendKey() { Val = false });
                                                        dataLabel.Append(new C.ShowValue() { Val = true });
                                                        dataLabel.Append(new C.ShowCategoryName() { Val = false });
                                                        dataLabel.Append(new C.ShowSeriesName() { Val = false });
                                                        dataLabel.Append(new C.ShowPercent() { Val = false });
                                                        dataLabel.Append(new C.ShowBubbleSize() { Val = false });

                                                        C.ExtensionList extList = new C.ExtensionList();

                                                        C.Extension ext1 = new C.Extension() { Uri = "{CE6537A1-D6FC-4f65-9D91-7224C49458BB}" };
                                                        extList.Append(ext1);

                                                        C.Extension ext2 = new C.Extension() { Uri = "{C3380CC4-5D6E-409C-BE32-E72D297353CC}" };
                                                        extList.Append(ext2);

                                                        dataLabel.Append(extList);

                                                        dataLabels.Append(dataLabel);

                                                        i++;
                                                    }
                                                }

                                                //C.ChartSpace chartSpace1 = chartPart.ChartSpace;

                                                //C.Chart chart1 = chartSpace1.GetFirstChild<C.Chart>();
                                                //C.PlotArea plotArea1 = chart1.GetFirstChild<C.PlotArea>();

                                                //C.BarChart barChart1 = plotArea1.GetFirstChild<C.BarChart>();
                                                //C.CategoryAxis categoryAxis1 = plotArea1.GetFirstChild<C.CategoryAxis>();

                                                //C.Delete delete1 = categoryAxis1.GetFirstChild<C.Delete>();
                                                //C.ChartShapeProperties chartShapeProperties1 = categoryAxis1.GetFirstChild<C.ChartShapeProperties>();
                                                //C.TextProperties textProperties1 = categoryAxis1.GetFirstChild<C.TextProperties>();
                                                //delete1.Val = true;

                                                //chartShapeProperties1.Remove();
                                                //textProperties1.Remove();
                                            }
                                        }
                                    }
                                }

                                Slide slide1 = slidePart?.Slide;

                                if (slide1 != null)
                                {
                                    CommonSlideData commonSlideData1 = slide1?.GetFirstChild<CommonSlideData>();

                                    if (commonSlideData1 != null)
                                    {
                                        ShapeTree shapeTree1 = commonSlideData1?.GetFirstChild<ShapeTree>();

                                        if (shapeTree1 != null)
                                        {
                                            var testNameShapes = shapeTree1?.Elements<P.Shape>()
                                                  .Where(shape => shape.InnerText.Contains("TESTNAME"))
                                                  .OrderBy(shape =>
                                                  {
                                                      var match = Regex.Match(shape.InnerText, @"TESTNAME(\d+)");
                                                      return match.Success ? int.Parse(match.Groups[1].Value) : int.MaxValue;
                                                  })
                                                  .ToList();

                                            if (testNameShapes != null && testNameShapes.Count > 0)
                                            {
                                                for (int i = 0; i < testNameShapes.Count && i < apiData.Count; i++)
                                                {
                                                    var shape = testNameShapes[i];
                                                    var apiItem = apiData[apiData.Count - i - 1];

                                                    if (shape != null)
                                                    {
                                                        P.TextBody textBody = shape?.GetFirstChild<P.TextBody>();
                                                        if (textBody != null)
                                                        {
                                                            A.Paragraph paragraph = textBody?.Elements<A.Paragraph>().FirstOrDefault();
                                                            if (paragraph != null)
                                                            {
                                                                A.Run run = paragraph?.Elements<A.Run>().FirstOrDefault();
                                                                if (run != null)
                                                                {
                                                                    A.RunProperties runProperties = run?.GetFirstChild<A.RunProperties>();
                                                                    if (runProperties != null)
                                                                    {
                                                                        runProperties.FontSize = DEFAULT_FONT_SIZE;

                                                                        if (apiData[apiData.Count - i - 1].TestNameBold == true)
                                                                        {
                                                                            runProperties.Bold = apiData[apiData.Count - i - 1].TestNameBold;
                                                                        }
                                                                        else
                                                                        {
                                                                            runProperties.Bold = false;
                                                                        }
                                                                    }

                                                                    A.SolidFill solidFill1 = runProperties?.GetFirstChild<A.SolidFill>();

                                                                    if (solidFill1 != null)
                                                                    {
                                                                        A.RgbColorModelHex rgbColor1 = solidFill1?.GetFirstChild<A.RgbColorModelHex>();
                                                                        if (rgbColor1 != null)
                                                                        {
                                                                            if (apiData[apiData.Count - i - 1].AverageColor != null)
                                                                            {
                                                                                rgbColor1.Val = apiData[apiData.Count - i - 1].AverageColor.TrimStart('#');
                                                                            }
                                                                            else
                                                                            {
                                                                                rgbColor1.Val = DEFAULT_COLOR;
                                                                            }
                                                                        }
                                                                    }

                                                                    A.Text text = run?.GetFirstChild<A.Text>();
                                                                    if (text != null)
                                                                    {
                                                                        if (apiData[apiData.Count - i - 1].TestName != null)
                                                                        {
                                                                            text.Text = apiData[apiData.Count - i - 1].TestName.ToString();
                                                                        }
                                                                        else
                                                                        {
                                                                            text.Text = "";
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                                slide1.Save();
                            }
                            chartPart.ChartSpace.Save();
                        }
                        slidePart.Slide.Save();
                    }
                    presentationDocument.Save();
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }


        // WRITTEN UNDERSTANDING BAR TEMPLATE
        public void WrittenUnderstandingBarTemplateForAll(string destination, List<WrittenUnderstanding> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    SlidePart slidePart = presentationDocument?.PresentationPart?.SlideParts.First();
                    if (slidePart != null)
                    {
                        ChartPart chartPart = slidePart?.ChartParts?.First();
                        if (chartPart != null)
                        {
                            EmbeddedPackagePart embeddedPackagePart = chartPart?.EmbeddedPackagePart;
                            BarChart barChart = chartPart?.ChartSpace?.Descendants<BarChart>().First();

                            if (embeddedPackagePart != null)
                            {
                                using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                {
                                    WorksheetPart worksheetPart = spreadsheet?.WorkbookPart?.WorksheetParts.First();

                                    if (worksheetPart != null)
                                    {
                                        SheetData sheetData = worksheetPart?.Worksheet?.Elements<SheetData>().FirstOrDefault();

                                        int excelDataIndex = 2;
                                        Cell cellVariableObj;

                                        apiData.Sort((x, y) => (x.Average ?? 0).CompareTo(y.Average ?? 0));

                                        if (sheetData != null)
                                        {
                                            foreach (var apiVariables in apiData)
                                            {
                                                cellVariableObj =
                                                    sheetData.Descendants<Cell>()
                                                    .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                if (cellVariableObj != null)
                                                {
                                                    cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                    cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                }

                                                cellVariableObj =
                                                    sheetData.Descendants<Cell>()
                                                    .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                if (cellVariableObj != null)
                                                {
                                                    cellVariableObj.CellValue = new CellValue(apiVariables.Average.ToString());
                                                    cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                }
                                                excelDataIndex++;
                                            }

                                            for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                            {
                                                Row row = sheetData?.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                if (row != null)
                                                {
                                                    row.Remove();
                                                }
                                            }
                                        }
                                    }

                                    char[] columns = { 'B' };
                                    int columnIndex = 0;

                                    if (barChart != null)
                                    {
                                        foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                       barChart.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                        {
                                            if (columnIndex < columns.Length)
                                            {
                                                char column = columns[columnIndex];

                                                NumberReference numberReference =
                                                    barChartSeries?.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First()?.
                                                    Elements<NumberReference>().First();

                                                numberReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                NumberingCache numberingCache = numberReference?.Elements<NumberingCache>().First();
                                                numberingCache.RemoveAllChildren();

                                                int idx = 0;

                                                foreach (var api in apiData)
                                                {
                                                    long chartValue;

                                                    numberingCache.Append(new NumericPoint()
                                                    {
                                                        Index = (uint)idx,
                                                        NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.Average.ToString())
                                                    });
                                                    idx++;
                                                }
                                            }

                                            StringReference stringReference = barChartSeries?.Elements<CategoryAxisData>()
                                                                                .First()?.Elements<StringReference>().First();

                                            stringReference.Formula =
                                                new DocumentFormat.OpenXml.Drawing.
                                                    Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                            StringCache stringCache = stringReference?.Elements<StringCache>().First();

                                            stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                            int catIdx = 0;

                                            foreach (var api in apiData)
                                            {
                                                stringCache.Append(new StringPoint()
                                                {
                                                    Index = (uint)catIdx,
                                                    NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                });

                                                StringPoint stringPoint = stringCache.Elements<StringPoint>().First();
                                                catIdx++;
                                            }

                                            C.DataLabels dataLabels = barChartSeries?.GetFirstChild<C.DataLabels>();

                                            int i = 0;

                                            if (dataLabels != null)
                                            {
                                                foreach (var dataPoint in apiData)
                                                {
                                                    C.DataLabel dataLabel = new C.DataLabel();
                                                    C.Index index = new C.Index() { Val = (uint)i };

                                                    C.ChartText chartText = new C.ChartText();
                                                    C.RichText richText = new C.RichText();
                                                    A.BodyProperties bodyProperties = new A.BodyProperties();
                                                    A.ListStyle listStyle = new A.ListStyle();

                                                    A.Paragraph paragraph = new A.Paragraph();
                                                    A.Run run = new A.Run();
                                                    A.RunProperties runProperties = new A.RunProperties() { Language = "en-US" };

                                                    double percentageValue = Math.Round((double)dataPoint.Average, 2);

                                                    A.Text text = new A.Text();
                                                    text.Text = $"{percentageValue:0.00}";

                                                    run.Append(runProperties);
                                                    run.Append(text);
                                                    paragraph.Append(run);

                                                    richText.Append(bodyProperties);
                                                    richText.Append(listStyle);
                                                    richText.Append(paragraph);

                                                    chartText.Append(richText);

                                                    dataLabel.Append(index);
                                                    dataLabel.Append(chartText);

                                                    dataLabel.Append(new C.ShowLegendKey() { Val = false });
                                                    dataLabel.Append(new C.ShowValue() { Val = true });
                                                    dataLabel.Append(new C.ShowCategoryName() { Val = false });
                                                    dataLabel.Append(new C.ShowSeriesName() { Val = false });
                                                    dataLabel.Append(new C.ShowPercent() { Val = false });
                                                    dataLabel.Append(new C.ShowBubbleSize() { Val = false });

                                                    C.ExtensionList extList = new C.ExtensionList();

                                                    C.Extension ext1 = new C.Extension() { Uri = "{CE6537A1-D6FC-4f65-9D91-7224C49458BB}" };
                                                    extList.Append(ext1);

                                                    C.Extension ext2 = new C.Extension() { Uri = "{C3380CC4-5D6E-409C-BE32-E72D297353CC}" };
                                                    extList.Append(ext2);

                                                    dataLabel.Append(extList);

                                                    dataLabels.Append(dataLabel);

                                                    i++;
                                                }
                                            }

                                            //C.ChartSpace chartSpace1 = chartPart.ChartSpace;

                                            //C.Chart chart1 = chartSpace1.GetFirstChild<C.Chart>();
                                            //C.PlotArea plotArea1 = chart1.GetFirstChild<C.PlotArea>();

                                            //C.BarChart barChart1 = plotArea1.GetFirstChild<C.BarChart>();
                                            //C.CategoryAxis categoryAxis1 = plotArea1.GetFirstChild<C.CategoryAxis>();

                                            //C.Delete delete1 = categoryAxis1.GetFirstChild<C.Delete>();
                                            //C.ChartShapeProperties chartShapeProperties1 = categoryAxis1.GetFirstChild<C.ChartShapeProperties>();
                                            //C.TextProperties textProperties1 = categoryAxis1.GetFirstChild<C.TextProperties>();
                                            //delete1.Val = true;

                                            //chartShapeProperties1.Remove();
                                            //textProperties1.Remove();
                                        }
                                    }
                                }
                            }

                            Slide slide1 = slidePart?.Slide;
                            if (slide1 != null)
                            {
                                CommonSlideData commonSlideData1 = slide1?.GetFirstChild<CommonSlideData>();
                                if (commonSlideData1 != null)
                                {
                                    ShapeTree shapeTree1 = commonSlideData1?.GetFirstChild<ShapeTree>();
                                    if (shapeTree1 != null)
                                    {
                                        var testNameShapes = shapeTree1?.Elements<P.Shape>()
                                                           .Where(shape => shape.InnerText.Contains("TESTNAME"))
                                                           .OrderBy(shape =>
                                                           {
                                                               var match = Regex.Match(shape.InnerText, @"TESTNAME(\d+)");
                                                               return match.Success ? int.Parse(match.Groups[1].Value) : int.MaxValue;
                                                           })
                                                           .ToList();

                                        if (testNameShapes.Count > 0)
                                        {
                                            for (int i = 0; i < testNameShapes.Count && i < apiData.Count; i++)
                                            {
                                                var shape = testNameShapes[i];
                                                var apiItem = apiData[apiData.Count - i - 1];

                                                P.TextBody textBody = shape?.GetFirstChild<P.TextBody>();
                                                if (textBody != null)
                                                {
                                                    A.Paragraph paragraph = textBody?.Elements<A.Paragraph>().FirstOrDefault();
                                                    if (paragraph != null)
                                                    {
                                                        A.Run run = paragraph?.Elements<A.Run>().FirstOrDefault();
                                                        if (run != null)
                                                        {
                                                            A.RunProperties runProperties = run?.GetFirstChild<A.RunProperties>();
                                                            if (runProperties != null)
                                                            {
                                                                runProperties.FontSize = DEFAULT_FONT_SIZE;
                                                                //runProperties.Bold = apiItem.TestNameBold;
                                                                if (apiData[apiData.Count - i - 1].TestNameBold == true)
                                                                {
                                                                    runProperties.Bold = apiData[apiData.Count - i - 1].TestNameBold;
                                                                }
                                                                else
                                                                {
                                                                    runProperties.Bold = false;
                                                                }
                                                            }

                                                            A.SolidFill solidFill1 = runProperties?.GetFirstChild<A.SolidFill>();

                                                            if (solidFill1 != null)
                                                            {
                                                                A.RgbColorModelHex rgbColor1 = solidFill1?.GetFirstChild<A.RgbColorModelHex>();
                                                                if (rgbColor1 != null)
                                                                {
                                                                    rgbColor1.Val = apiItem?.AverageColor.TrimStart('#');
                                                                }
                                                                else
                                                                {
                                                                    rgbColor1.Val = DEFAULT_COLOR;
                                                                }

                                                                A.Text text = run?.GetFirstChild<A.Text>();
                                                                if (text != null)
                                                                {
                                                                    if (apiData[apiData.Count - i - 1].TestName != null)
                                                                    {
                                                                        text.Text = apiData[apiData.Count - i - 1].TestName.ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        text.Text = "";
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                                slide1.Save();
                            }
                            chartPart.ChartSpace.Save();
                        }
                        slidePart.Slide.Save();
                    }
                    presentationDocument.Save();
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }


        // EXAGGERATIVE TEMPLATE
        public void ExaggerativeTemplateForAll(string destination, List<Likeability> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    SlidePart slidePart = presentationDocument?.PresentationPart?.SlideParts.First();
                    if (slidePart != null)
                    {
                        Slide slide1 = slidePart.Slide;
                        if (slide1 != null)
                        {
                            CommonSlideData commonSlideData1 = slide1?.GetFirstChild<CommonSlideData>();
                            if (commonSlideData1 != null)
                            {
                                ShapeTree shapeTree1 = commonSlideData1?.GetFirstChild<ShapeTree>();
                                if (shapeTree1 != null)
                                {
                                    var shapeExagg = shapeTree1?.Elements<P.Shape>().ToList();

                                    if (shapeExagg != null && shapeExagg.Count >= 2)
                                    {
                                        var shape1 = shapeExagg?.ElementAt<P.Shape>(1);

                                        if (shape1 != null)
                                        {
                                            var textBody = shape1?.GetFirstChild<P.TextBody>();
                                            if (textBody != null)
                                            {
                                                var paragraph = textBody?.GetFirstChild<A.Paragraph>();
                                                foreach (var run in paragraph.Elements<A.Run>())
                                                {
                                                    if (run != null)
                                                    {
                                                        var text = run?.GetFirstChild<A.Text>();
                                                        if (text.InnerText.Contains("<<"))
                                                        {
                                                            text.Text = "";
                                                        }
                                                        else if (text.InnerText.Contains("ExaggerativeTitle"))
                                                        {
                                                            text.Text = "Is the test name untrue?";   
                                                        }
                                                        else if (text.InnerText.Contains(">>"))
                                                        {
                                                            text.Text = "";
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    var testNameShapes = shapeTree1?.Elements<P.Shape>()
                                        .Where(shape => shape.InnerText.Contains("TESTNAME"))
                                        .OrderBy(shape =>
                                        {
                                            var match = Regex.Match(shape.InnerText, @"TESTNAME(\d+)");
                                            return match.Success ? int.Parse(match.Groups[1].Value) : int.MaxValue;
                                        })
                                        .ToList();

                                    if (testNameShapes != null && testNameShapes.Count > 0)
                                    {
                                        for (int i = 0; i < testNameShapes.Count && i < apiData.Count; i++)
                                        {
                                            var shape = testNameShapes[i];
                                            var apiItem = apiData[apiData.Count - i - 1];

                                            P.TextBody textBody = shape?.GetFirstChild<P.TextBody>();
                                            if (textBody != null)
                                            {
                                                A.Paragraph paragraph = textBody?.Elements<A.Paragraph>().FirstOrDefault();
                                                if (paragraph != null)
                                                {
                                                    A.Run run = paragraph?.Elements<A.Run>().FirstOrDefault();
                                                    if (run != null)
                                                    {
                                                        A.RunProperties runProperties = run?.GetFirstChild<A.RunProperties>();
                                                        if (runProperties != null)
                                                        {
                                                            runProperties.FontSize = DEFAULT_FONT_SIZE;
                                                            if (apiData[apiData.Count - i - 1].TestNameBold == true)
                                                            {
                                                                //runProperties.Bold = apiData[apiData.Count - i - 1].TestNameBold;
                                                                runProperties.Bold = apiData[i].TestNameBold;
                                                            }
                                                            else
                                                            {
                                                                runProperties.Bold = false;
                                                            }
                                                        }

                                                        A.SolidFill solidFill1 = runProperties?.GetFirstChild<A.SolidFill>();
                                                        if (solidFill1 != null)
                                                        {
                                                            A.RgbColorModelHex rgbColor1 = solidFill1?.GetFirstChild<A.RgbColorModelHex>();
                                                            if (rgbColor1 != null)
                                                            {
                                                                if (apiData[apiData.Count - i - 1].TestNameColor != null)
                                                                {
                                                                    //rgbColor1.Val = apiData[apiData.Count - i - 1].TestNameColor.TrimStart('#');
                                                                    rgbColor1.Val = apiData[i].TestNameColor.TrimStart('#');
                                                                }
                                                                else
                                                                {
                                                                    rgbColor1.Val = DEFAULT_COLOR;
                                                                }
                                                            }
                                                        }

                                                        A.Text text = run?.GetFirstChild<A.Text>();
                                                        if (text != null)
                                                        {
                                                            if (apiData[apiData.Count - i - 1].TestName != null)
                                                            {
                                                                //text.Text = apiData[apiData.Count - i - 1].TestName.ToString();
                                                                text.Text = apiData[i].TestName.ToString();
                                                            }
                                                            else
                                                            {
                                                                text.Text = "";
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            slide1.Save();
                        }

                        ChartPart chartPart = slidePart?.ChartParts?.First();
                        if (chartPart != null)
                        {
                            EmbeddedPackagePart embeddedPackagePart = chartPart?.EmbeddedPackagePart;
                            BarChart barChart = chartPart?.ChartSpace?.Descendants<BarChart>().First();
                            if (embeddedPackagePart != null)
                            {
                                using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(embeddedPackagePart.GetStream(), true))
                                {
                                    WorksheetPart worksheetPart = spreadsheet?.WorkbookPart?.WorksheetParts.First();
                                    if (worksheetPart != null)
                                    {
                                        SheetData sheetData = worksheetPart?.Worksheet?.Elements<SheetData>().FirstOrDefault();

                                        int excelDataIndex = 2;
                                        Cell cellVariableObj;

                                        apiData.Sort((x, y) => (x.Negative ?? 0).CompareTo(y.Negative ?? 0));

                                        if (sheetData != null)
                                        {
                                            foreach (var apiVariables in apiData)
                                            {
                                                cellVariableObj =
                                                    sheetData.Descendants<Cell>()
                                                    .FirstOrDefault(c => c.CellReference == "A" + excelDataIndex.ToString());

                                                if (cellVariableObj != null)
                                                {
                                                    cellVariableObj.CellValue = new CellValue(apiVariables.TestName);
                                                    cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.String);
                                                }

                                                cellVariableObj =
                                                    sheetData.Descendants<Cell>()
                                                    .FirstOrDefault(c => c.CellReference == "B" + excelDataIndex.ToString());

                                                if (cellVariableObj != null)
                                                {
                                                    cellVariableObj.CellValue = new CellValue(apiVariables.Negative.ToString());
                                                    cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                }

                                                cellVariableObj =
                                                    sheetData.Descendants<Cell>()
                                                        .FirstOrDefault(c => c.CellReference == "C" + excelDataIndex.ToString());

                                                if (cellVariableObj != null)
                                                {
                                                    cellVariableObj.CellValue = new CellValue(apiVariables.Positive.ToString());
                                                    cellVariableObj.DataType = new EnumValue<CellValues>(CellValues.Number);
                                                }
                                                excelDataIndex++;
                                            }

                                            for (int rowIndex = apiData.Count + 2; rowIndex <= 31; rowIndex++)
                                            {
                                                Row row = sheetData?.Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);
                                                if (row != null)
                                                {
                                                    row.Remove();
                                                }
                                            }
                                        }
                                    }

                                    char[] columns = { 'B', 'C' };
                                    int columnIndex = 0;

                                    if (barChart != null)
                                    {
                                        foreach (DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries barChartSeries in
                                       barChart?.Elements<DocumentFormat.OpenXml.Drawing.Charts.BarChartSeries>())
                                        {
                                            if (columnIndex < columns.Length)
                                            {
                                                char column = columns[columnIndex];

                                                NumberReference numberReference =
                                                    barChartSeries?.Elements<DocumentFormat.OpenXml.Drawing.Charts.Values>().First()?.
                                                    Elements<NumberReference>().First();

                                                numberReference.Formula =
                                                    new DocumentFormat.OpenXml.Drawing.Charts.Formula(formulaChanges(column, apiData.Count() + 1));

                                                NumberingCache numberingCache = numberReference?.Elements<NumberingCache>().First();
                                                numberingCache.RemoveAllChildren();
                                                numberingCache.Append(new C.FormatCode("0.0"));

                                                int idx = 0;

                                                uint dataLabelIndex = 0;

                                                foreach (var api in apiData)
                                                {
                                                    var x = api.Positive;
                                                    if (x > 0)
                                                    {
                                                        dataLabelIndex++;
                                                    }
                                                    else
                                                    {
                                                        break;
                                                    }
                                                }

                                                foreach (var api in apiData)
                                                {
                                                    double chartValue;

                                                    switch (column)
                                                    {
                                                        case 'B':
                                                            chartValue = (double)api.Negative;
                                                            break;

                                                        case 'C':
                                                            chartValue = (double)api.Positive;
                                                            break;

                                                        default:
                                                            chartValue = 0;
                                                            break;
                                                    }

                                                    numberingCache.Append(new NumericPoint()
                                                    {
                                                        Index = (uint)idx,
                                                        NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue((Math.Round(chartValue * 10) / 10).ToString("F2"))
                                                    });
                                                    idx++;

                                                    if (chartValue == 0)
                                                    {
                                                        C.Chart chart1 = chartPart.ChartSpace.GetFirstChild<C.Chart>();
                                                        C.PlotArea plotArea1 = chart1.GetFirstChild<C.PlotArea>();
                                                        C.BarChart barChart1 = plotArea1.GetFirstChild<C.BarChart>();
                                                        C.BarChartSeries barChartSeries1 = barChart1.Elements<C.BarChartSeries>().ElementAt(1);

                                                        C.DataLabels dataLabels1 = barChartSeries1.GetFirstChild<C.DataLabels>();

                                                        C.ChartShapeProperties chartShapeProperties1 = dataLabels1.GetFirstChild<C.ChartShapeProperties>();
                                                        C.TextProperties textProperties1 = dataLabels1.GetFirstChild<C.TextProperties>();
                                                        C.ShowLegendKey showLegendKey1 = dataLabels1.GetFirstChild<C.ShowLegendKey>();

                                                        C.DataLabel dataLabel1 = new C.DataLabel();
                                                        C.Index index1 = new C.Index() { Val = (UInt32Value)dataLabelIndex };
                                                        C.Delete delete1 = new C.Delete() { Val = true };

                                                        C.DLblExtensionList dLblExtensionList1 = new C.DLblExtensionList();

                                                        C.DLblExtension dLblExtension1 = new C.DLblExtension() { Uri = "{CE6537A1-D6FC-4f65-9D91-7224C49458BB}" };
                                                        dLblExtension1.AddNamespaceDeclaration("c15", "http://schemas.microsoft.com/office/drawing/2012/chart");

                                                        C.DLblExtension dLblExtension2 = new C.DLblExtension() { Uri = "{C3380CC4-5D6E-409C-BE32-E72D297353CC}" };
                                                        dLblExtension2.AddNamespaceDeclaration("c16", "http://schemas.microsoft.com/office/drawing/2014/chart");

                                                        dLblExtensionList1.Append(dLblExtension1);
                                                        dLblExtensionList1.Append(dLblExtension2);

                                                        dataLabel1.Append(index1);
                                                        dataLabel1.Append(delete1);
                                                        dataLabel1.Append(dLblExtensionList1);
                                                        dataLabels1.InsertBefore(dataLabel1, chartShapeProperties1);

                                                        dataLabelIndex++;
                                                    }

                                                }

                                                //if (column == 'C')
                                                //{
                                                //    C.DataLabels dataLabels1 = barChartSeries?.GetFirstChild<C.DataLabels>();
                                                //    C.DataLabelPosition dataLabelPosition1 = dataLabels1?.GetFirstChild<C.DataLabelPosition>();
                                                //    //dataLabelPosition1.Val = C.DataLabelPositionValues.InsideEnd;

                                                //    C.TextProperties textProperties1 = dataLabels1?.GetFirstChild<C.TextProperties>();
                                                //    A.Paragraph paragraph1 = textProperties1?.GetFirstChild<A.Paragraph>();
                                                //    A.ParagraphProperties paragraphProperties1 = paragraph1?.GetFirstChild<A.ParagraphProperties>();
                                                //    A.DefaultRunProperties defaultRunProperties1 = paragraphProperties1?.GetFirstChild<A.DefaultRunProperties>();
                                                //    A.SolidFill solidFill1 = defaultRunProperties1?.GetFirstChild<A.SolidFill>();
                                                //    A.SchemeColor schemeColor1 = solidFill1?.GetFirstChild<A.SchemeColor>();
                                                //    schemeColor1.Val = A.SchemeColorValues.Background1;
                                                //}

                                                columnIndex++;
                                            }

                                            StringReference stringReference = barChartSeries?.Elements<CategoryAxisData>()
                                                                                .First().Elements<StringReference>().First();

                                            stringReference.Formula =
                                                new DocumentFormat.OpenXml.Drawing.
                                                    Charts.Formula("Sheet1!$A$2:$A$" + (apiData.Count + 1).ToString());

                                            StringCache stringCache = stringReference?.Elements<StringCache>().First();

                                            stringCache.GetFirstChild<PointCount>().Val = (uint)apiData.Count;

                                            int catIdx = 0;

                                            foreach (var api in apiData)
                                            {
                                                stringCache.Append(new StringPoint()
                                                {
                                                    Index = (uint)catIdx,
                                                    NumericValue = new DocumentFormat.OpenXml.Drawing.Charts.NumericValue(api.TestName)
                                                });

                                                StringPoint stringPoint = stringCache?.Elements<StringPoint>().First();
                                                catIdx++;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        chartPart.ChartSpace.Save();
                        slidePart.Slide.Save();
                    }

                    presentationDocument.Save();

                    var slideIdList = presentationDocument?.PresentationPart?.Presentation.SlideIdList;
                    if (slideIdList != null)
                    {
                        var slideIds = slideIdList?.ChildElements.OfType<SlideId>().ToList();

                        if (slideIds != null)
                        {
                            var slidesToRemove = slideIds.Take(2).ToList();
                            foreach (var slideId in slidesToRemove)
                            {
                                slideIdList.RemoveChild(slideId);

                                var slidePart1 = (SlidePart)presentationDocument.PresentationPart.GetPartById(slideId.RelationshipId);
                                presentationDocument.PresentationPart.DeletePart(slidePart1);
                            }
                        }
                    }
                    presentationDocument.PresentationPart.Presentation.Save();
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }


        // SALA TEMPLATE
        public void SALANewModelTemplateSpecial2(string destination, List<Sala> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    if (presentationDocument != null)
                    {
                        // Get SlideIdList
                        var slideIdList = presentationDocument?.PresentationPart?.Presentation?.SlideIdList;
                        var sortOrder = new List<string> { "Primary", "Secondary", "Tertiary" };

                        var groupApiData = apiData.OrderBy(obj => sortOrder.IndexOf(obj.strDSIScore)).ToList();

                        // Count categories
                        int primaryCount = groupApiData.Count(api => api.strDSIScore == "Primary");

                        // Process each slide
                        int currentSlideIndexForPrimary = 0;
                        int currentApiIndexForPrimary = 0;
                        int currentSlideIndex = 0;
                        int remainingPrimaryData = 0;

                        if (primaryCount > 0)
                        {
                            while (currentApiIndexForPrimary < primaryCount)
                            {
                                // Get the current slide
                                SlideId slideId = slideIdList?.ChildElements[currentSlideIndexForPrimary] as SlideId;
                                SlidePart slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                Slide slide = slidePart?.Slide;

                                ShapeTree shapeTree = slide.CommonSlideData.GetFirstChild<ShapeTree>();

                                // Step 1: Calculate smallest and highest TESTNAME values only for the current slide
                                int smallestNoInteger = int.MaxValue;
                                int highestNoInteger = int.MinValue;
                                int highestUpperRowFrame = -1; // Keep track of the highest frame in the upper row (e.g., testname03, testname11, etc.)
                                int lowestLowerRowFrame = int.MaxValue; // Keep track of the lowest frame in the lower row (e.g., testname04, testname12, etc.)

                                var graphicFrames = shapeTree.Elements<P.GraphicFrame>()
                                                             .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                             .ToList();

                                if (graphicFrames != null && graphicFrames.Count > 0)
                                {
                                    foreach (var graphicFrame in graphicFrames)
                                    {
                                        var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                        if (text != null && text.StartsWith("TESTNAME"))
                                        {
                                            var numberPart = text.Replace("TESTNAME", "");
                                            if (int.TryParse(numberPart, out int frameNumber))
                                            {
                                                smallestNoInteger = Math.Min(smallestNoInteger, frameNumber);
                                                highestNoInteger = Math.Max(highestNoInteger, frameNumber);

                                                // Track highest frame in the upper row (e.g., testname03, testname11, etc.)
                                                if (frameNumber >= smallestNoInteger && frameNumber <= highestNoInteger) // Upper row (00-03)
                                                {
                                                    highestUpperRowFrame = Math.Max(highestUpperRowFrame, frameNumber);
                                                }
                                                else if (frameNumber >= smallestNoInteger && frameNumber <= highestNoInteger) // Lower row (04-07)
                                                {
                                                    lowestLowerRowFrame = Math.Min(lowestLowerRowFrame, frameNumber);
                                                }
                                            }
                                        }
                                    }
                                }

                                var sortedGraphicListPrimary = graphicFrames?.OrderBy(x => x.InnerText).ToList();

                                if (currentSlideIndex == currentSlideIndexForPrimary)
                                {
                                    foreach (var graphicFrame in sortedGraphicListPrimary)
                                    {
                                        var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                        if (text != null && text.StartsWith("TESTNAME"))
                                        {
                                            // Extract the numeric part from "TESTNAME"
                                            string numberPart = text.Replace("TESTNAME", "");
                                            if (int.TryParse(numberPart, out int index))
                                            {
                                                // more than 8 count
                                                if (primaryCount > 8)
                                                {
                                                    if (index >= smallestNoInteger && index <= highestNoInteger)
                                                    {
                                                        // Secondary items should stay within bounds
                                                        if (currentApiIndexForPrimary < primaryCount)
                                                        {
                                                            currentApiIndexForPrimary++;
                                                        }
                                                        else
                                                        {
                                                            //graphicFrame.Remove(); // Remove excess frames
                                                        }
                                                    }
                                                }
                                                // equal 8 count
                                                else if (primaryCount == 8)
                                                {
                                                    if (index >= 0 && index < 8)
                                                    {
                                                        // Secondary items should stay within bounds
                                                        if (currentApiIndexForPrimary < primaryCount)
                                                        {
                                                            currentApiIndexForPrimary++;
                                                        }
                                                    }
                                                }
                                                // between 4 and 8 count
                                                else if (primaryCount > 4 && primaryCount < 8)
                                                {
                                                    int topRowItems = 4; // Always use all 4 frames in the top row
                                                    int bottomRowItems = primaryCount - topRowItems; // Remaining items in the bottom row

                                                    if (index >= 0 && index <= highestNoInteger)
                                                    {
                                                        if (currentApiIndexForPrimary < primaryCount)
                                                        {
                                                            currentApiIndexForPrimary++;
                                                        }
                                                        else
                                                        {
                                                            graphicFrame.Remove();
                                                        }
                                                    }

                                                    //if (index < 4 && index >= topRowItems) // Unused frames in the top row
                                                    //{
                                                    //    graphicFrame.Remove();
                                                    //}
                                                    //else if (index >= 4 && index < 8 && index >= (4 + bottomRowItems)) // Unused frames in the bottom row
                                                    //{
                                                    //    graphicFrame.Remove();
                                                    //}
                                                }

                                                // equal 4 count
                                                else if (primaryCount == 4)
                                                {
                                                    if (index >= 0 && index < 4)
                                                    {
                                                        // Secondary items should stay within bounds
                                                        if (currentApiIndexForPrimary < primaryCount)
                                                        {
                                                            currentApiIndexForPrimary++;
                                                        }
                                                    }
                                                }

                                                // under 4 count
                                                else if (primaryCount < 4)
                                                {
                                                    if (index < primaryCount)
                                                    {
                                                        if (currentApiIndexForPrimary < primaryCount)
                                                        {
                                                            currentApiIndexForPrimary++;
                                                        }
                                                    }
                                                    else if (index < 4 && index >= primaryCount) // Unused frames in the top row
                                                    {
                                                        graphicFrame.Remove();

                                                    }
                                                }
                                            }
                                        }
                                    }

                                    if (currentApiIndexForPrimary < primaryCount)
                                    {
                                        currentSlideIndexForPrimary++;
                                    }
                                }

                                else
                                {
                                    remainingPrimaryData = primaryCount - currentApiIndexForPrimary;

                                    int smallestNoInteger2 = int.MaxValue;
                                    int highestNoInteger2 = int.MinValue;
                                    int highestUpperRowFrame2 = -1;
                                    int lowestLowerRowFrame2 = int.MaxValue;

                                    if (graphicFrames != null && graphicFrames.Count > 0)
                                    {
                                        foreach (var graphicFrame in graphicFrames)
                                        {
                                            var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                            if (text != null && text.StartsWith("TESTNAME"))
                                            {
                                                var numberPart = text.Replace("TESTNAME", "");
                                                if (int.TryParse(numberPart, out int frameNumber))
                                                {
                                                    smallestNoInteger2 = Math.Min(smallestNoInteger2, frameNumber);
                                                    highestNoInteger2 = Math.Max(highestNoInteger2, frameNumber);

                                                    // Track highest frame in the upper row (e.g., testname03, testname11, etc.)
                                                    if (frameNumber >= smallestNoInteger2 && frameNumber <= highestNoInteger2) // Upper row (00-03)
                                                    {
                                                        highestUpperRowFrame2 = Math.Max(highestUpperRowFrame2, frameNumber);
                                                    }
                                                    else if (frameNumber >= smallestNoInteger2 && frameNumber <= highestNoInteger2) // Lower row (04-07)
                                                    {
                                                        lowestLowerRowFrame2 = Math.Min(lowestLowerRowFrame2, frameNumber);
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    slideId = slideIdList?.ChildElements[currentSlideIndexForPrimary] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;

                                    shapeTree = slide?.CommonSlideData.GetFirstChild<ShapeTree>();

                                    var graphicFrames3 = shapeTree?.Elements<P.GraphicFrame>()
                                       .Where(frame => frame.Descendants<A.Text>().FirstOrDefault()?.Text.StartsWith("TESTNAME") == true)
                                       .Reverse()
                                        .ToList();

                                    graphicFrames3 = graphicFrames3.OrderBy(x => x.InnerText).ToList();

                                    foreach (var graphicFrame in graphicFrames3)
                                    {
                                        var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                        if (text != null && text.StartsWith("TESTNAME"))
                                        {
                                            string numberPart = text.Replace("TESTNAME", "");
                                            if (int.TryParse(numberPart, out int index))
                                            {
                                                if (currentApiIndexForPrimary < primaryCount)
                                                {
                                                    currentApiIndexForPrimary++;
                                                }
                                                else
                                                {
                                                    if (remainingPrimaryData > 4)
                                                    {
                                                        int topRowItems = 4;
                                                        int bottomRowItems = remainingPrimaryData - topRowItems;

                                                        if (index <= highestNoInteger2 && index >= smallestNoInteger2)
                                                        {
                                                            graphicFrame.Remove();
                                                        }
                                                        else if (index >= smallestNoInteger2
                                                                        && index <= highestNoInteger2
                                                                        && index >= (4 + bottomRowItems))
                                                        {
                                                            graphicFrame.Remove();
                                                        }
                                                    }
                                                    else if (remainingPrimaryData < 4)
                                                    {
                                                        if (index < (smallestNoInteger2 + 4))
                                                        {
                                                            graphicFrame.Remove(); // Remove excess frames
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    if (currentApiIndexForPrimary < primaryCount)
                                    {
                                        currentSlideIndexForPrimary++;

                                        slideId = slideIdList?.ChildElements[currentSlideIndexForPrimary] as SlideId;
                                        slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                        slide = slidePart?.Slide;

                                        shapeTree = slide?.CommonSlideData.GetFirstChild<ShapeTree>();
                                    }
                                }

                                slidePart.Slide.Save();
                            }

                            if (currentSlideIndexForPrimary == 0)
                            {
                                SlideId slideId4 = slideIdList?.ChildElements[currentSlideIndexForPrimary] as SlideId;
                                SlidePart slidePart4 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId4.RelationshipId);
                                Slide slide4 = slidePart4?.Slide;

                                ShapeTree shapeTree4 = slide4.CommonSlideData.GetFirstChild<ShapeTree>();

                                var graphicFrames4 = shapeTree4.Elements<P.GraphicFrame>()
                                                                 .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                                 .ToList();

                                var sortedGraphicList = graphicFrames4.OrderBy(x => x.InnerText).ToList();

                                // for under 4 names
                                if (primaryCount < 4)
                                {
                                    var primaryGraphicList = sortedGraphicList.Take(primaryCount).ToList();

                                    if (primaryGraphicList.Count == 1)
                                    {
                                        var graphic1 = primaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                            if (transform1 != null)
                                            {
                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                if (offset1 != null)
                                                {
                                                    offset1.X = 4827536;
                                                    offset1.Y = 872561;
                                                }
                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                if (extents1 != null)
                                                {
                                                    extents1.Cx = 2536928;
                                                    extents1.Cy = 979170;
                                                }
                                            }
                                        }
                                    }

                                    else if (primaryGraphicList.Count == 2)
                                    {
                                        var graphic1 = primaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                            if (transform1 != null)
                                            {
                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                if (offset1 != null)
                                                {
                                                    offset1.X = 2372715;
                                                    offset1.Y = 872561;
                                                }
                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                if (extents1 != null)
                                                {
                                                    extents1.Cx = 2536928;
                                                    extents1.Cy = 788670;
                                                }
                                            }
                                        }

                                        var graphic2 = primaryGraphicList[1];
                                        if (graphic2 != null)
                                        {
                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 7282358;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 971550;
                                                }
                                            }
                                        }
                                    }

                                    else if (primaryGraphicList.Count == 3)
                                    {
                                        var graphic1 = primaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 1145304;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 1169670;
                                                }
                                            }
                                        }

                                        var graphic2 = primaryGraphicList[1];
                                        if (graphic2 != null)
                                        {
                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 4827536;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 979170;
                                                }
                                            }
                                        }

                                        var graphic3 = primaryGraphicList[2];
                                        if (graphic3 != null)
                                        {
                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 8509768;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 979170;
                                                }
                                            }
                                        }

                                    }
                                }

                                // for 4 names
                                else if (primaryCount == 4)
                                {
                                    // do nothing
                                }

                                // for under 8 names but more than 4
                                else if (primaryCount > 4 && primaryCount < 8)
                                {
                                    var higherPrimaryGraphicList = sortedGraphicList.Skip(4).ToList();

                                    if (higherPrimaryGraphicList.Count == 1)
                                    {
                                        var graphic1 = higherPrimaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                            if (transform1 != null)
                                            {
                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                if (offset1 != null)
                                                {
                                                    offset1.X = 4827536;
                                                    offset1.Y = 3596711;
                                                }
                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                if (extents1 != null)
                                                {
                                                    extents1.Cx = 2536928;
                                                    extents1.Cy = 788670;
                                                }
                                            }
                                        }
                                    }

                                    else if (higherPrimaryGraphicList.Count == 2)
                                    {
                                        var graphic1 = higherPrimaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                            if (transform1 != null)
                                            {
                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                if (offset1 != null)
                                                {
                                                    offset1.X = 2372715;
                                                    offset1.Y = 3596711;
                                                }
                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                if (extents1 != null)
                                                {
                                                    extents1.Cx = 2536928;
                                                    extents1.Cy = 971550;
                                                }
                                            }
                                        }

                                        var graphic2 = higherPrimaryGraphicList[1];
                                        if (graphic2 != null)
                                        {
                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 7282358;
                                                    offset.Y = 3596711;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 971550;
                                                }
                                            }
                                        }
                                    }

                                    else if (higherPrimaryGraphicList.Count == 3)
                                    {
                                        var graphic1 = higherPrimaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 1145304;
                                                    offset.Y = 3596711;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 788670;
                                                }
                                            }
                                        }

                                        var graphic2 = higherPrimaryGraphicList[1];
                                        if (graphic2 != null)
                                        {
                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 4827536;
                                                    offset.Y = 3596711;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 979170;
                                                }
                                            }
                                        }

                                        var graphic3 = higherPrimaryGraphicList[2];
                                        if (graphic3 != null)
                                        {
                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 8509768;
                                                    offset.Y = 3596711;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 1169670;
                                                }
                                            }
                                        }
                                    }
                                }

                                // for 8 names
                                else if (primaryCount == 8)
                                {
                                    // do nothing
                                }

                                slidePart4.Slide.Save();
                            }

                            else if (currentSlideIndexForPrimary == 1 && (primaryCount > 8 && primaryCount <= 16))
                            {
                                SlideId slideId4 = slideIdList?.ChildElements[currentSlideIndexForPrimary] as SlideId;
                                SlidePart slidePart4 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId4.RelationshipId);
                                Slide slide4 = slidePart4?.Slide;

                                ShapeTree shapeTree4 = slide4.CommonSlideData.GetFirstChild<ShapeTree>();

                                var graphicFrames4 = shapeTree4.Elements<P.GraphicFrame>()
                                                                 .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                                 .ToList();

                                int remainingData = primaryCount - 8;

                                graphicFrames4 = graphicFrames4.OrderBy(x => x.InnerText).Take(remainingData).ToList();

                                // for under 4 names
                                if (remainingData < 4)
                                {
                                    var primaryGraphicList = graphicFrames4.ToList();

                                    if (primaryGraphicList.Count == 1)
                                    {
                                        var graphic1 = primaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                            if (transform1 != null)
                                            {
                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                if (offset1 != null)
                                                {
                                                    offset1.X = 4827536;
                                                    offset1.Y = 872561;
                                                }
                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                if (extents1 != null)
                                                {
                                                    extents1.Cx = 2536928;
                                                    extents1.Cy = 979170;
                                                }
                                            }
                                        }
                                    }

                                    else if (primaryGraphicList.Count == 2)
                                    {
                                        var graphic1 = primaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                            if (transform1 != null)
                                            {
                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                if (offset1 != null)
                                                {
                                                    offset1.X = 2372715;
                                                    offset1.Y = 872561;
                                                }
                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                if (extents1 != null)
                                                {
                                                    extents1.Cx = 2536928;
                                                    extents1.Cy = 788670;
                                                }
                                            }
                                        }

                                        var graphic2 = primaryGraphicList[1];
                                        if (graphic2 != null)
                                        {
                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 7282358;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 971550;
                                                }
                                            }
                                        }
                                    }

                                    else if (primaryGraphicList.Count == 3)
                                    {
                                        var graphic1 = primaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 1145304;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 1169670;
                                                }
                                            }
                                        }

                                        var graphic2 = primaryGraphicList[1];
                                        if (graphic2 != null)
                                        {
                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 4827536;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 979170;
                                                }
                                            }
                                        }

                                        var graphic3 = primaryGraphicList[2];
                                        if (graphic3 != null)
                                        {
                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 8509768;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 979170;
                                                }
                                            }
                                        }

                                    }
                                }

                                // for 4 names
                                else if (remainingData == 4)
                                {
                                    // do nothing
                                }

                                // for under 8 names but more than 4
                                else if (remainingData > 4 && remainingData < 8)
                                {
                                    var higherPrimaryGraphicList = graphicFrames4.Skip(4).ToList();

                                    if (remainingData == 5)
                                    {
                                        if (higherPrimaryGraphicList.Count == 1)
                                        {
                                            var graphic1 = higherPrimaryGraphicList[0];
                                            if (graphic1 != null)
                                            {
                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                if (transform1 != null)
                                                {
                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                    if (offset1 != null)
                                                    {
                                                        offset1.X = 4827536;
                                                        offset1.Y = 3596711;
                                                    }
                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                    if (extents1 != null)
                                                    {
                                                        extents1.Cx = 2536928;
                                                        extents1.Cy = 788670;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    else if (remainingData == 6)
                                    {
                                        if (higherPrimaryGraphicList.Count == 2)
                                        {
                                            var graphic1 = higherPrimaryGraphicList[0];
                                            if (graphic1 != null)
                                            {
                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                if (transform1 != null)
                                                {
                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                    if (offset1 != null)
                                                    {
                                                        offset1.X = 2372715;
                                                        offset1.Y = 3596711;
                                                    }
                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                    if (extents1 != null)
                                                    {
                                                        extents1.Cx = 2536928;
                                                        extents1.Cy = 971550;
                                                    }
                                                }
                                            }

                                            var graphic2 = higherPrimaryGraphicList[1];
                                            if (graphic2 != null)
                                            {
                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                if (transform != null)
                                                {
                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                    if (offset != null)
                                                    {
                                                        offset.X = 7282358;
                                                        offset.Y = 3596711;
                                                    }
                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                    if (extents != null)
                                                    {
                                                        extents.Cx = 2536928;
                                                        extents.Cy = 971550;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    else if (remainingData == 7)
                                    {
                                        if (higherPrimaryGraphicList.Count == 3)
                                        {
                                            var graphic1 = higherPrimaryGraphicList[0];
                                            if (graphic1 != null)
                                            {
                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                if (transform != null)
                                                {
                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                    if (offset != null)
                                                    {
                                                        offset.X = 1145304;
                                                        offset.Y = 3596711;
                                                    }
                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                    if (extents != null)
                                                    {
                                                        extents.Cx = 2536928;
                                                        extents.Cy = 788670;
                                                    }
                                                }
                                            }

                                            var graphic2 = higherPrimaryGraphicList[1];
                                            if (graphic2 != null)
                                            {
                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                if (transform != null)
                                                {
                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                    if (offset != null)
                                                    {
                                                        offset.X = 4827536;
                                                        offset.Y = 3596711;
                                                    }
                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                    if (extents != null)
                                                    {
                                                        extents.Cx = 2536928;
                                                        extents.Cy = 979170;
                                                    }
                                                }
                                            }

                                            var graphic3 = higherPrimaryGraphicList[2];
                                            if (graphic3 != null)
                                            {
                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                if (transform != null)
                                                {
                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                    if (offset != null)
                                                    {
                                                        offset.X = 8509768;
                                                        offset.Y = 3596711;
                                                    }
                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                    if (extents != null)
                                                    {
                                                        extents.Cx = 2536928;
                                                        extents.Cy = 1169670;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }

                                // for 8 names
                                else if (remainingData == 8)
                                {
                                    // do nothing
                                }

                                slidePart4.Slide.Save();

                            }

                            else if (currentSlideIndexForPrimary == 2 && (primaryCount > 16 && primaryCount <= 24))
                            {
                                SlideId slideId4 = slideIdList?.ChildElements[currentSlideIndexForPrimary] as SlideId;
                                SlidePart slidePart4 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId4.RelationshipId);
                                Slide slide4 = slidePart4?.Slide;

                                ShapeTree shapeTree4 = slide4.CommonSlideData.GetFirstChild<ShapeTree>();

                                var graphicFrames4 = shapeTree4.Elements<P.GraphicFrame>()
                                                                 .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                                 .ToList();

                                int remainingData = primaryCount - 16;

                                graphicFrames4 = graphicFrames4.OrderBy(x => x.InnerText).Take(remainingData).ToList();

                                // for under 4 names
                                if (remainingData < 4)
                                {
                                    var primaryGraphicList = graphicFrames4.ToList();

                                    if (primaryGraphicList.Count == 1)
                                    {
                                        var graphic1 = primaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                            if (transform1 != null)
                                            {
                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                if (offset1 != null)
                                                {
                                                    offset1.X = 4827536;
                                                    offset1.Y = 872561;
                                                }
                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                if (extents1 != null)
                                                {
                                                    extents1.Cx = 2536928;
                                                    extents1.Cy = 979170;
                                                }
                                            }
                                        }
                                    }

                                    else if (primaryGraphicList.Count == 2)
                                    {
                                        var graphic1 = primaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                            if (transform1 != null)
                                            {
                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                if (offset1 != null)
                                                {
                                                    offset1.X = 2372715;
                                                    offset1.Y = 872561;
                                                }
                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                if (extents1 != null)
                                                {
                                                    extents1.Cx = 2536928;
                                                    extents1.Cy = 788670;
                                                }
                                            }
                                        }

                                        var graphic2 = primaryGraphicList[1];
                                        if (graphic2 != null)
                                        {
                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 7282358;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 971550;
                                                }
                                            }
                                        }
                                    }

                                    else if (primaryGraphicList.Count == 3)
                                    {
                                        var graphic1 = primaryGraphicList[0];
                                        if (graphic1 != null)
                                        {
                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 1145304;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 1169670;
                                                }
                                            }
                                        }

                                        var graphic2 = primaryGraphicList[1];
                                        if (graphic2 != null)
                                        {
                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 4827536;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 979170;
                                                }
                                            }
                                        }

                                        var graphic3 = primaryGraphicList[2];
                                        if (graphic3 != null)
                                        {
                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                            if (transform != null)
                                            {
                                                var offset = transform.GetFirstChild<A.Offset>();
                                                if (offset != null)
                                                {
                                                    offset.X = 8509768;
                                                    offset.Y = 872561;
                                                }
                                                var extents = transform.GetFirstChild<A.Extents>();
                                                if (extents != null)
                                                {
                                                    extents.Cx = 2536928;
                                                    extents.Cy = 979170;
                                                }
                                            }
                                        }

                                    }
                                }

                                // for 4 names
                                else if (remainingData == 4)
                                {
                                    // do nothing
                                }

                                // for under 8 names but more than 4
                                else if (remainingData > 4 && remainingData < 8)
                                {
                                    var higherPrimaryGraphicList = graphicFrames4.Skip(4).ToList();

                                    if (remainingData == 5)
                                    {
                                        if (higherPrimaryGraphicList.Count == 1)
                                        {
                                            var graphic1 = higherPrimaryGraphicList[0];
                                            if (graphic1 != null)
                                            {
                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                if (transform1 != null)
                                                {
                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                    if (offset1 != null)
                                                    {
                                                        offset1.X = 4827536;
                                                        offset1.Y = 3596711;
                                                    }
                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                    if (extents1 != null)
                                                    {
                                                        extents1.Cx = 2536928;
                                                        extents1.Cy = 788670;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    else if (remainingData == 6)
                                    {
                                        if (higherPrimaryGraphicList.Count == 2)
                                        {
                                            var graphic1 = higherPrimaryGraphicList[0];
                                            if (graphic1 != null)
                                            {
                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                if (transform1 != null)
                                                {
                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                    if (offset1 != null)
                                                    {
                                                        offset1.X = 2372715;
                                                        offset1.Y = 3596711;
                                                    }
                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                    if (extents1 != null)
                                                    {
                                                        extents1.Cx = 2536928;
                                                        extents1.Cy = 971550;
                                                    }
                                                }
                                            }

                                            var graphic2 = higherPrimaryGraphicList[1];
                                            if (graphic2 != null)
                                            {
                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                if (transform != null)
                                                {
                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                    if (offset != null)
                                                    {
                                                        offset.X = 7282358;
                                                        offset.Y = 3596711;
                                                    }
                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                    if (extents != null)
                                                    {
                                                        extents.Cx = 2536928;
                                                        extents.Cy = 971550;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    else if (remainingData == 7)
                                    {
                                        if (higherPrimaryGraphicList.Count == 3)
                                        {
                                            var graphic1 = higherPrimaryGraphicList[0];
                                            if (graphic1 != null)
                                            {
                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                if (transform != null)
                                                {
                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                    if (offset != null)
                                                    {
                                                        offset.X = 1145304;
                                                        offset.Y = 3596711;
                                                    }
                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                    if (extents != null)
                                                    {
                                                        extents.Cx = 2536928;
                                                        extents.Cy = 788670;
                                                    }
                                                }
                                            }

                                            var graphic2 = higherPrimaryGraphicList[1];
                                            if (graphic2 != null)
                                            {
                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                if (transform != null)
                                                {
                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                    if (offset != null)
                                                    {
                                                        offset.X = 4827536;
                                                        offset.Y = 3596711;
                                                    }
                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                    if (extents != null)
                                                    {
                                                        extents.Cx = 2536928;
                                                        extents.Cy = 979170;
                                                    }
                                                }
                                            }

                                            var graphic3 = higherPrimaryGraphicList[2];
                                            if (graphic3 != null)
                                            {
                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                if (transform != null)
                                                {
                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                    if (offset != null)
                                                    {
                                                        offset.X = 8509768;
                                                        offset.Y = 3596711;
                                                    }
                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                    if (extents != null)
                                                    {
                                                        extents.Cx = 2536928;
                                                        extents.Cy = 1169670;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }

                                // for 8 names
                                else if (remainingData == 8)
                                {
                                    // do nothing
                                }

                                slidePart4.Slide.Save();
                            }
                        }

                        int secondaryCount = groupApiData.Count(api => api.strDSIScore == "Secondary");

                        int currentSlideIndexForSecondary = currentSlideIndexForPrimary;
                        int currentApiIndexForSecondary = 0;

                        SlideId slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                        SlidePart slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                        Slide slide2 = slidePart2?.Slide;

                        if (primaryCount == 0)
                        {
                            currentSlideIndexForSecondary = 0;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount <= 4)
                        {
                            currentSlideIndexForSecondary = 0;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount > 4 && primaryCount < 8)
                        {
                            currentSlideIndexForSecondary = 1;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount == 8)
                        {
                            currentSlideIndexForSecondary = 1;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount > 8 && primaryCount < 12)
                        {
                            currentSlideIndexForSecondary = 1;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount == 12)
                        {
                            currentSlideIndexForSecondary = 1;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount > 12 && primaryCount < 16)
                        {
                            currentSlideIndexForSecondary = 2;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount == 16)
                        {
                            currentSlideIndexForSecondary = 2;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount > 16 && primaryCount < 20)
                        {
                            currentSlideIndexForSecondary = 2;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount == 20)
                        {
                            currentSlideIndexForSecondary = 2;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount > 20 && primaryCount < 24)
                        {
                            currentSlideIndexForSecondary = 3;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }
                        else if (primaryCount == 24)
                        {
                            currentSlideIndexForSecondary = 4;
                            slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                            slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                            slide2 = slidePart2?.Slide;
                        }

                        if (secondaryCount > 0)
                        {
                            while (currentApiIndexForSecondary < secondaryCount)
                            {
                                slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                                slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                                slide2 = slidePart2?.Slide;

                                ShapeTree shapeTree2 = slide2?.CommonSlideData.GetFirstChild<ShapeTree>();

                                var graphicFrames = shapeTree2?.Elements<P.GraphicFrame>()
                                                    .Where(frame => frame.Descendants<A.Text>()
                                                    .FirstOrDefault().Text.StartsWith("TESTNAME")).ToList();

                                graphicFrames = graphicFrames.OrderBy(x => x.InnerText).ToList();

                                // If processing the same slide as the primary count
                                if (currentSlideIndexForSecondary == currentSlideIndexForPrimary)
                                {
                                    //if(primaryCount == 0)
                                    //{

                                    //}

                                    if (primaryCount <= 8)
                                    {
                                        // Calculate the remaining graphic frames after Primary processing
                                        int processedFrames = Math.Min(primaryCount, graphicFrames.Count);
                                        int remainingGraphicFrameCount = graphicFrames.Count - processedFrames;

                                        // Ensure remaining frames don't go negative
                                        remainingGraphicFrameCount = Math.Max(remainingGraphicFrameCount, 0);

                                        // Process starting from the correct index for Secondary
                                        int startingIndexForSecondary = primaryCount % 8;

                                        // no primary category exists
                                        if (primaryCount == 0)
                                        {
                                            foreach (var graphicFrame in graphicFrames)
                                            {
                                                var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                                if (text != null && text.StartsWith("TESTNAME"))
                                                {
                                                    // Extract the numeric part from "TESTNAME"
                                                    string numberPart = text.Replace("TESTNAME", "");
                                                    if (int.TryParse(numberPart, out int index))
                                                    {
                                                        if (secondaryCount < 4)
                                                        {
                                                            if (index >= startingIndexForSecondary && index < 4)
                                                            {
                                                                // Secondary items should stay within bounds
                                                                if (currentApiIndexForSecondary < secondaryCount)
                                                                {
                                                                    currentApiIndexForSecondary++;
                                                                }
                                                                else
                                                                {
                                                                    graphicFrame.Remove(); // Remove excess frames
                                                                }
                                                            }
                                                            else if (index >= 8)
                                                            {
                                                                graphicFrame.Remove(); // Remove frames from other rows
                                                            }
                                                        }
                                                        else if (secondaryCount == 4)
                                                        {
                                                            if (index >= startingIndexForSecondary && index <= 4)
                                                            {
                                                                // Secondary items should stay within bounds
                                                                if (currentApiIndexForSecondary < secondaryCount)
                                                                {
                                                                    currentApiIndexForSecondary++;
                                                                }
                                                                else
                                                                {
                                                                    // graphicFrame.Remove(); // Remove excess frames
                                                                }
                                                            }
                                                            else if (index >= 8)
                                                            {
                                                                graphicFrame.Remove(); // Remove frames from other rows
                                                            }
                                                        }
                                                        else if (secondaryCount > 4 && secondaryCount < 8)
                                                        {
                                                            if (index >= startingIndexForSecondary && (index < secondaryCount))
                                                            {
                                                                // Secondary items should stay within bounds
                                                                if (currentApiIndexForSecondary < secondaryCount)
                                                                {
                                                                    currentApiIndexForSecondary++;
                                                                }
                                                                else
                                                                {
                                                                    graphicFrame.Remove(); // Remove excess frames
                                                                }
                                                            }
                                                            else if (index >= 8)
                                                            {
                                                                graphicFrame.Remove(); // Remove frames from other rows
                                                            }
                                                        }
                                                        else if (secondaryCount == 8)
                                                        {
                                                            if (index >= startingIndexForSecondary && (index < 8))
                                                            {
                                                                // Secondary items should stay within bounds
                                                                if (currentApiIndexForSecondary < secondaryCount)
                                                                {
                                                                    currentApiIndexForSecondary++;
                                                                }
                                                                else
                                                                {
                                                                    //graphicFrame.Remove(); // Remove excess frames
                                                                }
                                                            }
                                                            else if (index >= 8)
                                                            {
                                                                //graphicFrame.Remove(); // Remove frames from other rows
                                                            }
                                                        }
                                                        else if (secondaryCount > 8)
                                                        {
                                                            if (index >= startingIndexForSecondary && (index < 8))
                                                            {
                                                                if (currentApiIndexForSecondary < secondaryCount)
                                                                {
                                                                    currentApiIndexForSecondary++;
                                                                }
                                                            }
                                                        }

                                                        //original code

                                                        //if (index >= startingIndexForSecondary)
                                                        //{
                                                        //    // Secondary items should stay within bounds
                                                        //    if (currentApiIndexForSecondary < secondaryCount)
                                                        //    {
                                                        //        currentApiIndexForSecondary++;
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        graphicFrame.Remove(); // Remove excess frames
                                                        //    }
                                                        //}
                                                        //else if (index >= 8)
                                                        //{
                                                        //    graphicFrame.Remove(); // Remove frames from other rows
                                                        //}
                                                    }
                                                }
                                            }
                                        }
                                        //for primary count above 0
                                        else
                                        {
                                            foreach (var graphicFrame in graphicFrames)
                                            {
                                                var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                                if (text != null && text.StartsWith("TESTNAME"))
                                                {
                                                    // Extract the numeric part from "TESTNAME"
                                                    string numberPart = text.Replace("TESTNAME", "");
                                                    if (int.TryParse(numberPart, out int index))
                                                    {
                                                        if (index >= startingIndexForSecondary && index < 8)
                                                        {
                                                            // Secondary items should stay within bounds
                                                            if (currentApiIndexForSecondary < secondaryCount)
                                                            {
                                                                currentApiIndexForSecondary++;
                                                            }
                                                            else
                                                            {
                                                                graphicFrame.Remove(); // Remove excess frames
                                                            }
                                                        }
                                                        else if (index >= 8)
                                                        {
                                                            graphicFrame.Remove(); // Remove frames from other rows
                                                        }
                                                    }
                                                }
                                            }
                                        }

                                        // for reference, never delete

                                        //// Process frames in the top and bottom rows
                                        //foreach (var graphicFrame in graphicFrames)
                                        //{
                                        //    var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                        //    if (text != null && text.StartsWith("TESTNAME"))
                                        //    {
                                        //        // Extract the numeric part from "TESTNAME"
                                        //        string numberPart = text.Replace("TESTNAME", "");
                                        //        if (int.TryParse(numberPart, out int index))
                                        //        {
                                        //            if (index >= startingIndexForSecondary && index < 8)
                                        //            {
                                        //                // Secondary items should stay within bounds
                                        //                if (currentApiIndexForSecondary < secondaryCount)
                                        //                {
                                        //                    currentApiIndexForSecondary++;
                                        //                }
                                        //                else
                                        //                {
                                        //                    graphicFrame.Remove(); // Remove excess frames
                                        //                }
                                        //            }
                                        //            else if (index >= 8)
                                        //            {
                                        //                graphicFrame.Remove(); // Remove frames from other rows
                                        //            }
                                        //        }
                                        //    }
                                        //}
                                    }
                                    else if (primaryCount > 8 && primaryCount <= 16)
                                    {
                                        int primaryDataInPage = primaryCount - 8;

                                        int processedFrames = Math.Min(primaryDataInPage, graphicFrames.Count);
                                        int remainingGraphicFrameCount = graphicFrames.Count - processedFrames;

                                        // Ensure remaining frames don't go negative
                                        remainingGraphicFrameCount = Math.Max(remainingGraphicFrameCount, 0);

                                        // Process starting from the correct index for Secondary
                                        int startingIndexForSecondary = primaryCount % 8;

                                        // no primary category exists
                                        if (primaryCount == 0)
                                        {
                                            foreach (var graphicFrame in graphicFrames)
                                            {
                                                var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                                if (text != null && text.StartsWith("TESTNAME"))
                                                {
                                                    // Extract the numeric part from "TESTNAME"
                                                    string numberPart = text.Replace("TESTNAME", "");
                                                    if (int.TryParse(numberPart, out int index))
                                                    {
                                                        if (secondaryCount < 4)
                                                        {
                                                            if (index >= startingIndexForSecondary && index < 4)
                                                            {
                                                                // Secondary items should stay within bounds
                                                                if (currentApiIndexForSecondary < secondaryCount)
                                                                {
                                                                    currentApiIndexForSecondary++;
                                                                }
                                                                else
                                                                {
                                                                    graphicFrame.Remove(); // Remove excess frames
                                                                }
                                                            }
                                                            else if (index >= 8)
                                                            {
                                                                graphicFrame.Remove(); // Remove frames from other rows
                                                            }
                                                        }
                                                        else if (secondaryCount == 4)
                                                        {
                                                            if (index >= startingIndexForSecondary && index <= 4)
                                                            {
                                                                // Secondary items should stay within bounds
                                                                if (currentApiIndexForSecondary < secondaryCount)
                                                                {
                                                                    currentApiIndexForSecondary++;
                                                                }
                                                                else
                                                                {
                                                                    // graphicFrame.Remove(); // Remove excess frames
                                                                }
                                                            }
                                                            else if (index >= 8)
                                                            {
                                                                graphicFrame.Remove(); // Remove frames from other rows
                                                            }
                                                        }
                                                        else if (secondaryCount > 4 && secondaryCount < 8)
                                                        {
                                                            if (index >= startingIndexForSecondary && (index < secondaryCount))
                                                            {
                                                                // Secondary items should stay within bounds
                                                                if (currentApiIndexForSecondary < secondaryCount)
                                                                {
                                                                    currentApiIndexForSecondary++;
                                                                }
                                                                else
                                                                {
                                                                    graphicFrame.Remove(); // Remove excess frames
                                                                }
                                                            }
                                                            else if (index >= 8)
                                                            {
                                                                graphicFrame.Remove(); // Remove frames from other rows
                                                            }
                                                        }
                                                        else if (secondaryCount == 8)
                                                        {
                                                            if (index >= startingIndexForSecondary && (index < 8))
                                                            {
                                                                // Secondary items should stay within bounds
                                                                if (currentApiIndexForSecondary < secondaryCount)
                                                                {
                                                                    currentApiIndexForSecondary++;
                                                                }
                                                                else
                                                                {
                                                                    //graphicFrame.Remove(); // Remove excess frames
                                                                }
                                                            }
                                                            else if (index >= 8)
                                                            {
                                                                //graphicFrame.Remove(); // Remove frames from other rows
                                                            }
                                                        }

                                                        //original code

                                                        //if (index >= startingIndexForSecondary)
                                                        //{
                                                        //    // Secondary items should stay within bounds
                                                        //    if (currentApiIndexForSecondary < secondaryCount)
                                                        //    {
                                                        //        currentApiIndexForSecondary++;
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        graphicFrame.Remove(); // Remove excess frames
                                                        //    }
                                                        //}
                                                        //else if (index >= 8)
                                                        //{
                                                        //    graphicFrame.Remove(); // Remove frames from other rows
                                                        //}
                                                    }
                                                }
                                            }
                                        }
                                        //for primary count above 0
                                        else
                                        {
                                            int smallestNoInteger = int.MaxValue;
                                            int highestNoInteger = int.MinValue;
                                            int highestUpperRowFrame = -1; // Keep track of the highest frame in the upper row (e.g., testname03, testname11, etc.)
                                            int lowestLowerRowFrame = int.MaxValue; // Keep track of the lowest frame in the lower row (e.g., testname04, testname12, etc.)

                                            if (graphicFrames != null && graphicFrames.Count > 0)
                                            {
                                                foreach (var graphicFrame in graphicFrames)
                                                {
                                                    var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                                    if (text != null && text.StartsWith("TESTNAME"))
                                                    {
                                                        var numberPart = text.Replace("TESTNAME", "");
                                                        if (int.TryParse(numberPart, out int frameNumber))
                                                        {
                                                            smallestNoInteger = Math.Min(smallestNoInteger, frameNumber);
                                                            highestNoInteger = Math.Max(highestNoInteger, frameNumber);

                                                            // Track highest frame in the upper row (e.g., testname03, testname11, etc.)
                                                            if (frameNumber >= smallestNoInteger && frameNumber <= highestNoInteger) // Upper row (00-03)
                                                            {
                                                                highestUpperRowFrame = Math.Max(highestUpperRowFrame, frameNumber);
                                                            }
                                                            else if (frameNumber >= smallestNoInteger && frameNumber <= highestNoInteger) // Lower row (04-07)
                                                            {
                                                                lowestLowerRowFrame = Math.Min(lowestLowerRowFrame, frameNumber);
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            startingIndexForSecondary = startingIndexForSecondary + smallestNoInteger;

                                            foreach (var graphicFrame in graphicFrames)
                                            {
                                                var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                                if (text != null && text.StartsWith("TESTNAME"))
                                                {
                                                    // Extract the numeric part from "TESTNAME"
                                                    string numberPart = text.Replace("TESTNAME", "");
                                                    if (int.TryParse(numberPart, out int index))
                                                    {
                                                        if (index >= startingIndexForSecondary && index <= highestNoInteger)
                                                        {
                                                            // Secondary items should stay within bounds
                                                            if (currentApiIndexForSecondary < secondaryCount)
                                                            {
                                                                currentApiIndexForSecondary++;
                                                            }
                                                            else
                                                            {
                                                                graphicFrame.Remove(); // Remove excess frames
                                                            }
                                                        }
                                                        //else if (index >= 8)
                                                        //{
                                                        //    graphicFrame.Remove(); // Remove frames from other rows
                                                        //}
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    if (currentApiIndexForSecondary < secondaryCount)
                                    {
                                        currentSlideIndexForSecondary++;

                                        slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                                        slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                                        slide2 = slidePart2?.Slide;

                                        shapeTree2 = slide2?.CommonSlideData.GetFirstChild<ShapeTree>();
                                    }
                                }
                                else
                                {
                                    // Handle other slides for Secondary
                                    int currentApiCount = secondaryCount - currentApiIndexForSecondary;

                                    int smallestNoInteger = int.MaxValue;
                                    int highestNoInteger = int.MinValue;
                                    int highestUpperRowFrame = -1;
                                    int lowestLowerRowFrame = int.MaxValue;

                                    if (graphicFrames != null && graphicFrames.Count > 0)
                                    {
                                        foreach (var graphicFrame in graphicFrames)
                                        {
                                            var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                            if (text != null && text.StartsWith("TESTNAME"))
                                            {
                                                var numberPart = text.Replace("TESTNAME", "");
                                                if (int.TryParse(numberPart, out int frameNumber))
                                                {
                                                    smallestNoInteger = Math.Min(smallestNoInteger, frameNumber);
                                                    highestNoInteger = Math.Max(highestNoInteger, frameNumber);

                                                    // Track highest frame in the upper row (e.g., testname03, testname11, etc.)
                                                    if (frameNumber >= smallestNoInteger && frameNumber <= highestNoInteger) // Upper row (00-03)
                                                    {
                                                        highestUpperRowFrame = Math.Max(highestUpperRowFrame, frameNumber);
                                                    }
                                                    else if (frameNumber >= smallestNoInteger && frameNumber <= highestNoInteger) // Lower row (04-07)
                                                    {
                                                        lowestLowerRowFrame = Math.Min(lowestLowerRowFrame, frameNumber);
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    foreach (var graphicFrame in graphicFrames)
                                    {
                                        var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                        if (text != null && text.StartsWith("TESTNAME"))
                                        {
                                            string numberPart = text.Replace("TESTNAME", "");
                                            if (int.TryParse(numberPart, out int index))
                                            {
                                                if (currentApiIndexForSecondary < secondaryCount)
                                                {
                                                    currentApiIndexForSecondary++;
                                                }
                                                else
                                                {
                                                    if (currentApiCount > 4)
                                                    {
                                                        int topRowItems = 4;
                                                        int bottomRowItems = secondaryCount - topRowItems;

                                                        if (index <= highestNoInteger && index >= smallestNoInteger)
                                                        {
                                                            graphicFrame.Remove();
                                                        }
                                                        else if (index >= smallestNoInteger
                                                                        && index <= highestNoInteger
                                                                        && index >= (4 + bottomRowItems))
                                                        {
                                                            graphicFrame.Remove();
                                                        }
                                                    }
                                                    else if (currentApiCount < 4)
                                                    {
                                                        if (index < (smallestNoInteger + 4))
                                                        {
                                                            graphicFrame.Remove(); // Remove excess frames
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    if (currentApiIndexForSecondary < secondaryCount)
                                    {
                                        currentSlideIndexForSecondary++;

                                        slideId2 = slideIdList?.ChildElements[currentSlideIndexForSecondary] as SlideId;
                                        slidePart2 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId2.RelationshipId);
                                        slide2 = slidePart2?.Slide;

                                        shapeTree2 = slide2?.CommonSlideData.GetFirstChild<ShapeTree>();
                                    }
                                }

                                slidePart2.Slide.Save(); // Save changes to the slide
                            }

                            var secondaryCategoryList = groupApiData.FindAll(api => api.strDSIScore == "Secondary").ToList();

                            int secondaryCurrentSlide = currentSlideIndexForSecondary;
                            int secondaryTotalCount = secondaryCount;

                            SlideId slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                            SlidePart slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                            Slide slide5 = slidePart5?.Slide;

                            if (primaryCount == 0)
                            {
                                secondaryCurrentSlide = 0;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart5?.Slide;
                            }
                            else if (primaryCount <= 4)
                            {
                                secondaryCurrentSlide = 0;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart5?.Slide;
                            }
                            else if (primaryCount > 4 && primaryCount < 8)
                            {
                                secondaryCurrentSlide = 1;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart5?.Slide;
                            }
                            else if (primaryCount == 8)
                            {
                                secondaryCurrentSlide = 1;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart5?.Slide;
                            }
                            else if (primaryCount > 8 && primaryCount < 12)
                            {
                                secondaryCurrentSlide = 1;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart2?.Slide;
                            }
                            else if (primaryCount == 12)
                            {
                                secondaryCurrentSlide = 1;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart5?.Slide;
                            }
                            else if (primaryCount > 12 && primaryCount < 16)
                            {
                                secondaryCurrentSlide = 2;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart5?.Slide;
                            }
                            else if (primaryCount == 16)
                            {
                                secondaryCurrentSlide = 2;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart2?.Slide;
                            }
                            else if (primaryCount > 16 && primaryCount < 20)
                            {
                                secondaryCurrentSlide = 2;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart2?.Slide;
                            }
                            else if (primaryCount == 20)
                            {
                                secondaryCurrentSlide = 2;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart5?.Slide;
                            }
                            else if (primaryCount > 20 && primaryCount < 24)
                            {
                                secondaryCurrentSlide = 3;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart5?.Slide;
                            }
                            else if (primaryCount == 24)
                            {
                                secondaryCurrentSlide = 4;
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart5?.Slide;
                            }

                            int secondaryIndex = 0;

                            while (secondaryIndex < secondaryCategoryList.Count)
                            {
                                slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                slide5 = slidePart5?.Slide;

                                ShapeTree shapeTree5 = slide5?.CommonSlideData.GetFirstChild<ShapeTree>();

                                var graphicFramesSecondary = shapeTree5?.Elements<P.GraphicFrame>()
                                                                 .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                                 .ToList();

                                var sortedGraphicListSecondary = graphicFramesSecondary?.OrderBy(x => x.InnerText).ToList();

                                if (secondaryCurrentSlide == 0)
                                {
                                    if (primaryCount == 0)
                                    {
                                        var filteredGraphicList = sortedGraphicListSecondary.Take(secondaryCount).ToList();

                                        secondaryIndex = filteredGraphicList.Count;

                                        if (filteredGraphicList.Count > 0)
                                        {
                                            // less than 4 testnames
                                            if (filteredGraphicList.Count < 4)
                                            {
                                                var secondaryGraphicList = filteredGraphicList;

                                                if (primaryCount == 0)
                                                {
                                                    // count 1
                                                    if (secondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 2
                                                    else if (secondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 3
                                                    else if (secondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = secondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // for 4 names
                                                    else if (secondaryCount == 4)
                                                    {
                                                        // do nothing
                                                    }
                                                }

                                                else if (primaryCount > 0 && primaryCount < 4)
                                                {
                                                    //lower table 1
                                                    if (secondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    //lower table 2
                                                    else if (secondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 971550;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    //lower table 3
                                                    else if (secondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = secondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            //  4 testnames
                                            else if (filteredGraphicList.Count == 4)
                                            {
                                                // do nothing
                                            }

                                            // 4 and 8 testnames
                                            else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                            {
                                                var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                if (higherSecondaryGraphicList.Count == 1)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 4827536;
                                                                offset1.Y = 3596711;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 788670;
                                                            }
                                                        }
                                                    }
                                                }

                                                else if (higherSecondaryGraphicList.Count == 2)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 2372715;
                                                                offset1.Y = 3596711;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 971550;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = higherSecondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 7282358;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 971550;
                                                            }
                                                        }
                                                    }
                                                }

                                                else if (higherSecondaryGraphicList.Count == 3)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 1145304;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 788670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = higherSecondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 4827536;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }

                                                    var graphic3 = higherSecondaryGraphicList[2];
                                                    if (graphic3 != null)
                                                    {
                                                        var transform = graphic3.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 8509768;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 1169670;
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            // 8 testnames
                                            else if (filteredGraphicList.Count == 8)
                                            {
                                                // do nothing
                                            }
                                        }
                                    }
                                    else
                                    {
                                        var filteredGraphicList = sortedGraphicListSecondary.Skip(primaryCount).ToList();

                                        secondaryIndex = filteredGraphicList.Count;

                                        if (filteredGraphicList.Count > 0)
                                        {
                                            // less than 4 testnames
                                            if (filteredGraphicList.Count < 4)
                                            {
                                                var secondaryGraphicList = filteredGraphicList;

                                                if (primaryCount == 0)
                                                {
                                                    // count 1
                                                    if (secondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 2
                                                    else if (secondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 3
                                                    else if (secondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = secondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // for 4 names
                                                    else if (secondaryCount == 4)
                                                    {
                                                        // do nothing
                                                    }
                                                }

                                                else if (primaryCount > 0 && primaryCount < 4)
                                                {
                                                    //lower table 1
                                                    if (secondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    //lower table 2
                                                    else if (secondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 971550;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    //lower table 3
                                                    else if (secondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = secondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            //  4 testnames
                                            else if (filteredGraphicList.Count == 4)
                                            {
                                                // do nothing
                                            }

                                            // 4 and 8 testnames
                                            else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                            {
                                                var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                if (higherSecondaryGraphicList.Count == 1)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 4827536;
                                                                offset1.Y = 3596711;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 788670;
                                                            }
                                                        }
                                                    }
                                                }

                                                else if (higherSecondaryGraphicList.Count == 2)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 2372715;
                                                                offset1.Y = 3596711;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 971550;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = higherSecondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 7282358;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 971550;
                                                            }
                                                        }
                                                    }
                                                }

                                                else if (higherSecondaryGraphicList.Count == 3)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 1145304;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 788670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = higherSecondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 4827536;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }

                                                    var graphic3 = higherSecondaryGraphicList[2];
                                                    if (graphic3 != null)
                                                    {
                                                        var transform = graphic3.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 8509768;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 1169670;
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            // 8 testnames
                                            else if (filteredGraphicList.Count == 8)
                                            {
                                                // do nothing
                                            }
                                        }
                                    }
                                }
                                else if (secondaryCurrentSlide == 1)
                                {
                                    int remainingSecondaryData = secondaryCategoryList.Count - secondaryIndex;
                                    int remainingData = 0;

                                    slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                    slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                    slide5 = slidePart5?.Slide;

                                    shapeTree5 = slide5?.CommonSlideData.GetFirstChild<ShapeTree>();

                                    var graphicFramesSecondarySlide2 = shapeTree5?.Elements<P.GraphicFrame>()
                                                               .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                               .ToList();

                                    var sortedGraphicListForSlide = graphicFramesSecondarySlide2?.OrderBy(x => x.InnerText).ToList();
                                    var filteredListForSlide = sortedGraphicListForSlide.ToList();

                                    if (remainingSecondaryData > filteredListForSlide.Count)
                                    {
                                        if (primaryCount > 8 && primaryCount <= 12)
                                        {
                                            if (primaryCount == 9)
                                            {
                                                remainingData += filteredListForSlide.Count - 1;
                                                //secondaryIndex += remainingData;
                                            }
                                            else if (primaryCount == 10)
                                            {
                                                remainingData += filteredListForSlide.Count - 2;
                                                //secondaryIndex += remainingData;
                                            }
                                            else if (primaryCount == 11)
                                            {
                                                remainingData += filteredListForSlide.Count - 3;
                                                //secondaryIndex += remainingData;
                                            }
                                            else if (primaryCount == 12)
                                            {
                                                remainingData += filteredListForSlide.Count - 4;
                                                //secondaryIndex += remainingData;
                                            }
                                        }
                                        else if (primaryCount == 8)
                                        {
                                            remainingData += 8;
                                        }
                                        else if (primaryCount > 4 && primaryCount < 8)
                                        {
                                            if (remainingSecondaryData == 8)
                                            {
                                                remainingData += 8;
                                            }
                                            else if (remainingSecondaryData > 8)
                                            {
                                                remainingData += 8;
                                            }
                                        }
                                        else if (primaryCount < 4)
                                        {
                                            if (remainingSecondaryData == 8)
                                            {
                                                remainingData += 8;
                                            }
                                            else if (remainingSecondaryData > 8)
                                            {
                                                remainingData += 8;
                                            }
                                        }
                                        //else if (primaryCount == 4)
                                        //{
                                        //    remainingData += 4;
                                        //}
                                    }
                                    else
                                    {
                                        remainingData += remainingSecondaryData;
                                    }

                                    if (remainingData < 8)
                                    {
                                        slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                        slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                        slide5 = slidePart5?.Slide;

                                        shapeTree5 = slide5?.CommonSlideData.GetFirstChild<ShapeTree>();

                                        var filteredList = sortedGraphicListForSlide.Take(remainingData).ToList();
                                        secondaryIndex += remainingData;

                                        if (filteredList.Count > 0)
                                        {
                                            // less than 4 testnames
                                            if (filteredList.Count < 4)
                                            {
                                                var secondaryGraphicList = filteredList;

                                                // count 1
                                                if (secondaryGraphicList.Count == 1)
                                                {
                                                    var graphic1 = secondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 4827536;
                                                                offset1.Y = 872561;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 979170;
                                                            }
                                                        }
                                                    }
                                                }

                                                // count 2
                                                else if (secondaryGraphicList.Count == 2)
                                                {
                                                    var graphic1 = secondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 2372715;
                                                                offset1.Y = 872561;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 788670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = secondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 7282358;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 971550;
                                                            }
                                                        }
                                                    }
                                                }

                                                // count 3
                                                else if (secondaryGraphicList.Count == 3)
                                                {
                                                    var graphic1 = secondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 1145304;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 1169670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = secondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 4827536;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }

                                                    var graphic3 = secondaryGraphicList[2];
                                                    if (graphic3 != null)
                                                    {
                                                        var transform = graphic3.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 8509768;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }
                                                }

                                                // for 4 names
                                                else if (secondaryCount == 4)
                                                {
                                                    // do nothing
                                                }
                                            }

                                            //  4 testnames
                                            else if (filteredList.Count == 4)
                                            {
                                                // do nothing
                                            }

                                            // 4 and 8 testnames
                                            else if (filteredList.Count > 4 && filteredList.Count < 8)
                                            {
                                                var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                if (higherSecondaryGraphicList.Count == 1)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 4827536;
                                                                offset1.Y = 3596711;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 788670;
                                                            }
                                                        }
                                                    }
                                                }

                                                else if (higherSecondaryGraphicList.Count == 2)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 2372715;
                                                                offset1.Y = 3596711;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 971550;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = higherSecondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 7282358;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 971550;
                                                            }
                                                        }
                                                    }
                                                }

                                                else if (higherSecondaryGraphicList.Count == 3)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 1145304;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 788670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = higherSecondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 4827536;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }

                                                    var graphic3 = higherSecondaryGraphicList[2];
                                                    if (graphic3 != null)
                                                    {
                                                        var transform = graphic3.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 8509768;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 1169670;
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            // 8 testnames
                                            else if (filteredList.Count == 8)
                                            {
                                                // do nothing
                                            }
                                        }
                                    }
                                    else if (remainingData == 8)
                                    {
                                        // do nothing for frames
                                        secondaryIndex += remainingData;
                                        //secondaryCurrentSlide++;
                                    }
                                    else if (remainingData > 8)
                                    {
                                        secondaryIndex += remainingData;
                                    }
                                }
                                else if (secondaryCurrentSlide == 2)
                                {
                                    int remainingSecondaryData = secondaryCategoryList.Count - secondaryIndex;
                                    int remainingData = 0;

                                    slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                    slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                    slide5 = slidePart5?.Slide;

                                    shapeTree5 = slide5?.CommonSlideData.GetFirstChild<ShapeTree>();

                                    var graphicFramesSecondaryListSlide3 = shapeTree5?.Elements<P.GraphicFrame>()
                                                                 .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                                 .ToList();

                                    var sortedGraphicListForSlide = graphicFramesSecondaryListSlide3?.OrderBy(x => x.InnerText).ToList();
                                    var filteredListForSlide = sortedGraphicListForSlide.ToList();

                                    if (remainingSecondaryData > filteredListForSlide.Count)
                                    {
                                        remainingData += filteredListForSlide.Count;
                                        secondaryIndex += remainingData;
                                    }
                                    else
                                    {
                                        remainingData += remainingSecondaryData;
                                    }

                                    if (remainingData < 8)
                                    {
                                        slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                        slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                        slide5 = slidePart5?.Slide;

                                        shapeTree5 = slide5?.CommonSlideData.GetFirstChild<ShapeTree>();
                                        var filteredList = sortedGraphicListForSlide.Take(remainingData).ToList();
                                        secondaryIndex += remainingData;

                                        if (filteredList.Count > 0)
                                        {
                                            // less than 4 testnames
                                            if (filteredList.Count < 4)
                                            {
                                                var secondaryGraphicList = filteredList;

                                                // count 1
                                                if (secondaryGraphicList.Count == 1)
                                                {
                                                    var graphic1 = secondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 4827536;
                                                                offset1.Y = 872561;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 979170;
                                                            }
                                                        }
                                                    }
                                                }

                                                // count 2
                                                else if (secondaryGraphicList.Count == 2)
                                                {
                                                    var graphic1 = secondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 2372715;
                                                                offset1.Y = 872561;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 788670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = secondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 7282358;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 971550;
                                                            }
                                                        }
                                                    }
                                                }

                                                // count 3
                                                else if (secondaryGraphicList.Count == 3)
                                                {
                                                    var graphic1 = secondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 1145304;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 1169670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = secondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 4827536;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }

                                                    var graphic3 = secondaryGraphicList[2];
                                                    if (graphic3 != null)
                                                    {
                                                        var transform = graphic3.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 8509768;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }
                                                }

                                                // for 4 names
                                                else if (secondaryCount == 4)
                                                {
                                                    // do nothing
                                                }
                                            }

                                            //  4 testnames
                                            else if (filteredList.Count == 4)
                                            {
                                                // do nothing
                                            }

                                            // 4 and 8 testnames
                                            else if (filteredList.Count > 4 && filteredList.Count < 8)
                                            {
                                                var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                if (higherSecondaryGraphicList.Count == 1)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 4827536;
                                                                offset1.Y = 3596711;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 788670;
                                                            }
                                                        }
                                                    }
                                                }

                                                else if (higherSecondaryGraphicList.Count == 2)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 2372715;
                                                                offset1.Y = 3596711;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 971550;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = higherSecondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 7282358;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 971550;
                                                            }
                                                        }
                                                    }
                                                }

                                                else if (higherSecondaryGraphicList.Count == 3)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 1145304;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 788670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = higherSecondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 4827536;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }

                                                    var graphic3 = higherSecondaryGraphicList[2];
                                                    if (graphic3 != null)
                                                    {
                                                        var transform = graphic3.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 8509768;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 1169670;
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            // 8 testnames
                                            else if (filteredList.Count == 8)
                                            {
                                                // do nothing
                                            }
                                        }
                                    }
                                    else if (remainingData == 8)
                                    {
                                        // do nothing for frames
                                        secondaryIndex += remainingData;
                                        //secondaryCurrentSlide++;
                                    }
                                    else if (remainingData > 8)
                                    {
                                        secondaryIndex += remainingData;

                                        //sortedGraphicListSecondary = graphicFramesSecondary?.OrderBy(x => x.InnerText).ToList();
                                        //var remainingDataForNextSlide = remainingSecondaryData - sortedGraphicListSecondary.Count;

                                        //if (remainingDataForNextSlide > 0)
                                        //{
                                        //    secondaryCurrentSlide++;
                                        //    slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                        //    slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                        //    slide5 = slidePart5?.Slide;

                                        //    shapeTree5 = slide5?.CommonSlideData.GetFirstChild<ShapeTree>();

                                        //    var filteredList = sortedGraphicListSecondary.Take(remainingDataForNextSlide).ToList();

                                        //    if (filteredList.Count > 0)
                                        //    {
                                        //        // less than 4 testnames
                                        //        if (filteredList.Count < 4)
                                        //        {
                                        //            var secondaryGraphicList = filteredList;

                                        //            // count 1
                                        //            if (secondaryGraphicList.Count == 1)
                                        //            {
                                        //                var graphic1 = secondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform1 != null)
                                        //                    {
                                        //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                        //                        if (offset1 != null)
                                        //                        {
                                        //                            offset1.X = 4827536;
                                        //                            offset1.Y = 872561;
                                        //                        }
                                        //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                        //                        if (extents1 != null)
                                        //                        {
                                        //                            extents1.Cx = 2536928;
                                        //                            extents1.Cy = 979170;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }

                                        //            // count 2
                                        //            else if (secondaryGraphicList.Count == 2)
                                        //            {
                                        //                var graphic1 = secondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform1 != null)
                                        //                    {
                                        //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                        //                        if (offset1 != null)
                                        //                        {
                                        //                            offset1.X = 2372715;
                                        //                            offset1.Y = 872561;
                                        //                        }
                                        //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                        //                        if (extents1 != null)
                                        //                        {
                                        //                            extents1.Cx = 2536928;
                                        //                            extents1.Cy = 788670;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic2 = secondaryGraphicList[1];
                                        //                if (graphic2 != null)
                                        //                {
                                        //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 7282358;
                                        //                            offset.Y = 872561;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 971550;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }

                                        //            // count 3
                                        //            else if (secondaryGraphicList.Count == 3)
                                        //            {
                                        //                var graphic1 = secondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 1145304;
                                        //                            offset.Y = 872561;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 1169670;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic2 = secondaryGraphicList[1];
                                        //                if (graphic2 != null)
                                        //                {
                                        //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 4827536;
                                        //                            offset.Y = 872561;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 979170;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic3 = secondaryGraphicList[2];
                                        //                if (graphic3 != null)
                                        //                {
                                        //                    var transform = graphic3.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 8509768;
                                        //                            offset.Y = 872561;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 979170;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }

                                        //            // for 4 names
                                        //            else if (secondaryCount == 4)
                                        //            {
                                        //                // do nothing
                                        //            }
                                        //        }

                                        //        //  4 testnames
                                        //        else if (filteredList.Count == 4)
                                        //        {
                                        //            // do nothing
                                        //        }

                                        //        // 4 and 8 testnames
                                        //        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                        //        {
                                        //            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                        //            if (higherSecondaryGraphicList.Count == 1)
                                        //            {
                                        //                var graphic1 = higherSecondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform1 != null)
                                        //                    {
                                        //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                        //                        if (offset1 != null)
                                        //                        {
                                        //                            offset1.X = 4827536;
                                        //                            offset1.Y = 3596711;
                                        //                        }
                                        //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                        //                        if (extents1 != null)
                                        //                        {
                                        //                            extents1.Cx = 2536928;
                                        //                            extents1.Cy = 788670;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }

                                        //            else if (higherSecondaryGraphicList.Count == 2)
                                        //            {
                                        //                var graphic1 = higherSecondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform1 != null)
                                        //                    {
                                        //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                        //                        if (offset1 != null)
                                        //                        {
                                        //                            offset1.X = 2372715;
                                        //                            offset1.Y = 3596711;
                                        //                        }
                                        //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                        //                        if (extents1 != null)
                                        //                        {
                                        //                            extents1.Cx = 2536928;
                                        //                            extents1.Cy = 971550;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic2 = higherSecondaryGraphicList[1];
                                        //                if (graphic2 != null)
                                        //                {
                                        //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 7282358;
                                        //                            offset.Y = 3596711;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 971550;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }

                                        //            else if (higherSecondaryGraphicList.Count == 3)
                                        //            {
                                        //                var graphic1 = higherSecondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 1145304;
                                        //                            offset.Y = 3596711;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 788670;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic2 = higherSecondaryGraphicList[1];
                                        //                if (graphic2 != null)
                                        //                {
                                        //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 4827536;
                                        //                            offset.Y = 3596711;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 979170;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic3 = higherSecondaryGraphicList[2];
                                        //                if (graphic3 != null)
                                        //                {
                                        //                    var transform = graphic3.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 8509768;
                                        //                            offset.Y = 3596711;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 1169670;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }
                                        //        }

                                        //        // 8 testnames
                                        //        else if (filteredList.Count == 8)
                                        //        {
                                        //            // do nothing
                                        //        }
                                        //    }
                                        //}
                                    }
                                }
                                else if (secondaryCurrentSlide == 3)
                                {
                                    int remainingSecondaryData = secondaryCategoryList.Count - secondaryIndex;
                                    int remainingData = 0;

                                    slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                    slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                    slide5 = slidePart5?.Slide;

                                    shapeTree5 = slide5?.CommonSlideData.GetFirstChild<ShapeTree>();

                                    var graphicFramesSecondaryListSlide3 = shapeTree5?.Elements<P.GraphicFrame>()
                                                                 .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                                 .ToList();

                                    var sortedGraphicListForSlide = graphicFramesSecondaryListSlide3?.OrderBy(x => x.InnerText).ToList();
                                    var filteredListForSlide = sortedGraphicListForSlide.ToList();

                                    if (remainingSecondaryData > filteredListForSlide.Count)
                                    {
                                        remainingData += filteredListForSlide.Count;
                                        secondaryIndex += remainingData;
                                    }
                                    else
                                    {
                                        remainingData += remainingSecondaryData;
                                    }

                                    if (remainingData < 8)
                                    {
                                        slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                        slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                        slide5 = slidePart5?.Slide;

                                        shapeTree5 = slide5?.CommonSlideData.GetFirstChild<ShapeTree>();
                                        var filteredList = sortedGraphicListForSlide.Take(remainingData).ToList();
                                        secondaryIndex += remainingData;

                                        if (filteredList.Count > 0)
                                        {
                                            // less than 4 testnames
                                            if (filteredList.Count < 4)
                                            {
                                                var secondaryGraphicList = filteredList;

                                                // count 1
                                                if (secondaryGraphicList.Count == 1)
                                                {
                                                    var graphic1 = secondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 4827536;
                                                                offset1.Y = 872561;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 979170;
                                                            }
                                                        }
                                                    }
                                                }

                                                // count 2
                                                else if (secondaryGraphicList.Count == 2)
                                                {
                                                    var graphic1 = secondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 2372715;
                                                                offset1.Y = 872561;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 788670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = secondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 7282358;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 971550;
                                                            }
                                                        }
                                                    }
                                                }

                                                // count 3
                                                else if (secondaryGraphicList.Count == 3)
                                                {
                                                    var graphic1 = secondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 1145304;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 1169670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = secondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 4827536;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }

                                                    var graphic3 = secondaryGraphicList[2];
                                                    if (graphic3 != null)
                                                    {
                                                        var transform = graphic3.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 8509768;
                                                                offset.Y = 872561;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }
                                                }

                                                // for 4 names
                                                else if (secondaryCount == 4)
                                                {
                                                    // do nothing
                                                }
                                            }

                                            //  4 testnames
                                            else if (filteredList.Count == 4)
                                            {
                                                // do nothing
                                            }

                                            // 4 and 8 testnames
                                            else if (filteredList.Count > 4 && filteredList.Count < 8)
                                            {
                                                var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                if (higherSecondaryGraphicList.Count == 1)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 4827536;
                                                                offset1.Y = 3596711;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 788670;
                                                            }
                                                        }
                                                    }
                                                }

                                                else if (higherSecondaryGraphicList.Count == 2)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform1 != null)
                                                        {
                                                            var offset1 = transform1.GetFirstChild<A.Offset>();
                                                            if (offset1 != null)
                                                            {
                                                                offset1.X = 2372715;
                                                                offset1.Y = 3596711;
                                                            }
                                                            var extents1 = transform1.GetFirstChild<A.Extents>();
                                                            if (extents1 != null)
                                                            {
                                                                extents1.Cx = 2536928;
                                                                extents1.Cy = 971550;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = higherSecondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 7282358;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 971550;
                                                            }
                                                        }
                                                    }
                                                }

                                                else if (higherSecondaryGraphicList.Count == 3)
                                                {
                                                    var graphic1 = higherSecondaryGraphicList[0];
                                                    if (graphic1 != null)
                                                    {
                                                        var transform = graphic1.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 1145304;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 788670;
                                                            }
                                                        }
                                                    }

                                                    var graphic2 = higherSecondaryGraphicList[1];
                                                    if (graphic2 != null)
                                                    {
                                                        var transform = graphic2.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 4827536;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 979170;
                                                            }
                                                        }
                                                    }

                                                    var graphic3 = higherSecondaryGraphicList[2];
                                                    if (graphic3 != null)
                                                    {
                                                        var transform = graphic3.GetFirstChild<P.Transform>();
                                                        if (transform != null)
                                                        {
                                                            var offset = transform.GetFirstChild<A.Offset>();
                                                            if (offset != null)
                                                            {
                                                                offset.X = 8509768;
                                                                offset.Y = 3596711;
                                                            }
                                                            var extents = transform.GetFirstChild<A.Extents>();
                                                            if (extents != null)
                                                            {
                                                                extents.Cx = 2536928;
                                                                extents.Cy = 1169670;
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            // 8 testnames
                                            else if (filteredList.Count == 8)
                                            {
                                                // do nothing
                                            }
                                        }
                                    }
                                    else if (remainingData == 8)
                                    {
                                        // do nothing for frames
                                        secondaryIndex += remainingData;
                                        //secondaryCurrentSlide++;
                                    }
                                    else if (remainingData > 8)
                                    {
                                        secondaryIndex += remainingData;

                                        //sortedGraphicListSecondary = graphicFramesSecondary?.OrderBy(x => x.InnerText).ToList();
                                        //var remainingDataForNextSlide = remainingSecondaryData - sortedGraphicListSecondary.Count;

                                        //if (remainingDataForNextSlide > 0)
                                        //{
                                        //    secondaryCurrentSlide++;
                                        //    slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                        //    slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                        //    slide5 = slidePart5?.Slide;

                                        //    shapeTree5 = slide5?.CommonSlideData.GetFirstChild<ShapeTree>();

                                        //    var filteredList = sortedGraphicListSecondary.Take(remainingDataForNextSlide).ToList();

                                        //    if (filteredList.Count > 0)
                                        //    {
                                        //        // less than 4 testnames
                                        //        if (filteredList.Count < 4)
                                        //        {
                                        //            var secondaryGraphicList = filteredList;

                                        //            // count 1
                                        //            if (secondaryGraphicList.Count == 1)
                                        //            {
                                        //                var graphic1 = secondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform1 != null)
                                        //                    {
                                        //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                        //                        if (offset1 != null)
                                        //                        {
                                        //                            offset1.X = 4827536;
                                        //                            offset1.Y = 872561;
                                        //                        }
                                        //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                        //                        if (extents1 != null)
                                        //                        {
                                        //                            extents1.Cx = 2536928;
                                        //                            extents1.Cy = 979170;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }

                                        //            // count 2
                                        //            else if (secondaryGraphicList.Count == 2)
                                        //            {
                                        //                var graphic1 = secondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform1 != null)
                                        //                    {
                                        //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                        //                        if (offset1 != null)
                                        //                        {
                                        //                            offset1.X = 2372715;
                                        //                            offset1.Y = 872561;
                                        //                        }
                                        //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                        //                        if (extents1 != null)
                                        //                        {
                                        //                            extents1.Cx = 2536928;
                                        //                            extents1.Cy = 788670;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic2 = secondaryGraphicList[1];
                                        //                if (graphic2 != null)
                                        //                {
                                        //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 7282358;
                                        //                            offset.Y = 872561;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 971550;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }

                                        //            // count 3
                                        //            else if (secondaryGraphicList.Count == 3)
                                        //            {
                                        //                var graphic1 = secondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 1145304;
                                        //                            offset.Y = 872561;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 1169670;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic2 = secondaryGraphicList[1];
                                        //                if (graphic2 != null)
                                        //                {
                                        //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 4827536;
                                        //                            offset.Y = 872561;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 979170;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic3 = secondaryGraphicList[2];
                                        //                if (graphic3 != null)
                                        //                {
                                        //                    var transform = graphic3.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 8509768;
                                        //                            offset.Y = 872561;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 979170;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }

                                        //            // for 4 names
                                        //            else if (secondaryCount == 4)
                                        //            {
                                        //                // do nothing
                                        //            }
                                        //        }

                                        //        //  4 testnames
                                        //        else if (filteredList.Count == 4)
                                        //        {
                                        //            // do nothing
                                        //        }

                                        //        // 4 and 8 testnames
                                        //        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                        //        {
                                        //            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                        //            if (higherSecondaryGraphicList.Count == 1)
                                        //            {
                                        //                var graphic1 = higherSecondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform1 != null)
                                        //                    {
                                        //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                        //                        if (offset1 != null)
                                        //                        {
                                        //                            offset1.X = 4827536;
                                        //                            offset1.Y = 3596711;
                                        //                        }
                                        //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                        //                        if (extents1 != null)
                                        //                        {
                                        //                            extents1.Cx = 2536928;
                                        //                            extents1.Cy = 788670;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }

                                        //            else if (higherSecondaryGraphicList.Count == 2)
                                        //            {
                                        //                var graphic1 = higherSecondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform1 != null)
                                        //                    {
                                        //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                        //                        if (offset1 != null)
                                        //                        {
                                        //                            offset1.X = 2372715;
                                        //                            offset1.Y = 3596711;
                                        //                        }
                                        //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                        //                        if (extents1 != null)
                                        //                        {
                                        //                            extents1.Cx = 2536928;
                                        //                            extents1.Cy = 971550;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic2 = higherSecondaryGraphicList[1];
                                        //                if (graphic2 != null)
                                        //                {
                                        //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 7282358;
                                        //                            offset.Y = 3596711;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 971550;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }

                                        //            else if (higherSecondaryGraphicList.Count == 3)
                                        //            {
                                        //                var graphic1 = higherSecondaryGraphicList[0];
                                        //                if (graphic1 != null)
                                        //                {
                                        //                    var transform = graphic1.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 1145304;
                                        //                            offset.Y = 3596711;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 788670;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic2 = higherSecondaryGraphicList[1];
                                        //                if (graphic2 != null)
                                        //                {
                                        //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 4827536;
                                        //                            offset.Y = 3596711;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 979170;
                                        //                        }
                                        //                    }
                                        //                }

                                        //                var graphic3 = higherSecondaryGraphicList[2];
                                        //                if (graphic3 != null)
                                        //                {
                                        //                    var transform = graphic3.GetFirstChild<P.Transform>();
                                        //                    if (transform != null)
                                        //                    {
                                        //                        var offset = transform.GetFirstChild<A.Offset>();
                                        //                        if (offset != null)
                                        //                        {
                                        //                            offset.X = 8509768;
                                        //                            offset.Y = 3596711;
                                        //                        }
                                        //                        var extents = transform.GetFirstChild<A.Extents>();
                                        //                        if (extents != null)
                                        //                        {
                                        //                            extents.Cx = 2536928;
                                        //                            extents.Cy = 1169670;
                                        //                        }
                                        //                    }
                                        //                }
                                        //            }
                                        //        }

                                        //        // 8 testnames
                                        //        else if (filteredList.Count == 8)
                                        //        {
                                        //            // do nothing
                                        //        }
                                        //    }
                                        //}
                                    }


                                }

                                if (secondaryIndex < secondaryCategoryList.Count)
                                {
                                    secondaryCurrentSlide++;

                                    slideId5 = slideIdList?.ChildElements[secondaryCurrentSlide] as SlideId;
                                    slidePart5 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId5.RelationshipId);
                                    slide5 = slidePart5?.Slide;
                                }
                                slidePart5.Slide.Save();
                            }
                        }

                        int tertiaryCount = groupApiData.Count(api => api.strDSIScore == "Tertiary");

                        int currentSlideIndexForTertiary = currentSlideIndexForSecondary;
                        int currentApiIndexForTertiary = 0;

                        if (tertiaryCount > 0)
                        {
                            // Step 1: Calculate smallest and highest TESTNAME values only for the current slide
                            int smallestNoInteger = int.MaxValue;
                            int highestNoInteger = int.MinValue;
                            int highestUpperRowFrame = -1; // Keep track of the highest frame in the upper row (e.g., testname03, testname11, etc.)
                            int lowestLowerRowFrame = int.MaxValue; // Keep track of the lowest frame in the lower row (e.g., testname04, testname12, etc.)

                            // Access the current slide using the currentSlideIndexForTertiary
                            SlideId slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                            SlidePart slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                            Slide slide = slidePart?.Slide;

                            // primary == 0
                            if (primaryCount > 0 && secondaryCount == 0)
                            {
                                if (primaryCount > 0 && primaryCount <= 4)
                                {
                                    currentSlideIndexForTertiary = 0;
                                    slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                                else if (primaryCount > 4 && primaryCount <= 8)
                                {
                                    currentSlideIndexForTertiary = 1;
                                    slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                                else if (primaryCount > 8 && primaryCount <= 12)
                                {
                                    currentSlideIndexForTertiary = 1;
                                    slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                                else if (primaryCount > 12 && primaryCount <= 16)
                                {
                                    currentSlideIndexForTertiary = 2;
                                    slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                                else if (primaryCount > 16 && primaryCount <= 20)
                                {
                                    currentSlideIndexForTertiary = 2;
                                    slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                                else if (primaryCount > 20 && primaryCount <= 24)
                                {
                                    currentSlideIndexForTertiary = 3;
                                    slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                            }
                            else if (primaryCount == 0 && secondaryCount <= 4)
                            {
                                currentSlideIndexForTertiary = 0;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if (primaryCount == 0 && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlideIndexForTertiary = 1;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if (primaryCount == 0 && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlideIndexForTertiary = 1;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if (primaryCount == 0 && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if (primaryCount == 0 && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }

                            // primary < 4
                            else if (primaryCount < 4 && secondaryCount <= 4)
                            {
                                currentSlideIndexForTertiary = 1;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if (primaryCount < 4 && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlideIndexForTertiary = 1;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if (primaryCount < 4 && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if (primaryCount < 4 && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if (primaryCount < 4 && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if (primaryCount < 4 && (secondaryCount > 20 && secondaryCount <= 24))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }

                            // primary == 4
                            else if ((primaryCount == 4) && secondaryCount <= 4)
                            {
                                currentSlideIndexForTertiary = 1;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount == 4) && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlideIndexForTertiary = 1;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount == 4) && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount == 4) && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount == 4) && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if (primaryCount == 4 && (secondaryCount > 20 && secondaryCount <= 24))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }

                            // primary < 8
                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount <= 4))
                            {
                                currentSlideIndexForTertiary = 1;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 12 && secondaryCount < 16))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }

                            // primary < 12
                            else if ((primaryCount > 8 && primaryCount <= 12) && (secondaryCount <= 4))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 8 && primaryCount <= 12) && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 8 && primaryCount <= 12) && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 8 && primaryCount <= 12) && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 8 && primaryCount <= 12) && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlideIndexForTertiary = 4;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }

                            // primary < 16
                            else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount <= 4))
                            {
                                currentSlideIndexForTertiary = 2;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlideIndexForTertiary = 4;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlideIndexForTertiary = 4;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }

                            // primary < 20
                            else if ((primaryCount > 16 && primaryCount <= 20) && secondaryCount <= 4)
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 16 && primaryCount <= 20) && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlideIndexForTertiary = 3;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 16 && primaryCount <= 20) && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlideIndexForTertiary = 4;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }
                            else if ((primaryCount > 16 && primaryCount <= 20) && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlideIndexForTertiary = 4;
                                slideId = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                slide = slidePart?.Slide;
                            }

                            ShapeTree shapeTree = slide?.CommonSlideData.GetFirstChild<ShapeTree>();

                            // Get all graphic frames in the current slide
                            var graphicFrames = shapeTree?.Elements<P.GraphicFrame>()
                                .Where(frame => frame.Descendants<A.Text>().FirstOrDefault()?.Text.StartsWith("TESTNAME") == true)
                                .ToList();

                            if (graphicFrames != null && graphicFrames.Count > 0)
                            {
                                foreach (var graphicFrame in graphicFrames)
                                {
                                    var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                    if (text != null && text.StartsWith("TESTNAME"))
                                    {
                                        var numberPart = text.Replace("TESTNAME", "");
                                        if (int.TryParse(numberPart, out int frameNumber))
                                        {
                                            smallestNoInteger = Math.Min(smallestNoInteger, frameNumber);
                                            highestNoInteger = Math.Max(highestNoInteger, frameNumber);

                                            // Track highest frame in the upper row (e.g., testname03, testname11, etc.)
                                            if (frameNumber >= smallestNoInteger && frameNumber <= highestNoInteger) // Upper row (00-03)
                                            {
                                                highestUpperRowFrame = Math.Max(highestUpperRowFrame, frameNumber);
                                            }
                                            else if (frameNumber >= smallestNoInteger && frameNumber <= highestNoInteger) // Lower row (04-07)
                                            {
                                                lowestLowerRowFrame = Math.Min(lowestLowerRowFrame, frameNumber);
                                            }
                                        }
                                    }
                                }
                            }

                            while (currentApiIndexForTertiary < tertiaryCount)
                            {
                                SlideId slideId4 = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                SlidePart slidePart4 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId4.RelationshipId);
                                Slide slide4 = slidePart4?.Slide;

                                ShapeTree shapeTree8 = slide4?.CommonSlideData.GetFirstChild<ShapeTree>();

                                // Get all graphic frames in reverse order
                                var graphicFrames2 = shapeTree8?.Elements<P.GraphicFrame>()
                                    .Where(frame => frame.Descendants<A.Text>().FirstOrDefault()?.Text.StartsWith("TESTNAME") == true)
                                    .Reverse()
                                    .ToList();

                                if (currentSlideIndexForTertiary == currentSlideIndexForSecondary)
                                {
                                    if (highestNoInteger - smallestNoInteger < 5)
                                    {
                                        currentSlideIndexForTertiary++;
                                    }
                                    else
                                    {
                                        int startingFrameIndex = 0;

                                        if (secondaryCount > 0)
                                        {
                                            // primary 0
                                            if (primaryCount == 0 && secondaryCount <= 4)
                                            {
                                                if (secondaryCount == 1)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 2)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 3)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 0 && (secondaryCount > 4 && secondaryCount < 8))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 0 && secondaryCount == 8)
                                            {
                                                startingFrameIndex = 0;
                                            }

                                            else if (primaryCount == 0 && (secondaryCount > 8 && secondaryCount < 12))
                                            {
                                                if (secondaryCount == 9)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 10)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 11)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 0 && secondaryCount == 12)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if (primaryCount == 0 && (secondaryCount > 12 && secondaryCount < 16))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 0 && secondaryCount == 16)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 0 && (secondaryCount > 16 && secondaryCount < 20))
                                            {
                                                if (secondaryCount == 17)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 18)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 19)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 0 && secondaryCount == 20)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if (primaryCount == 0 && (secondaryCount > 20 && secondaryCount < 24))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 0 && secondaryCount == 24)
                                            {
                                                startingFrameIndex = 0;
                                            }

                                            // primary less than 4
                                            else if (primaryCount < 4 && secondaryCount == 0)
                                            {
                                                if (primaryCount == 1)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (primaryCount == 2)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (primaryCount == 3)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount < 4 && secondaryCount <= 4)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount < 4 && (secondaryCount > 4 && secondaryCount < 8))
                                            {
                                                if (secondaryCount == 5)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 6)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 7)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount < 4 && secondaryCount == 8)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if (primaryCount < 4 && (secondaryCount > 8 && secondaryCount < 12))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount < 4 && secondaryCount == 12)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount < 4 && (secondaryCount > 12 && secondaryCount < 16))
                                            {
                                                if (secondaryCount == 13)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 14)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 15)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount < 4 && secondaryCount == 16)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if (primaryCount < 4 && (secondaryCount > 16 && secondaryCount < 20))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount < 4 && secondaryCount == 20)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount < 4 && (secondaryCount > 20 && secondaryCount <= 24))
                                            {
                                                startingFrameIndex = 0;
                                            }

                                            // primary equal 4
                                            else if (primaryCount == 4 && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if (primaryCount == 4 && secondaryCount <= 4)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 4 && (secondaryCount > 4 && secondaryCount < 8))
                                            {
                                                if (secondaryCount == 5)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 6)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 7)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 4 && secondaryCount == 8)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if (primaryCount == 4 && (secondaryCount > 8 && secondaryCount < 12))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 4 && secondaryCount == 12)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 4 && (secondaryCount > 12 && secondaryCount < 16))
                                            {
                                                if (secondaryCount == 13)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 14)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 15)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 4 && secondaryCount == 16)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if (primaryCount == 4 && (secondaryCount > 16 && secondaryCount < 20))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 4 && secondaryCount == 20)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 4 && (secondaryCount > 20 && secondaryCount <= 24))
                                            {
                                                if (secondaryCount == 21)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 22)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 23)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }


                                            // primary more than 4 less than 8
                                            else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount < 4))
                                            {
                                                if (secondaryCount == 1)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 2)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 3)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 4)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 4 && secondaryCount < 8))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 8)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 8 && secondaryCount < 12))
                                            {
                                                if (secondaryCount == 9)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 10)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 11)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 12)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 12 && secondaryCount < 16))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 16)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 16 && secondaryCount < 20))
                                            {
                                                if (secondaryCount == 17)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 18)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 19)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 20)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 20 && secondaryCount <= 24))
                                            {
                                                startingFrameIndex = 0;
                                            }

                                            // primary equal to 8
                                            else if ((primaryCount == 8) && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount == 8) && (secondaryCount < 4))
                                            {
                                                if (secondaryCount == 1)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 2)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 3)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 8 && (secondaryCount == 4))
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if (primaryCount == 8 && (secondaryCount > 4 && secondaryCount < 8))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 8 && (secondaryCount == 8))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 8 && (secondaryCount > 8 && secondaryCount < 12))
                                            {
                                                if (secondaryCount == 9)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 10)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 11)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 8 && secondaryCount == 12)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if (primaryCount == 8 && (secondaryCount > 12 && secondaryCount < 16))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 8 && secondaryCount == 16)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if (primaryCount == 8 && (secondaryCount > 16 && secondaryCount < 20))
                                            {
                                                if (secondaryCount == 17)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 18)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 19)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 8 && secondaryCount == 20)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if (primaryCount == 8 && (secondaryCount > 20 && secondaryCount < 24))
                                            {
                                                startingFrameIndex = 0;
                                            }

                                            // primary more than 8 and less than 12
                                            else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount == 0)
                                            {
                                                if (secondaryCount == 9)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 10)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 11)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount < 4)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount == 4)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 8 && primaryCount <= 12) && (secondaryCount > 4 && secondaryCount < 8))
                                            {
                                                if (secondaryCount == 5)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 6)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 7)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount == 8)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount > 8 && primaryCount <= 12) && (secondaryCount > 8 && secondaryCount < 12))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount == 12)
                                            {
                                                startingFrameIndex = 0;
                                            }

                                            // primary equal 12
                                            else if ((primaryCount == 12) && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount == 12) && secondaryCount < 4)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount == 12) && secondaryCount == 4)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount == 12) && (secondaryCount > 4 && secondaryCount < 8))
                                            {
                                                if (secondaryCount == 5)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 6)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 7)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if ((primaryCount == 12) && secondaryCount == 8)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount == 12) && (secondaryCount > 8 && secondaryCount < 12))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount == 12) && secondaryCount == 12)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount == 12) && (secondaryCount > 12 && secondaryCount < 16))
                                            {
                                                if (secondaryCount == 13)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 14)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 15)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if ((primaryCount == 12) && secondaryCount == 16)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount == 12) && (secondaryCount > 16 && secondaryCount < 20))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount == 12) && secondaryCount == 20)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount == 12) && (secondaryCount > 20 && secondaryCount < 24))
                                            {
                                                if (secondaryCount == 21)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 22)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 23)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if ((primaryCount == 12) && secondaryCount == 24)
                                            {
                                                startingFrameIndex = 5;
                                            }

                                            //primary more than 12 and less than 16
                                            else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 0 && secondaryCount < 4))
                                            {
                                                if (secondaryCount == 1)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 2)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 3)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 4)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 4 && secondaryCount < 8))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 8)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 8 && secondaryCount < 12))
                                            {
                                                if (secondaryCount == 9)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 10)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 11)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 12)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 12 && secondaryCount < 16))
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 16)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 16 && secondaryCount < 20))
                                            {
                                                if (secondaryCount == 17)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (secondaryCount == 18)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (secondaryCount == 19)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }

                                        }
                                        else if (secondaryCount == 0)
                                        {
                                            // primary > 0 , secondary 0
                                            if ((primaryCount > 0 && primaryCount < 4) && secondaryCount == 0)
                                            {
                                                if (primaryCount == 1)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (primaryCount == 2)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (primaryCount == 3)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 4 && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 8 && primaryCount < 12) && secondaryCount == 0)
                                            {
                                                if (primaryCount == 9)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (primaryCount == 10)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (primaryCount == 11)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 12 && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                            else if ((primaryCount > 16 && primaryCount < 20) && secondaryCount == 0)
                                            {
                                                if (primaryCount == 17)
                                                {
                                                    startingFrameIndex = 2;
                                                }
                                                else if (primaryCount == 18)
                                                {
                                                    startingFrameIndex = 3;
                                                }
                                                else if (primaryCount == 19)
                                                {
                                                    startingFrameIndex = 4;
                                                }
                                            }
                                            else if (primaryCount == 20 && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 5;
                                            }
                                            else if ((primaryCount > 20 && primaryCount <= 24) && secondaryCount == 0)
                                            {
                                                startingFrameIndex = 0;
                                            }
                                        }

                                        if (startingFrameIndex > 0)
                                        {
                                            startingFrameIndex = startingFrameIndex - 1;
                                        }

                                        foreach (var gf in graphicFrames2)
                                        {
                                            var text = gf.Descendants<A.Text>().FirstOrDefault()?.Text;
                                            if (text != null && text.StartsWith("TESTNAME"))
                                            {
                                                // Extract the numeric part from "TESTNAME"
                                                string numberPart = text.Replace("TESTNAME", "");
                                                if (int.TryParse(numberPart, out int index))
                                                {
                                                    if (index >= (smallestNoInteger + startingFrameIndex) && index <= highestNoInteger)
                                                    {

                                                        // Secondary items should stay within bounds
                                                        if (currentApiIndexForTertiary < tertiaryCount)
                                                        {
                                                            currentApiIndexForTertiary++;
                                                        }
                                                        else
                                                        {
                                                            gf.Remove(); // Remove excess frames
                                                        }
                                                    }
                                                    //else if (index >= 8)
                                                    //{
                                                    //    // gf.Remove(); // Remove frames from other rows
                                                    //}
                                                }
                                            }
                                        }

                                        if (currentApiIndexForTertiary < tertiaryCount)
                                        {
                                            currentSlideIndexForTertiary++;
                                        }
                                    }
                                }
                                else
                                {
                                    // Handle other slides for tertiary
                                    int currentApiCount = tertiaryCount - currentApiIndexForTertiary;

                                    slideId4 = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                    slidePart4 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId4.RelationshipId);
                                    slide4 = slidePart4?.Slide;

                                    ShapeTree shapeTree4 = slide4?.CommonSlideData.GetFirstChild<ShapeTree>();

                                    smallestNoInteger = int.MaxValue;
                                    highestNoInteger = int.MinValue;

                                    // Get all graphic frames in reverse order
                                    var graphicFrames3 = shapeTree4?.Elements<P.GraphicFrame>()
                                        .Where(frame => frame.Descendants<A.Text>().FirstOrDefault()?.Text.StartsWith("TESTNAME") == true)
                                        .ToList();

                                    graphicFrames3 = graphicFrames3.OrderBy(x => x.InnerText).ToList();

                                    if (graphicFrames3 != null && graphicFrames3.Count > 0)
                                    {
                                        foreach (var graphicFrame in graphicFrames3)
                                        {
                                            var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                            if (text != null && text.StartsWith("TESTNAME"))
                                            {
                                                var numberPart = text.Replace("TESTNAME", "");
                                                if (int.TryParse(numberPart, out int frameNumber))
                                                {
                                                    smallestNoInteger = Math.Min(smallestNoInteger, frameNumber);
                                                    highestNoInteger = Math.Max(highestNoInteger, frameNumber);

                                                    // Track highest frame in the upper row (e.g., testname03, testname11, etc.)
                                                    if (frameNumber >= smallestNoInteger && frameNumber <= highestNoInteger) // Upper row (00-03)
                                                    {
                                                        highestUpperRowFrame = Math.Max(highestUpperRowFrame, frameNumber);
                                                    }
                                                    else if (frameNumber >= smallestNoInteger && frameNumber <= highestNoInteger) // Lower row (04-07)
                                                    {
                                                        lowestLowerRowFrame = Math.Min(lowestLowerRowFrame, frameNumber);
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    if (currentApiCount <= graphicFrames3.Count)
                                    {
                                        foreach (var graphicFrame in graphicFrames3)
                                        {
                                            var text = graphicFrame.Descendants<A.Text>().FirstOrDefault()?.Text;
                                            if (text != null && text.StartsWith("TESTNAME"))
                                            {
                                                string numberPart = text.Replace("TESTNAME", "");
                                                if (int.TryParse(numberPart, out int index))
                                                {
                                                    if (currentApiIndexForTertiary < tertiaryCount)
                                                    {
                                                        currentApiIndexForTertiary++;
                                                    }
                                                    else
                                                    {
                                                        if (currentApiCount >= 4)
                                                        {
                                                            int topRowItems = 4;
                                                            int bottomRowItems = secondaryCount - topRowItems;

                                                            if (index <= highestNoInteger && index >= smallestNoInteger)
                                                            {
                                                                graphicFrame.Remove();
                                                            }
                                                            else if (index >= smallestNoInteger
                                                                            && index <= highestNoInteger
                                                                            && index >= (4 + bottomRowItems))
                                                            {
                                                                graphicFrame.Remove();
                                                            }
                                                        }
                                                        else if (currentApiCount < 4)
                                                        {
                                                            if (index <= (highestNoInteger))
                                                            {
                                                                graphicFrame.Remove(); // Remove excess frames
                                                            }

                                                            //if (index < (smallestNoInteger + 4))
                                                            //{
                                                            //    graphicFrame.Remove(); // Remove excess frames
                                                            //}
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    else if (currentApiCount > graphicFrames3.Count)
                                    {
                                        currentApiIndexForTertiary += 8;
                                    }

                                    if (currentApiIndexForTertiary < tertiaryCount)
                                    {
                                        currentSlideIndexForTertiary++;
                                        slideId4 = slideIdList?.ChildElements[currentSlideIndexForTertiary] as SlideId;
                                        slidePart4 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId4.RelationshipId);
                                        slide4 = slidePart4?.Slide;
                                    }
                                }

                                slidePart4.Slide.Save();
                            }

                            var tertiaryCategoryList = groupApiData.FindAll(api => api.strDSIScore == "Tertiary").ToList();

                            int currentSlide = 0;

                            SlideId slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                            SlidePart slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                            Slide slide6 = slidePart6?.Slide;

                            if (primaryCount > 0 && secondaryCount == 0)
                            {
                                if (primaryCount > 0 && primaryCount <= 4)
                                {
                                    currentSlide = 0;
                                    slideId = slideIdList?.ChildElements[currentSlide] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                                else if (primaryCount > 4 && primaryCount <= 8)
                                {
                                    currentSlide = 1;
                                    slideId = slideIdList?.ChildElements[currentSlide] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                                else if (primaryCount > 8 && primaryCount <= 12)
                                {
                                    currentSlide = 1;
                                    slideId = slideIdList?.ChildElements[currentSlide] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                                else if (primaryCount > 12 && primaryCount <= 16)
                                {
                                    currentSlide = 2;
                                    slideId = slideIdList?.ChildElements[currentSlide] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                                else if (primaryCount > 16 && primaryCount <= 20)
                                {
                                    currentSlide = 2;
                                    slideId = slideIdList?.ChildElements[currentSlide] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                                else if (primaryCount > 20 && primaryCount <= 24)
                                {
                                    currentSlide = 3;
                                    slideId = slideIdList?.ChildElements[currentSlide] as SlideId;
                                    slidePart = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId.RelationshipId);
                                    slide = slidePart?.Slide;
                                }
                            }
                            if (primaryCount == 0 && secondaryCount <= 4)
                            {
                                currentSlide = 0;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 0 && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlide = 1;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 0 && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlide = 1;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 0 && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 0 && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }

                            else if (primaryCount == 4 && secondaryCount <= 4)
                            {
                                currentSlide = 1;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 4 && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlide = 1;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 4 && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 4 && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 4 && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 4 && (secondaryCount > 20 && secondaryCount <= 24))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }

                            else if (primaryCount < 4 && secondaryCount <= 4)
                            {
                                currentSlide = 1;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount < 4 && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlide = 1;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount < 4 && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount < 4 && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount < 4 && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }



                            else if ((primaryCount > 4 && primaryCount < 8) && (secondaryCount <= 4))
                            {
                                currentSlide = 1;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 4 && primaryCount < 8) && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 4 && primaryCount < 8) && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 4 && primaryCount < 8) && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 4 && primaryCount < 8) && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }

                            else if (primaryCount == 8 && secondaryCount <= 4)
                            {
                                currentSlide = 1;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 8 && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 8 && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 8 && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 8 && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }

                            else if ((primaryCount > 8 && primaryCount < 12) && (secondaryCount <= 4))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 8 && primaryCount < 12) && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 8 && primaryCount < 12) && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 8 && primaryCount < 12) && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 8 && primaryCount < 12) && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlide = 4;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }

                            else if (primaryCount == 12 && secondaryCount <= 4)
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 12 && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 12 && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 12 && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 12 && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlide = 4;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }

                            else if ((primaryCount > 12 && primaryCount < 16) && (secondaryCount <= 4))
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 12 && primaryCount < 16) && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 12 && primaryCount < 16) && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 12 && primaryCount < 16) && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlide = 4;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 12 && primaryCount < 16) && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlide = 4;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }

                            else if (primaryCount == 16 && secondaryCount <= 4)
                            {
                                currentSlide = 2;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 16 && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 16 && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 16 && (secondaryCount > 12 && secondaryCount <= 16))
                            {
                                currentSlide = 4;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if (primaryCount == 16 && (secondaryCount > 16 && secondaryCount <= 20))
                            {
                                currentSlide = 4;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }

                            else if ((primaryCount > 16 && primaryCount <= 20) && secondaryCount <= 4)
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 16 && primaryCount <= 20) && (secondaryCount > 4 && secondaryCount <= 8))
                            {
                                currentSlide = 3;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 16 && primaryCount <= 20) && (secondaryCount > 8 && secondaryCount <= 12))
                            {
                                currentSlide = 4;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }
                            else if ((primaryCount > 16 && primaryCount < 20) && (secondaryCount > 12 && secondaryCount < 16))
                            {
                                currentSlide = 4;
                                slideId6 = slideIdList?.ChildElements[currentSlide] as SlideId;
                                slidePart6 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId6.RelationshipId);
                                slide6 = slidePart6?.Slide;
                            }

                            int tertiaryIndex = 0;
                            int slideNumber = currentSlide;
                            bool isFirstTertiarySlideIndexCalculated = true;

                            while (tertiaryIndex < tertiaryCategoryList.Count)
                            {
                                SlideId slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                SlidePart slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                Slide slide7 = slidePart7?.Slide;

                                ShapeTree shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                var graphicFramesTertiary = shapeTree7?.Elements<P.GraphicFrame>()
                                                                 .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                                 .ToList();

                                var sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();

                                int graphicIndexCount = 0;

                                if (isFirstTertiarySlideIndexCalculated)
                                {
                                    // primary > 0 , secondary 0
                                    if ((primaryCount > 0 && primaryCount < 4) && secondaryCount == 0)
                                    {
                                        if (primaryCount == 1)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (primaryCount == 2)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (primaryCount == 3)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 4 && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount == 0)
                                    {
                                        if (primaryCount == 9)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (primaryCount == 10)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (primaryCount == 11)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 12 && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 16 && primaryCount < 20) && secondaryCount == 0)
                                    {
                                        if (primaryCount == 17)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (primaryCount == 18)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (primaryCount == 19)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 20 && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount > 20 && primaryCount <= 24) && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 0;
                                    }

                                    // primary 0
                                    if (primaryCount == 0 && secondaryCount <= 4)
                                    {
                                        if (secondaryCount == 1)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 2)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 3)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 0 && (secondaryCount > 4 && secondaryCount < 8))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 0 && secondaryCount == 8)
                                    {
                                        graphicIndexCount = 0;
                                    }

                                    else if (primaryCount == 0 && (secondaryCount > 8 && secondaryCount < 12))
                                    {
                                        if (secondaryCount == 9)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 10)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 11)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 0 && secondaryCount == 12)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if (primaryCount == 0 && (secondaryCount > 12 && secondaryCount < 16))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 0 && secondaryCount == 16)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 0 && (secondaryCount > 16 && secondaryCount < 20))
                                    {
                                        if (secondaryCount == 17)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 18)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 19)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 0 && secondaryCount == 20)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if (primaryCount == 0 && (secondaryCount > 20 && secondaryCount < 24))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 0 && secondaryCount == 24)
                                    {
                                        graphicIndexCount = 0;
                                    }

                                    // primary less than 4
                                    else if (primaryCount < 4 && secondaryCount == 0)
                                    {
                                        if (primaryCount == 1)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (primaryCount == 2)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (primaryCount == 3)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount < 4 && secondaryCount <= 4)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount < 4 && (secondaryCount > 4 && secondaryCount < 8))
                                    {
                                        if (secondaryCount == 5)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 6)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 7)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount < 4 && secondaryCount == 8)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if (primaryCount < 4 && (secondaryCount > 8 && secondaryCount < 12))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount < 4 && secondaryCount == 12)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount < 4 && (secondaryCount > 12 && secondaryCount < 16))
                                    {
                                        if (secondaryCount == 13)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 14)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 15)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount < 4 && secondaryCount == 16)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if (primaryCount < 4 && (secondaryCount > 16 && secondaryCount < 20))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount < 4 && secondaryCount == 20)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount < 4 && (secondaryCount > 20 && secondaryCount < 24))
                                    {
                                        graphicIndexCount = 0;
                                    }

                                    // primary equal 4
                                    else if (primaryCount == 4 && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if (primaryCount == 4 && secondaryCount <= 4)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 4 && (secondaryCount > 4 && secondaryCount < 8))
                                    {
                                        if (secondaryCount == 5)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 6)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 7)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 4 && secondaryCount == 8)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if (primaryCount == 4 && (secondaryCount > 8 && secondaryCount < 12))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 4 && secondaryCount == 12)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 4 && (secondaryCount > 12 && secondaryCount < 16))
                                    {
                                        if (secondaryCount == 13)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 14)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 15)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 4 && secondaryCount == 16)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if (primaryCount == 4 && (secondaryCount > 16 && secondaryCount < 20))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 4 && secondaryCount == 20)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 4 && (secondaryCount > 20 && secondaryCount < 24))
                                    {
                                        if (secondaryCount == 21)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 22)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 23)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 4 && secondaryCount == 24)
                                    {
                                        graphicIndexCount = 5;
                                    }

                                    // primary more than 4 less than 8
                                    else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount < 4))
                                    {
                                        if (secondaryCount == 1)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 2)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 3)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 4)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 4 && secondaryCount < 8))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 8)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 8 && secondaryCount < 12))
                                    {
                                        if (secondaryCount == 9)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 10)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 11)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 12)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 12 && secondaryCount < 16))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 16)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 16 && secondaryCount < 20))
                                    {
                                        if (secondaryCount == 17)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 18)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 19)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && secondaryCount == 20)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount > 4 && primaryCount <= 8) && (secondaryCount > 20 && secondaryCount <= 24))
                                    {
                                        graphicIndexCount = 0;
                                    }

                                    // primary equal to 8
                                    else if ((primaryCount == 8) && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount == 8) && (secondaryCount < 4))
                                    {
                                        if (secondaryCount == 1)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 2)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 3)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 8 && (secondaryCount == 4))
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if (primaryCount == 8 && (secondaryCount > 4 && secondaryCount < 8))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 8 && (secondaryCount == 8))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 8 && (secondaryCount > 8 && secondaryCount < 12))
                                    {
                                        if (secondaryCount == 9)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 10)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 11)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 8 && secondaryCount == 12)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if (primaryCount == 8 && (secondaryCount > 12 && secondaryCount < 16))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 8 && secondaryCount == 16)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if (primaryCount == 8 && (secondaryCount > 16 && secondaryCount < 20))
                                    {
                                        if (secondaryCount == 17)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 18)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 19)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if (primaryCount == 8 && secondaryCount == 20)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if (primaryCount == 8 && (secondaryCount > 20 && secondaryCount <= 24))
                                    {
                                        graphicIndexCount = 0;
                                    }

                                    // primary more than 8 and less than 12
                                    else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount == 0)
                                    {
                                        if (secondaryCount == 9)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 10)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 11)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount < 4)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount == 4)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 8 && primaryCount <= 12) && (secondaryCount > 4 && secondaryCount < 8))
                                    {
                                        if (secondaryCount == 5)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 6)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 7)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount == 8)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount > 8 && primaryCount <= 12) && (secondaryCount > 8 && secondaryCount < 12))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 8 && primaryCount <= 12) && secondaryCount == 12)
                                    {
                                        graphicIndexCount = 0;
                                    }

                                    // primary equal 12
                                    else if ((primaryCount == 12) && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount == 12) && secondaryCount < 4)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount == 12) && secondaryCount == 4)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount == 12) && (secondaryCount > 4 && secondaryCount < 8))
                                    {
                                        if (secondaryCount == 5)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 6)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 7)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if ((primaryCount == 12) && secondaryCount == 8)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount == 12) && (secondaryCount > 8 && secondaryCount < 12))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount == 12) && secondaryCount == 12)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount == 12) && (secondaryCount > 12 && secondaryCount < 16))
                                    {
                                        if (secondaryCount == 13)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 14)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 15)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if ((primaryCount == 12) && secondaryCount == 16)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount == 12) && (secondaryCount > 16 && secondaryCount < 20))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount == 12) && secondaryCount == 20)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount == 12) && (secondaryCount > 20 && secondaryCount <= 24))
                                    {
                                        if (secondaryCount == 21)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 22)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 23)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if ((primaryCount == 12) && secondaryCount == 24)
                                    {
                                        graphicIndexCount = 5;
                                    }

                                    //primary more than 12 and less than 16
                                    else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 0)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 0 && secondaryCount < 4))
                                    {
                                        if (secondaryCount == 1)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 2)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 3)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 4)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 4 && secondaryCount < 8))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 8)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 8 && secondaryCount < 12))
                                    {
                                        if (secondaryCount == 9)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 10)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 11)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }
                                    else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 12)
                                    {
                                        graphicIndexCount = 5;
                                    }
                                    else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 12 && secondaryCount < 16))
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 12 && primaryCount <= 16) && secondaryCount == 16)
                                    {
                                        graphicIndexCount = 0;
                                    }
                                    else if ((primaryCount > 12 && primaryCount <= 16) && (secondaryCount > 16 && secondaryCount <= 20))
                                    {
                                        if (secondaryCount == 17)
                                        {
                                            graphicIndexCount = 2;
                                        }
                                        else if (secondaryCount == 18)
                                        {
                                            graphicIndexCount = 3;
                                        }
                                        else if (secondaryCount == 19)
                                        {
                                            graphicIndexCount = 4;
                                        }
                                    }

                                    isFirstTertiarySlideIndexCalculated = false;
                                }

                                if (slideNumber == 0)
                                {
                                    int startIndex = 0;
                                    if (graphicIndexCount > 0)
                                    {
                                        startIndex = graphicIndexCount - 1;
                                    }
                                    else
                                    {
                                        startIndex = 0;
                                    }

                                    if (startIndex == 0)
                                    {
                                        int remainingTertiaryData = 0;

                                        if (tertiaryIndex == 0)
                                        {
                                            var filteredGraphicList = sortedGraphicListTertiary.Skip(startIndex).ToList();
                                            tertiaryIndex += filteredGraphicList.Count;

                                            if (filteredGraphicList.Count > 0)
                                            {
                                                // less than 4 testnames
                                                if (filteredGraphicList.Count < 4)
                                                {
                                                    var secondaryGraphicList = filteredGraphicList;

                                                    // count 1
                                                    if (secondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 2
                                                    else if (secondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 3
                                                    else if (secondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = secondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // for 4 names
                                                    else if (secondaryCount == 4)
                                                    {
                                                        // do nothing
                                                    }
                                                }

                                                //  4 testnames
                                                else if (filteredGraphicList.Count == 4)
                                                {
                                                    // do nothing
                                                }

                                                // 4 and 8 testnames
                                                else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                                {
                                                    var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                    if (higherSecondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 971550;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = higherSecondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                                // 8 testnames
                                                else if (filteredGraphicList.Count == 8)
                                                {
                                                    // do nothing
                                                }
                                            }
                                        }
                                        else
                                        {
                                            remainingTertiaryData = tertiaryCategoryList.Count - tertiaryIndex;
                                            tertiaryIndex += remainingTertiaryData;

                                            if (remainingTertiaryData < 8)
                                            {
                                                slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                slide7 = slidePart7?.Slide;

                                                shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                var filteredList = sortedGraphicListTertiary.Take(remainingTertiaryData).ToList();

                                                if (filteredList.Count > 0)
                                                {
                                                    // less than 4 testnames
                                                    if (filteredList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                            else if (remainingTertiaryData == 8)
                                            {
                                                // do nothing for frames
                                                tertiaryIndex += remainingTertiaryData;
                                                slideNumber++;
                                            }
                                            else if (remainingTertiaryData > 8)
                                            {
                                                tertiaryIndex += remainingTertiaryData;

                                                sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();
                                                var remainingDataForNextSlide = remainingTertiaryData - sortedGraphicListTertiary.Count;

                                                if (remainingDataForNextSlide > 0)
                                                {
                                                    slideNumber++;
                                                    slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                    slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                    slide7 = slidePart7?.Slide;

                                                    shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();

                                                    var slideChangeGraphic = shapeTree7?.Elements<P.GraphicFrame>()
                                                                .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                                .ToList();

                                                    var filteredList = slideChangeGraphic.Take(remainingDataForNextSlide).ToList();

                                                    if (filteredList.Count > 0)
                                                    {
                                                        // less than 4 testnames
                                                        if (filteredList.Count < 4)
                                                        {
                                                            var secondaryGraphicList = filteredList;

                                                            // count 1
                                                            if (secondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 2
                                                            else if (secondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 3
                                                            else if (secondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = secondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // for 4 names
                                                            else if (secondaryCount == 4)
                                                            {
                                                                // do nothing
                                                            }
                                                        }

                                                        //  4 testnames
                                                        else if (filteredList.Count == 4)
                                                        {
                                                            // do nothing
                                                        }

                                                        // 4 and 8 testnames
                                                        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                        {
                                                            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                            if (higherSecondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 971550;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = higherSecondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // 8 testnames
                                                        else if (filteredList.Count == 8)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    else
                                    {
                                        int remainingTertiaryData = 0;

                                        if (tertiaryIndex == 0)
                                        {
                                            var filteredGraphicList = sortedGraphicListTertiary.Skip(startIndex).ToList();
                                            tertiaryIndex = filteredGraphicList.Count;

                                            if (filteredGraphicList.Count > 0)
                                            {
                                                // less than 4 testnames
                                                if (filteredGraphicList.Count < 4)
                                                {
                                                    var secondaryGraphicList = filteredGraphicList;

                                                    // SEPCIAL CASE PRIMARY 0

                                                    if (primaryCount == 0 && secondaryCount < 4)
                                                    {
                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    else
                                                    {
                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }

                                                //  4 testnames
                                                else if (filteredGraphicList.Count == 4)
                                                {
                                                    // do nothing
                                                }

                                                // 4 and 8 testnames
                                                else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                                {
                                                    var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                    if (higherSecondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 971550;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = higherSecondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                                // 8 testnames
                                                else if (filteredGraphicList.Count == 8)
                                                {
                                                    // do nothing
                                                }
                                            }
                                        }
                                        else
                                        {
                                            remainingTertiaryData = tertiaryCategoryList.Count - tertiaryIndex;
                                            tertiaryIndex += remainingTertiaryData;

                                            if (remainingTertiaryData < 8)
                                            {
                                                slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                slide7 = slidePart7?.Slide;

                                                shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                var filteredList = sortedGraphicListTertiary.Take(remainingTertiaryData).ToList();

                                                if (filteredList.Count > 0)
                                                {
                                                    // less than 4 testnames
                                                    if (filteredList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                            else if (remainingTertiaryData == 8)
                                            {
                                                // do nothing for frames
                                                tertiaryIndex += remainingTertiaryData;
                                                slideNumber++;
                                            }
                                            else if (remainingTertiaryData > 8)
                                            {
                                                tertiaryIndex += remainingTertiaryData;

                                                sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();
                                                var remainingDataForNextSlide = remainingTertiaryData - sortedGraphicListTertiary.Count;

                                                if (remainingDataForNextSlide > 0)
                                                {
                                                    slideNumber++;
                                                    slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                    slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                    slide7 = slidePart7?.Slide;

                                                    shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();

                                                    var slideChangeGraphic = shapeTree7?.Elements<P.GraphicFrame>()
                                                                .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                                .ToList();

                                                    var filteredList = slideChangeGraphic.Take(remainingDataForNextSlide).ToList();

                                                    if (filteredList.Count > 0)
                                                    {
                                                        // less than 4 testnames
                                                        if (filteredList.Count < 4)
                                                        {
                                                            var secondaryGraphicList = filteredList;

                                                            // count 1
                                                            if (secondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 2
                                                            else if (secondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 3
                                                            else if (secondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = secondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // for 4 names
                                                            else if (secondaryCount == 4)
                                                            {
                                                                // do nothing
                                                            }
                                                        }

                                                        //  4 testnames
                                                        else if (filteredList.Count == 4)
                                                        {
                                                            // do nothing
                                                        }

                                                        // 4 and 8 testnames
                                                        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                        {
                                                            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                            if (higherSecondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 971550;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = higherSecondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // 8 testnames
                                                        else if (filteredList.Count == 8)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    if (tertiaryIndex < tertiaryCategoryList.Count)
                                    {
                                        slideNumber++;

                                        slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                        slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                        slide7 = slidePart7?.Slide;
                                    }
                                }

                                else if (slideNumber == 1)
                                {
                                    int startIndex = 0;
                                    if (graphicIndexCount > 0)
                                    {
                                        startIndex = graphicIndexCount - 1;
                                    }
                                    else
                                    {
                                        startIndex = 0;
                                    }

                                    if (startIndex == 0)
                                    {
                                        int remainingTertiaryData = 0;

                                        if (tertiaryIndex == 0)
                                        {
                                            var filteredGraphicList = sortedGraphicListTertiary.Skip(startIndex).ToList();
                                            tertiaryIndex = filteredGraphicList.Count;

                                            if (filteredGraphicList.Count > 0)
                                            {
                                                // less than 4 testnames
                                                if (filteredGraphicList.Count < 4)
                                                {
                                                    var secondaryGraphicList = filteredGraphicList;

                                                    // count 1
                                                    if (secondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 2
                                                    else if (secondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 3
                                                    else if (secondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = secondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // for 4 names
                                                    else if (secondaryCount == 4)
                                                    {
                                                        // do nothing
                                                    }
                                                }

                                                //  4 testnames
                                                else if (filteredGraphicList.Count == 4)
                                                {
                                                    // do nothing
                                                }

                                                // 4 and 8 testnames
                                                else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                                {
                                                    var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                    if (higherSecondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 971550;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = higherSecondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                                // 8 testnames
                                                else if (filteredGraphicList.Count == 8)
                                                {
                                                    // do nothing
                                                }
                                            }
                                        }
                                        else
                                        {
                                            remainingTertiaryData = tertiaryCategoryList.Count - tertiaryIndex;
                                            tertiaryIndex = remainingTertiaryData;

                                            if (remainingTertiaryData < 8)
                                            {
                                                slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                slide7 = slidePart7?.Slide;

                                                shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                var filteredList = sortedGraphicListTertiary.Take(remainingTertiaryData).ToList();

                                                if (filteredList.Count > 0)
                                                {
                                                    // less than 4 testnames
                                                    if (filteredList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                            else if (remainingTertiaryData == 8)
                                            {
                                                // do nothing for frames
                                                tertiaryIndex += remainingTertiaryData;
                                                slideNumber++;
                                            }
                                            else if (remainingTertiaryData > 8)
                                            {
                                                tertiaryIndex += remainingTertiaryData;

                                                sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();
                                                var remainingDataForNextSlide = remainingTertiaryData - sortedGraphicListTertiary.Count;

                                                if (remainingDataForNextSlide > 0)
                                                {
                                                    slideNumber++;
                                                    slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                    slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                    slide7 = slidePart7?.Slide;

                                                    shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();

                                                    var slideChangeGraphic = shapeTree7?.Elements<P.GraphicFrame>()
                                                                .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                                .ToList();

                                                    var filteredList = slideChangeGraphic.Take(remainingDataForNextSlide).ToList();

                                                    if (filteredList.Count > 0)
                                                    {
                                                        // less than 4 testnames
                                                        if (filteredList.Count < 4)
                                                        {
                                                            var secondaryGraphicList = filteredList;

                                                            // count 1
                                                            if (secondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 2
                                                            else if (secondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 3
                                                            else if (secondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = secondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // for 4 names
                                                            else if (secondaryCount == 4)
                                                            {
                                                                // do nothing
                                                            }
                                                        }

                                                        //  4 testnames
                                                        else if (filteredList.Count == 4)
                                                        {
                                                            // do nothing
                                                        }

                                                        // 4 and 8 testnames
                                                        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                        {
                                                            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                            if (higherSecondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 971550;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = higherSecondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // 8 testnames
                                                        else if (filteredList.Count == 8)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    else
                                    {
                                        int remainingTertiaryData = 0;

                                        if (tertiaryIndex == 0)
                                        {
                                            var filteredGraphicList = sortedGraphicListTertiary.Skip(startIndex).ToList();
                                            tertiaryIndex = filteredGraphicList.Count;

                                            if (filteredGraphicList.Count > 0)
                                            {
                                                if (startIndex != 0)
                                                {
                                                    if (startIndex >= 2)
                                                    {
                                                        var secondaryGraphicList = filteredGraphicList.ToList();

                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (secondaryGraphicList.Count == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    // less than 4 testnames
                                                    if (filteredGraphicList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredGraphicList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredGraphicList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredGraphicList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }


                                            }
                                        }
                                        else
                                        {
                                            remainingTertiaryData = tertiaryCategoryList.Count - tertiaryIndex;
                                            tertiaryIndex += remainingTertiaryData;

                                            if (remainingTertiaryData < 8)
                                            {
                                                slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                slide7 = slidePart7?.Slide;

                                                shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                var filteredList = sortedGraphicListTertiary.Take(remainingTertiaryData).ToList();

                                                if (filteredList.Count > 0)
                                                {
                                                    // less than 4 testnames
                                                    if (filteredList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                            else if (remainingTertiaryData == 8)
                                            {
                                                // do nothing for frames
                                                tertiaryIndex += remainingTertiaryData;
                                                slideNumber++;
                                            }
                                            else if (remainingTertiaryData > 8)
                                            {
                                                tertiaryIndex += remainingTertiaryData;

                                                sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();
                                                var remainingDataForNextSlide = remainingTertiaryData - sortedGraphicListTertiary.Count;

                                                if (remainingDataForNextSlide > 0)
                                                {
                                                    slideNumber++;
                                                    slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                    slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                    slide7 = slidePart7?.Slide;

                                                    shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();

                                                    var slideChangeGraphic = shapeTree7?.Elements<P.GraphicFrame>()
                                                               .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                               .ToList();

                                                    var filteredList = slideChangeGraphic.Take(remainingDataForNextSlide).ToList();

                                                    if (filteredList.Count > 0)
                                                    {
                                                        // less than 4 testnames
                                                        if (filteredList.Count < 4)
                                                        {
                                                            var secondaryGraphicList = filteredList;

                                                            // count 1
                                                            if (secondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 2
                                                            else if (secondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 3
                                                            else if (secondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = secondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // for 4 names
                                                            else if (secondaryCount == 4)
                                                            {
                                                                // do nothing
                                                            }
                                                        }

                                                        //  4 testnames
                                                        else if (filteredList.Count == 4)
                                                        {
                                                            // do nothing
                                                        }

                                                        // 4 and 8 testnames
                                                        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                        {
                                                            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                            if (higherSecondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 971550;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = higherSecondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // 8 testnames
                                                        else if (filteredList.Count == 8)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    if (tertiaryIndex < tertiaryCategoryList.Count)
                                    {
                                        slideNumber++;

                                        slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                        slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                        slide7 = slidePart7?.Slide;
                                    }
                                }

                                else if (slideNumber == 2)
                                {
                                    int startIndex = 0;
                                    if (graphicIndexCount > 0)
                                    {
                                        startIndex = graphicIndexCount - 1;
                                    }
                                    else
                                    {
                                        startIndex = 0;
                                    }

                                    if (startIndex == 0)
                                    {
                                        int remainingTertiaryData = 0;

                                        if (tertiaryIndex == 0)
                                        {
                                            var filteredGraphicList = sortedGraphicListTertiary.Skip(startIndex).ToList();
                                            tertiaryIndex += filteredGraphicList.Count;

                                            if (filteredGraphicList.Count > 0)
                                            {
                                                // less than 4 testnames
                                                if (filteredGraphicList.Count < 4)
                                                {
                                                    var secondaryGraphicList = filteredGraphicList;

                                                    // count 1
                                                    if (secondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 2
                                                    else if (secondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 3
                                                    else if (secondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = secondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // for 4 names
                                                    else if (secondaryCount == 4)
                                                    {
                                                        // do nothing
                                                    }
                                                }

                                                //  4 testnames
                                                else if (filteredGraphicList.Count == 4)
                                                {
                                                    // do nothing
                                                }

                                                // 4 and 8 testnames
                                                else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                                {
                                                    var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                    if (higherSecondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 971550;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = higherSecondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                                // 8 testnames
                                                else if (filteredGraphicList.Count == 8)
                                                {
                                                    // do nothing
                                                }
                                            }
                                        }
                                        else
                                        {
                                            remainingTertiaryData = tertiaryCategoryList.Count - tertiaryIndex;
                                            //tertiaryIndex += remainingTertiaryData;

                                            if (tertiaryIndex < tertiaryCategoryList.Count)
                                            {

                                                if (remainingTertiaryData >= 8)
                                                {
                                                    // got to > 8 section
                                                }
                                                else
                                                {
                                                    tertiaryIndex += remainingTertiaryData;
                                                }
                                            }

                                            if (remainingTertiaryData < 8)
                                            {
                                                slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                slide7 = slidePart7?.Slide;

                                                shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                var filteredList = sortedGraphicListTertiary.Take(remainingTertiaryData).ToList();

                                                if (filteredList.Count > 0)
                                                {
                                                    // less than 4 testnames
                                                    if (filteredList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                            else if (remainingTertiaryData == 8)
                                            {
                                                // do nothing for frames
                                                //tertiaryIndex += remainingTertiaryData;

                                                //if (tertiaryIndex < tertiaryCategoryList.Count)
                                                //{
                                                //    tertiaryIndex += remainingTertiaryData;
                                                //}

                                                //slideNumber++;
                                            }
                                            else if (remainingTertiaryData > 8)
                                            {
                                                sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();
                                                var remainingDataForNextSlide = remainingTertiaryData - sortedGraphicListTertiary.Count;

                                                if (tertiaryIndex < tertiaryCategoryList.Count)
                                                {
                                                    tertiaryIndex += 8;
                                                }

                                                //if (remainingDataForNextSlide > 0)
                                                //{
                                                //    slideNumber++;
                                                //    slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                //    slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                //    slide7 = slidePart7?.Slide;
                                                //    shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();

                                                //    var slideChangeGraphic = shapeTree7?.Elements<P.GraphicFrame>()
                                                //               .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                //               .ToList();

                                                //    var filteredList = slideChangeGraphic.Take(remainingDataForNextSlide).OrderBy(x => x.InnerText).ToList();

                                                //    if(filteredList.Count < 8)
                                                //    {
                                                //        tertiaryIndex += filteredList.Count;
                                                //    }

                                                //    if (filteredList.Count > 0)
                                                //    {
                                                //        // less than 4 testnames
                                                //        if (filteredList.Count < 4)
                                                //        {
                                                //            var secondaryGraphicList = filteredList;

                                                //            // count 1
                                                //            if (secondaryGraphicList.Count == 1)
                                                //            {
                                                //                var graphic1 = secondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform1 != null)
                                                //                    {
                                                //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                //                        if (offset1 != null)
                                                //                        {
                                                //                            offset1.X = 4827536;
                                                //                            offset1.Y = 872561;
                                                //                        }
                                                //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                //                        if (extents1 != null)
                                                //                        {
                                                //                            extents1.Cx = 2536928;
                                                //                            extents1.Cy = 979170;
                                                //                        }
                                                //                    }
                                                //                }
                                                //            }

                                                //            // count 2
                                                //            else if (secondaryGraphicList.Count == 2)
                                                //            {
                                                //                var graphic1 = secondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform1 != null)
                                                //                    {
                                                //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                //                        if (offset1 != null)
                                                //                        {
                                                //                            offset1.X = 2372715;
                                                //                            offset1.Y = 872561;
                                                //                        }
                                                //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                //                        if (extents1 != null)
                                                //                        {
                                                //                            extents1.Cx = 2536928;
                                                //                            extents1.Cy = 788670;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic2 = secondaryGraphicList[1];
                                                //                if (graphic2 != null)
                                                //                {
                                                //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 7282358;
                                                //                            offset.Y = 872561;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 971550;
                                                //                        }
                                                //                    }
                                                //                }
                                                //            }

                                                //            // count 3
                                                //            else if (secondaryGraphicList.Count == 3)
                                                //            {
                                                //                var graphic1 = secondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 1145304;
                                                //                            offset.Y = 872561;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 1169670;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic2 = secondaryGraphicList[1];
                                                //                if (graphic2 != null)
                                                //                {
                                                //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 4827536;
                                                //                            offset.Y = 872561;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 979170;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic3 = secondaryGraphicList[2];
                                                //                if (graphic3 != null)
                                                //                {
                                                //                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 8509768;
                                                //                            offset.Y = 872561;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 979170;
                                                //                        }
                                                //                    }
                                                //                }
                                                //            }

                                                //            // for 4 names
                                                //            else if (secondaryCount == 4)
                                                //            {
                                                //                // do nothing
                                                //                slidePart7.Slide.Save();
                                                //            }
                                                //        }

                                                //        //  4 testnames
                                                //        else if (filteredList.Count == 4)
                                                //        {
                                                //            // do nothing
                                                //            slidePart7.Slide.Save();
                                                //        }

                                                //        // 4 and 8 testnames
                                                //        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                //        {
                                                //            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                //            if (higherSecondaryGraphicList.Count == 1)
                                                //            {
                                                //                var graphic1 = higherSecondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform1 != null)
                                                //                    {
                                                //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                //                        if (offset1 != null)
                                                //                        {
                                                //                            offset1.X = 4827536;
                                                //                            offset1.Y = 3596711;
                                                //                        }
                                                //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                //                        if (extents1 != null)
                                                //                        {
                                                //                            extents1.Cx = 2536928;
                                                //                            extents1.Cy = 788670;
                                                //                        }
                                                //                    }
                                                //                }
                                                //                slidePart7.Slide.Save();
                                                //            }

                                                //            else if (higherSecondaryGraphicList.Count == 2)
                                                //            {
                                                //                var graphic1 = higherSecondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform1 != null)
                                                //                    {
                                                //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                //                        if (offset1 != null)
                                                //                        {
                                                //                            offset1.X = 2372715;
                                                //                            offset1.Y = 3596711;
                                                //                        }
                                                //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                //                        if (extents1 != null)
                                                //                        {
                                                //                            extents1.Cx = 2536928;
                                                //                            extents1.Cy = 971550;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic2 = higherSecondaryGraphicList[1];
                                                //                if (graphic2 != null)
                                                //                {
                                                //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 7282358;
                                                //                            offset.Y = 3596711;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 971550;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                slidePart7.Slide.Save();
                                                //            }

                                                //            else if (higherSecondaryGraphicList.Count == 3)
                                                //            {
                                                //                var graphic1 = higherSecondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 1145304;
                                                //                            offset.Y = 3596711;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 788670;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic2 = higherSecondaryGraphicList[1];
                                                //                if (graphic2 != null)
                                                //                {
                                                //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 4827536;
                                                //                            offset.Y = 3596711;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 979170;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic3 = higherSecondaryGraphicList[2];
                                                //                if (graphic3 != null)
                                                //                {
                                                //                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 8509768;
                                                //                            offset.Y = 3596711;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 1169670;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                slidePart7.Slide.Save();
                                                //            }
                                                //        }

                                                //        // 8 testnames
                                                //        else if (filteredList.Count == 8)
                                                //        {
                                                //            // do nothing
                                                //        }
                                                //    }
                                                //    slidePart7.Slide.Save();
                                                //}
                                            }
                                        }
                                    }
                                    else
                                    {
                                        int remainingTertiaryData = 0;

                                        if (tertiaryIndex == 0)
                                        {
                                            var filteredGraphicList = sortedGraphicListTertiary.Skip(startIndex).ToList();
                                            tertiaryIndex = filteredGraphicList.Count;

                                            if (filteredGraphicList.Count > 0)
                                            {
                                                // less than 4 testnames
                                                if (filteredGraphicList.Count < 4)
                                                {
                                                    if (sortedGraphicListTertiary.Count > 4)
                                                    {
                                                        var secondaryGraphicList = filteredGraphicList;

                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        var secondaryGraphicList = filteredGraphicList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }

                                                //  4 testnames
                                                else if (filteredGraphicList.Count == 4)
                                                {
                                                    // do nothing
                                                }

                                                // 4 and 8 testnames
                                                else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                                {
                                                    var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                    if (higherSecondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 971550;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = higherSecondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                                // 8 testnames
                                                else if (filteredGraphicList.Count == 8)
                                                {
                                                    // do nothing
                                                }
                                            }
                                        }
                                        else
                                        {
                                            remainingTertiaryData = tertiaryCategoryList.Count - tertiaryIndex;
                                            //tertiaryIndex += remainingTertiaryData;

                                            if (tertiaryIndex < tertiaryCategoryList.Count)
                                            {
                                                tertiaryIndex += remainingTertiaryData;
                                            }

                                            if (remainingTertiaryData < 8)
                                            {
                                                slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                slide7 = slidePart7?.Slide;

                                                shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                var filteredList = sortedGraphicListTertiary.Take(remainingTertiaryData).ToList();

                                                if (filteredList.Count > 0)
                                                {
                                                    // less than 4 testnames
                                                    if (filteredList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                            else if (remainingTertiaryData == 8)
                                            {
                                                // do nothing for frames
                                                //tertiaryIndex += remainingTertiaryData;

                                                if (tertiaryIndex < tertiaryCategoryList.Count)
                                                {
                                                    tertiaryIndex += remainingTertiaryData;
                                                }

                                                slideNumber++;
                                            }
                                            else if (remainingTertiaryData > 8)
                                            {
                                                if (tertiaryIndex < tertiaryCategoryList.Count)
                                                {
                                                    tertiaryIndex += remainingTertiaryData;
                                                }

                                                //sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();
                                                //var remainingDataForNextSlide = remainingTertiaryData - sortedGraphicListTertiary.Count;

                                                //if (remainingDataForNextSlide > 0)
                                                //{
                                                //    slideNumber++;
                                                //    slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                //    slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                //    slide7 = slidePart7?.Slide;

                                                //    shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();

                                                //    var slideChangeGraphic = shapeTree7?.Elements<P.GraphicFrame>()
                                                //               .Where(frame => frame.Descendants<A.Text>().FirstOrDefault().Text.StartsWith("TESTNAME"))
                                                //               .ToList();

                                                //    var filteredList = slideChangeGraphic.Take(remainingDataForNextSlide).ToList();

                                                //    if (filteredList.Count > 0)
                                                //    {
                                                //        // less than 4 testnames
                                                //        if (filteredList.Count < 4)
                                                //        {
                                                //            var secondaryGraphicList = filteredList;

                                                //            // count 1
                                                //            if (secondaryGraphicList.Count == 1)
                                                //            {
                                                //                var graphic1 = secondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform1 != null)
                                                //                    {
                                                //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                //                        if (offset1 != null)
                                                //                        {
                                                //                            offset1.X = 4827536;
                                                //                            offset1.Y = 872561;
                                                //                        }
                                                //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                //                        if (extents1 != null)
                                                //                        {
                                                //                            extents1.Cx = 2536928;
                                                //                            extents1.Cy = 979170;
                                                //                        }
                                                //                    }
                                                //                }
                                                //            }

                                                //            // count 2
                                                //            else if (secondaryGraphicList.Count == 2)
                                                //            {
                                                //                var graphic1 = secondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform1 != null)
                                                //                    {
                                                //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                //                        if (offset1 != null)
                                                //                        {
                                                //                            offset1.X = 2372715;
                                                //                            offset1.Y = 872561;
                                                //                        }
                                                //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                //                        if (extents1 != null)
                                                //                        {
                                                //                            extents1.Cx = 2536928;
                                                //                            extents1.Cy = 788670;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic2 = secondaryGraphicList[1];
                                                //                if (graphic2 != null)
                                                //                {
                                                //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 7282358;
                                                //                            offset.Y = 872561;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 971550;
                                                //                        }
                                                //                    }
                                                //                }
                                                //            }

                                                //            // count 3
                                                //            else if (secondaryGraphicList.Count == 3)
                                                //            {
                                                //                var graphic1 = secondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 1145304;
                                                //                            offset.Y = 872561;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 1169670;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic2 = secondaryGraphicList[1];
                                                //                if (graphic2 != null)
                                                //                {
                                                //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 4827536;
                                                //                            offset.Y = 872561;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 979170;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic3 = secondaryGraphicList[2];
                                                //                if (graphic3 != null)
                                                //                {
                                                //                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 8509768;
                                                //                            offset.Y = 872561;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 979170;
                                                //                        }
                                                //                    }
                                                //                }
                                                //            }

                                                //            // for 4 names
                                                //            else if (secondaryCount == 4)
                                                //            {
                                                //                // do nothing
                                                //            }
                                                //        }

                                                //        //  4 testnames
                                                //        else if (filteredList.Count == 4)
                                                //        {
                                                //            // do nothing
                                                //        }

                                                //        // 4 and 8 testnames
                                                //        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                //        {
                                                //            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                //            if (higherSecondaryGraphicList.Count == 1)
                                                //            {
                                                //                var graphic1 = higherSecondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform1 != null)
                                                //                    {
                                                //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                //                        if (offset1 != null)
                                                //                        {
                                                //                            offset1.X = 4827536;
                                                //                            offset1.Y = 3596711;
                                                //                        }
                                                //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                //                        if (extents1 != null)
                                                //                        {
                                                //                            extents1.Cx = 2536928;
                                                //                            extents1.Cy = 788670;
                                                //                        }
                                                //                    }
                                                //                }
                                                //            }

                                                //            else if (higherSecondaryGraphicList.Count == 2)
                                                //            {
                                                //                var graphic1 = higherSecondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform1 != null)
                                                //                    {
                                                //                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                //                        if (offset1 != null)
                                                //                        {
                                                //                            offset1.X = 2372715;
                                                //                            offset1.Y = 3596711;
                                                //                        }
                                                //                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                //                        if (extents1 != null)
                                                //                        {
                                                //                            extents1.Cx = 2536928;
                                                //                            extents1.Cy = 971550;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic2 = higherSecondaryGraphicList[1];
                                                //                if (graphic2 != null)
                                                //                {
                                                //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 7282358;
                                                //                            offset.Y = 3596711;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 971550;
                                                //                        }
                                                //                    }
                                                //                }
                                                //            }

                                                //            else if (higherSecondaryGraphicList.Count == 3)
                                                //            {
                                                //                var graphic1 = higherSecondaryGraphicList[0];
                                                //                if (graphic1 != null)
                                                //                {
                                                //                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 1145304;
                                                //                            offset.Y = 3596711;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 788670;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic2 = higherSecondaryGraphicList[1];
                                                //                if (graphic2 != null)
                                                //                {
                                                //                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 4827536;
                                                //                            offset.Y = 3596711;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 979170;
                                                //                        }
                                                //                    }
                                                //                }

                                                //                var graphic3 = higherSecondaryGraphicList[2];
                                                //                if (graphic3 != null)
                                                //                {
                                                //                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                //                    if (transform != null)
                                                //                    {
                                                //                        var offset = transform.GetFirstChild<A.Offset>();
                                                //                        if (offset != null)
                                                //                        {
                                                //                            offset.X = 8509768;
                                                //                            offset.Y = 3596711;
                                                //                        }
                                                //                        var extents = transform.GetFirstChild<A.Extents>();
                                                //                        if (extents != null)
                                                //                        {
                                                //                            extents.Cx = 2536928;
                                                //                            extents.Cy = 1169670;
                                                //                        }
                                                //                    }
                                                //                }
                                                //            }
                                                //        }

                                                //        // 8 testnames
                                                //        else if (filteredList.Count == 8)
                                                //        {
                                                //            // do nothing
                                                //        }
                                                //    }
                                                //}
                                            }
                                        }
                                    }

                                    //removed code started here

                                    if (tertiaryIndex < tertiaryCategoryList.Count)
                                    {
                                        slideNumber++;

                                        slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                        slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                        slide7 = slidePart7?.Slide;
                                    }
                                }

                                else if (slideNumber == 3)
                                {
                                    int startIndex = 0;
                                    if (graphicIndexCount > 0)
                                    {
                                        startIndex = graphicIndexCount - 1;
                                    }
                                    else
                                    {
                                        startIndex = 0;
                                    }

                                    if (startIndex == 0)
                                    {
                                        int remainingTertiaryData = 0;

                                        if (tertiaryIndex == 0)
                                        {
                                            var filteredGraphicList = sortedGraphicListTertiary.Skip(startIndex).ToList();
                                            tertiaryIndex += filteredGraphicList.Count;

                                            if (filteredGraphicList.Count > 0)
                                            {
                                                // less than 4 testnames
                                                if (filteredGraphicList.Count < 4)
                                                {
                                                    var secondaryGraphicList = filteredGraphicList;

                                                    // count 1
                                                    if (secondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 2
                                                    else if (secondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 3
                                                    else if (secondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = secondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // for 4 names
                                                    else if (secondaryCount == 4)
                                                    {
                                                        // do nothing
                                                    }
                                                }

                                                //  4 testnames
                                                else if (filteredGraphicList.Count == 4)
                                                {
                                                    // do nothing
                                                }

                                                // 4 and 8 testnames
                                                else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                                {
                                                    var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                    if (higherSecondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 971550;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = higherSecondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                                // 8 testnames
                                                else if (filteredGraphicList.Count == 8)
                                                {
                                                    // do nothing
                                                }
                                            }
                                        }
                                        else
                                        {
                                            remainingTertiaryData = tertiaryCategoryList.Count - tertiaryIndex;
                                            tertiaryIndex += remainingTertiaryData;

                                            if (remainingTertiaryData < 8)
                                            {
                                                slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                slide7 = slidePart7?.Slide;

                                                shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                var filteredList = sortedGraphicListTertiary.Take(remainingTertiaryData).ToList();

                                                if (filteredList.Count > 0)
                                                {
                                                    // less than 4 testnames
                                                    if (filteredList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                            else if (remainingTertiaryData == 8)
                                            {
                                                // do nothing for frames
                                                tertiaryIndex += remainingTertiaryData;
                                                slideNumber++;
                                            }
                                            else if (remainingTertiaryData > 8)
                                            {
                                                tertiaryIndex += remainingTertiaryData;

                                                sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();
                                                var remainingDataForNextSlide = remainingTertiaryData - sortedGraphicListTertiary.Count;

                                                if (remainingDataForNextSlide > 0)
                                                {
                                                    slideNumber++;
                                                    slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                    slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                    slide7 = slidePart7?.Slide;

                                                    shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                    var filteredList = sortedGraphicListTertiary.Take(remainingDataForNextSlide).ToList();

                                                    if (filteredList.Count > 0)
                                                    {
                                                        // less than 4 testnames
                                                        if (filteredList.Count < 4)
                                                        {
                                                            var secondaryGraphicList = filteredList;

                                                            // count 1
                                                            if (secondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 2
                                                            else if (secondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 3
                                                            else if (secondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = secondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // for 4 names
                                                            else if (secondaryCount == 4)
                                                            {
                                                                // do nothing
                                                            }
                                                        }

                                                        //  4 testnames
                                                        else if (filteredList.Count == 4)
                                                        {
                                                            // do nothing
                                                        }

                                                        // 4 and 8 testnames
                                                        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                        {
                                                            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                            if (higherSecondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 971550;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = higherSecondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // 8 testnames
                                                        else if (filteredList.Count == 8)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    else
                                    {
                                        int remainingTertiaryData = 0;

                                        if (tertiaryIndex == 0)
                                        {
                                            var filteredGraphicList = sortedGraphicListTertiary.Skip(startIndex).ToList();
                                            tertiaryIndex = filteredGraphicList.Count;

                                            if (filteredGraphicList.Count > 0)
                                            {
                                                if (startIndex > 0 && startIndex < 4)
                                                {
                                                    // change coordinates
                                                    // less than 4 testnames
                                                    if (filteredGraphicList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredGraphicList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    // less than 4 testnames
                                                    if (filteredGraphicList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredGraphicList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                    }

                                                    //  4 testnames
                                                    else if (filteredGraphicList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredGraphicList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                        }
                                        else
                                        {
                                            remainingTertiaryData = tertiaryCategoryList.Count - tertiaryIndex;
                                            tertiaryIndex += remainingTertiaryData;

                                            if (remainingTertiaryData < 8)
                                            {
                                                slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                slide7 = slidePart7?.Slide;

                                                shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                var filteredList = sortedGraphicListTertiary.Take(remainingTertiaryData).ToList();

                                                if (filteredList.Count > 0)
                                                {
                                                    // less than 4 testnames
                                                    if (filteredList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                            else if (remainingTertiaryData == 8)
                                            {
                                                // do nothing for frames
                                                tertiaryIndex += remainingTertiaryData;
                                                slideNumber++;
                                            }
                                            else if (remainingTertiaryData > 8)
                                            {
                                                tertiaryIndex += remainingTertiaryData;

                                                sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();
                                                var remainingDataForNextSlide = remainingTertiaryData - sortedGraphicListTertiary.Count;

                                                if (remainingDataForNextSlide > 0)
                                                {
                                                    //slideNumber++;
                                                    //slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                    //slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                    //slide7 = slidePart7?.Slide;

                                                    shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                    var filteredList = sortedGraphicListTertiary.Take(remainingDataForNextSlide).ToList();

                                                    if (filteredList.Count > 0)
                                                    {
                                                        // less than 4 testnames
                                                        if (filteredList.Count < 4)
                                                        {
                                                            var secondaryGraphicList = filteredList;

                                                            // count 1
                                                            if (secondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 2
                                                            else if (secondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 3
                                                            else if (secondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = secondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // for 4 names
                                                            else if (secondaryCount == 4)
                                                            {
                                                                // do nothing
                                                            }
                                                        }

                                                        //  4 testnames
                                                        else if (filteredList.Count == 4)
                                                        {
                                                            // do nothing
                                                        }

                                                        // 4 and 8 testnames
                                                        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                        {
                                                            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                            if (higherSecondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 971550;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = higherSecondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // 8 testnames
                                                        else if (filteredList.Count == 8)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    if (tertiaryIndex < tertiaryCategoryList.Count)
                                    {
                                        slideNumber++;

                                        slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                        slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                        slide7 = slidePart7?.Slide;
                                    }
                                }

                                else if (slideNumber == 4)
                                {
                                    int startIndex = 0;
                                    if (graphicIndexCount > 0)
                                    {
                                        startIndex = graphicIndexCount - 1;
                                    }
                                    else
                                    {
                                        startIndex = 0;
                                    }

                                    if (startIndex == 0)
                                    {
                                        int remainingTertiaryData = 0;

                                        if (tertiaryIndex == 0)
                                        {
                                            var filteredGraphicList = sortedGraphicListTertiary.Skip(startIndex).ToList();
                                            tertiaryIndex = filteredGraphicList.Count;

                                            if (filteredGraphicList.Count > 0)
                                            {
                                                // less than 4 testnames
                                                if (filteredGraphicList.Count < 4)
                                                {
                                                    var secondaryGraphicList = filteredGraphicList;

                                                    // count 1
                                                    if (secondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 2
                                                    else if (secondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 3
                                                    else if (secondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = secondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // for 4 names
                                                    else if (secondaryCount == 4)
                                                    {
                                                        // do nothing
                                                    }
                                                }

                                                //  4 testnames
                                                else if (filteredGraphicList.Count == 4)
                                                {
                                                    // do nothing
                                                }

                                                // 4 and 8 testnames
                                                else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                                {
                                                    var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                    if (higherSecondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 971550;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = higherSecondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                                // 8 testnames
                                                else if (filteredGraphicList.Count == 8)
                                                {
                                                    // do nothing
                                                }
                                            }
                                        }
                                        else
                                        {
                                            remainingTertiaryData = tertiaryCategoryList.Count - tertiaryIndex;
                                            tertiaryIndex = remainingTertiaryData;

                                            if (remainingTertiaryData < 8)
                                            {
                                                slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                slide7 = slidePart7?.Slide;

                                                shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                var filteredList = sortedGraphicListTertiary.Take(remainingTertiaryData).ToList();

                                                if (filteredList.Count > 0)
                                                {
                                                    // less than 4 testnames
                                                    if (filteredList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                            else if (remainingTertiaryData == 8)
                                            {
                                                // do nothing for frames
                                                tertiaryIndex += remainingTertiaryData;
                                                slideNumber++;
                                            }
                                            else if (remainingTertiaryData > 8)
                                            {
                                                tertiaryIndex += remainingTertiaryData;

                                                sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();
                                                var remainingDataForNextSlide = remainingTertiaryData - sortedGraphicListTertiary.Count;

                                                if (remainingDataForNextSlide > 0)
                                                {
                                                    slideNumber++;
                                                    slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                    slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                    slide7 = slidePart7?.Slide;

                                                    shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                    var filteredList = sortedGraphicListTertiary.Take(remainingDataForNextSlide).ToList();

                                                    if (filteredList.Count > 0)
                                                    {
                                                        // less than 4 testnames
                                                        if (filteredList.Count < 4)
                                                        {
                                                            var secondaryGraphicList = filteredList;

                                                            // count 1
                                                            if (secondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 2
                                                            else if (secondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 3
                                                            else if (secondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = secondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // for 4 names
                                                            else if (secondaryCount == 4)
                                                            {
                                                                // do nothing
                                                            }
                                                        }

                                                        //  4 testnames
                                                        else if (filteredList.Count == 4)
                                                        {
                                                            // do nothing
                                                        }

                                                        // 4 and 8 testnames
                                                        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                        {
                                                            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                            if (higherSecondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 971550;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = higherSecondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // 8 testnames
                                                        else if (filteredList.Count == 8)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    else
                                    {
                                        int remainingTertiaryData = 0;

                                        if (tertiaryIndex == 0)
                                        {
                                            var filteredGraphicList = sortedGraphicListTertiary.Skip(startIndex).ToList();
                                            tertiaryIndex = filteredGraphicList.Count;

                                            if (filteredGraphicList.Count > 0)
                                            {
                                                // less than 4 testnames
                                                if (filteredGraphicList.Count < 4)
                                                {
                                                    var secondaryGraphicList = filteredGraphicList;

                                                    // count 1
                                                    if (secondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 2
                                                    else if (secondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 872561;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // count 3
                                                    else if (secondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = secondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = secondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = secondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 872561;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // for 4 names
                                                    else if (secondaryCount == 4)
                                                    {
                                                        // do nothing
                                                    }
                                                }

                                                //  4 testnames
                                                else if (filteredGraphicList.Count == 4)
                                                {
                                                    // do nothing
                                                }

                                                // 4 and 8 testnames
                                                else if (filteredGraphicList.Count > 4 && filteredGraphicList.Count < 8)
                                                {
                                                    var higherSecondaryGraphicList = filteredGraphicList.Skip(4).ToList();

                                                    if (higherSecondaryGraphicList.Count == 1)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 4827536;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 788670;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 2)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform1 != null)
                                                            {
                                                                var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                if (offset1 != null)
                                                                {
                                                                    offset1.X = 2372715;
                                                                    offset1.Y = 3596711;
                                                                }
                                                                var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                if (extents1 != null)
                                                                {
                                                                    extents1.Cx = 2536928;
                                                                    extents1.Cy = 971550;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 7282358;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 971550;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    else if (higherSecondaryGraphicList.Count == 3)
                                                    {
                                                        var graphic1 = higherSecondaryGraphicList[0];
                                                        if (graphic1 != null)
                                                        {
                                                            var transform = graphic1.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 1145304;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 788670;
                                                                }
                                                            }
                                                        }

                                                        var graphic2 = higherSecondaryGraphicList[1];
                                                        if (graphic2 != null)
                                                        {
                                                            var transform = graphic2.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 4827536;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 979170;
                                                                }
                                                            }
                                                        }

                                                        var graphic3 = higherSecondaryGraphicList[2];
                                                        if (graphic3 != null)
                                                        {
                                                            var transform = graphic3.GetFirstChild<P.Transform>();
                                                            if (transform != null)
                                                            {
                                                                var offset = transform.GetFirstChild<A.Offset>();
                                                                if (offset != null)
                                                                {
                                                                    offset.X = 8509768;
                                                                    offset.Y = 3596711;
                                                                }
                                                                var extents = transform.GetFirstChild<A.Extents>();
                                                                if (extents != null)
                                                                {
                                                                    extents.Cx = 2536928;
                                                                    extents.Cy = 1169670;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                                // 8 testnames
                                                else if (filteredGraphicList.Count == 8)
                                                {
                                                    // do nothing
                                                }
                                            }
                                        }
                                        else
                                        {
                                            remainingTertiaryData = tertiaryCategoryList.Count - tertiaryIndex;
                                            tertiaryIndex += remainingTertiaryData;

                                            if (remainingTertiaryData < 8)
                                            {
                                                slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                slide7 = slidePart7?.Slide;

                                                shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                var filteredList = sortedGraphicListTertiary.Take(remainingTertiaryData).ToList();

                                                if (filteredList.Count > 0)
                                                {
                                                    // less than 4 testnames
                                                    if (filteredList.Count < 4)
                                                    {
                                                        var secondaryGraphicList = filteredList;

                                                        // count 1
                                                        if (secondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 2
                                                        else if (secondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 872561;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // count 3
                                                        else if (secondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = secondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = secondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = secondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 872561;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // for 4 names
                                                        else if (secondaryCount == 4)
                                                        {
                                                            // do nothing
                                                        }
                                                    }

                                                    //  4 testnames
                                                    else if (filteredList.Count == 4)
                                                    {
                                                        // do nothing
                                                    }

                                                    // 4 and 8 testnames
                                                    else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                    {
                                                        var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                        if (higherSecondaryGraphicList.Count == 1)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 4827536;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 788670;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 2)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform1 != null)
                                                                {
                                                                    var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                    if (offset1 != null)
                                                                    {
                                                                        offset1.X = 2372715;
                                                                        offset1.Y = 3596711;
                                                                    }
                                                                    var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                    if (extents1 != null)
                                                                    {
                                                                        extents1.Cx = 2536928;
                                                                        extents1.Cy = 971550;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 7282358;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 971550;
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        else if (higherSecondaryGraphicList.Count == 3)
                                                        {
                                                            var graphic1 = higherSecondaryGraphicList[0];
                                                            if (graphic1 != null)
                                                            {
                                                                var transform = graphic1.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 1145304;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 788670;
                                                                    }
                                                                }
                                                            }

                                                            var graphic2 = higherSecondaryGraphicList[1];
                                                            if (graphic2 != null)
                                                            {
                                                                var transform = graphic2.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 4827536;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 979170;
                                                                    }
                                                                }
                                                            }

                                                            var graphic3 = higherSecondaryGraphicList[2];
                                                            if (graphic3 != null)
                                                            {
                                                                var transform = graphic3.GetFirstChild<P.Transform>();
                                                                if (transform != null)
                                                                {
                                                                    var offset = transform.GetFirstChild<A.Offset>();
                                                                    if (offset != null)
                                                                    {
                                                                        offset.X = 8509768;
                                                                        offset.Y = 3596711;
                                                                    }
                                                                    var extents = transform.GetFirstChild<A.Extents>();
                                                                    if (extents != null)
                                                                    {
                                                                        extents.Cx = 2536928;
                                                                        extents.Cy = 1169670;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    // 8 testnames
                                                    else if (filteredList.Count == 8)
                                                    {
                                                        // do nothing
                                                    }
                                                }
                                            }
                                            else if (remainingTertiaryData == 8)
                                            {
                                                // do nothing for frames
                                                tertiaryIndex += remainingTertiaryData;
                                                slideNumber++;
                                            }
                                            else if (remainingTertiaryData > 8)
                                            {
                                                tertiaryIndex += remainingTertiaryData;

                                                sortedGraphicListTertiary = graphicFramesTertiary?.OrderBy(x => x.InnerText).ToList();
                                                var remainingDataForNextSlide = remainingTertiaryData - sortedGraphicListTertiary.Count;

                                                if (remainingDataForNextSlide > 0)
                                                {
                                                    slideNumber++;
                                                    slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                                    slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                                    slide7 = slidePart7?.Slide;

                                                    shapeTree7 = slide7?.CommonSlideData.GetFirstChild<ShapeTree>();
                                                    var filteredList = sortedGraphicListTertiary.Take(remainingDataForNextSlide).ToList();

                                                    if (filteredList.Count > 0)
                                                    {
                                                        // less than 4 testnames
                                                        if (filteredList.Count < 4)
                                                        {
                                                            var secondaryGraphicList = filteredList;

                                                            // count 1
                                                            if (secondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 2
                                                            else if (secondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 872561;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // count 3
                                                            else if (secondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = secondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = secondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = secondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 872561;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            // for 4 names
                                                            else if (secondaryCount == 4)
                                                            {
                                                                // do nothing
                                                            }
                                                        }

                                                        //  4 testnames
                                                        else if (filteredList.Count == 4)
                                                        {
                                                            // do nothing
                                                        }

                                                        // 4 and 8 testnames
                                                        else if (filteredList.Count > 4 && filteredList.Count < 8)
                                                        {
                                                            var higherSecondaryGraphicList = filteredList.Skip(4).ToList();

                                                            if (higherSecondaryGraphicList.Count == 1)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 4827536;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 788670;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 2)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform1 = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform1 != null)
                                                                    {
                                                                        var offset1 = transform1.GetFirstChild<A.Offset>();
                                                                        if (offset1 != null)
                                                                        {
                                                                            offset1.X = 2372715;
                                                                            offset1.Y = 3596711;
                                                                        }
                                                                        var extents1 = transform1.GetFirstChild<A.Extents>();
                                                                        if (extents1 != null)
                                                                        {
                                                                            extents1.Cx = 2536928;
                                                                            extents1.Cy = 971550;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 7282358;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 971550;
                                                                        }
                                                                    }
                                                                }
                                                            }

                                                            else if (higherSecondaryGraphicList.Count == 3)
                                                            {
                                                                var graphic1 = higherSecondaryGraphicList[0];
                                                                if (graphic1 != null)
                                                                {
                                                                    var transform = graphic1.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 1145304;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 788670;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic2 = higherSecondaryGraphicList[1];
                                                                if (graphic2 != null)
                                                                {
                                                                    var transform = graphic2.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 4827536;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 979170;
                                                                        }
                                                                    }
                                                                }

                                                                var graphic3 = higherSecondaryGraphicList[2];
                                                                if (graphic3 != null)
                                                                {
                                                                    var transform = graphic3.GetFirstChild<P.Transform>();
                                                                    if (transform != null)
                                                                    {
                                                                        var offset = transform.GetFirstChild<A.Offset>();
                                                                        if (offset != null)
                                                                        {
                                                                            offset.X = 8509768;
                                                                            offset.Y = 3596711;
                                                                        }
                                                                        var extents = transform.GetFirstChild<A.Extents>();
                                                                        if (extents != null)
                                                                        {
                                                                            extents.Cx = 2536928;
                                                                            extents.Cy = 1169670;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }

                                                        // 8 testnames
                                                        else if (filteredList.Count == 8)
                                                        {
                                                            // do nothing
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    if (tertiaryIndex < tertiaryCategoryList.Count)
                                    {
                                        slideNumber++;

                                        slideId7 = slideIdList?.ChildElements[slideNumber] as SlideId;
                                        slidePart7 = (SlidePart)presentationDocument?.PresentationPart.GetPartById(slideId7.RelationshipId);
                                        slide7 = slidePart7?.Slide;
                                    }
                                }

                                slidePart7.Slide.Save();
                            }

                            slidePart6.Slide.Save();
                            slidePart.Slide.Save();
                        }

                        // start of API Data
                        var slideIdList2 = presentationDocument.PresentationPart.Presentation.SlideIdList;

                        int dataIndex = 0;
                        int slideIndex = 0;

                        bool isSlideUsed = false;
                        var slidesToDelete = new List<SlidePart>();

                        while (dataIndex < groupApiData.Count && slideIndex < slideIdList.Count())
                        {
                            SlideId slideId = slideIdList.ChildElements[slideIndex] as SlideId;
                            SlidePart slidePart = (SlidePart)presentationDocument.PresentationPart.GetPartById(slideId.RelationshipId);

                            Slide slide = slidePart.Slide;
                            CommonSlideData commonSlideData = slide.GetFirstChild<CommonSlideData>();
                            ShapeTree shapeTree = commonSlideData.GetFirstChild<ShapeTree>();

                            var graphicFrameList = shapeTree.Elements<P.GraphicFrame>()
                                            .OrderBy(frame => frame.Descendants<A.Text>().FirstOrDefault()?.Text).ToList();

                            isSlideUsed = false;
                            int frameIndex = 0;

                            while (dataIndex < groupApiData.Count && frameIndex < graphicFrameList.Count)
                            {
                                var testNameGroup = groupApiData[dataIndex];
                                var testNameData = testNameGroup;

                                var graphicFrameContent = graphicFrameList[frameIndex];
                                var graphic = graphicFrameContent.GetFirstChild<A.Graphic>();

                                string color = string.Empty;

                                color = $"#{(int)testNameData?.intRed:X2}{(int)testNameData?.intGreen:X2}{(int)testNameData?.intBlue:X2}";

                                foreach (var graphicData in graphic.Elements<A.GraphicData>())
                                {
                                    A.Table table = graphicData.GetFirstChild<A.Table>();
                                    if (table == null) continue;

                                    int rowIndex = 0;
                                    int placeholderIndex = 0;

                                    foreach (var row in table.Elements<A.TableRow>())
                                    {
                                        var cells = row.Elements<A.TableCell>().ToList();

                                        if (rowIndex == 0)
                                        {
                                            UpdateCellContentForSALA(cells[0], testNameData?.strTestName ?? "", color);
                                        }
                                        else if (rowIndex == 1)
                                        {
                                            // No changes needed; skip or retain existing data
                                        }
                                        else
                                        {
                                            List<string> drugNames = new List<string>();

                                            if (testNameData.strDrugName0 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName0);
                                            }
                                            if (testNameData.strDrugName1 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName1);
                                            }
                                            if (testNameData.strDrugName2 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName2);
                                            }
                                            if (testNameData.strDrugName3 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName3);
                                            }
                                            if (testNameData.strDrugName4 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName4);
                                            }
                                            if (testNameData.strDrugName5 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName5);
                                            }
                                            if (testNameData.strDrugName6 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName6);
                                            }
                                            if (testNameData.strDrugName7 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName7);
                                            }
                                            if (testNameData.strDrugName8 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName8);
                                            }
                                            if (testNameData.strDrugName9 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName9);
                                            }
                                            if (testNameData.strDrugName10 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName10);
                                            }
                                            if (testNameData.strDrugName11 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName11);
                                            }
                                            if (testNameData.strDrugName12 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName12);
                                            }
                                            if (testNameData.strDrugName13 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName13);
                                            }
                                            if (testNameData.strDrugName14 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName14);
                                            }
                                            if (testNameData.strDrugName15 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName15);
                                            }
                                            if (testNameData.strDrugName16 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName16);
                                            }
                                            if (testNameData.strDrugName17 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName17);
                                            }
                                            if (testNameData.strDrugName18 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName18);
                                            }
                                            if (testNameData.strDrugName19 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName19);
                                            }
                                            if (testNameData.strDrugName20 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName20);
                                            }
                                            if (testNameData.strDrugName21 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName21);
                                            }
                                            if (testNameData.strDrugName22 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName22);
                                            }
                                            if (testNameData.strDrugName23 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName23);
                                            }
                                            if (testNameData.strDrugName24 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName24);
                                            }
                                            if (testNameData.strDrugName25 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName25);
                                            }
                                            if (testNameData.strDrugName26 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName26);
                                            }
                                            if (testNameData.strDrugName27 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName27);
                                            }
                                            if (testNameData.strDrugName28 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName28);
                                            }
                                            if (testNameData.strDrugName29 != "")
                                            {
                                                drugNames.Add(testNameData.strDrugName29);
                                            }

                                            for (int i = 0; i <= cells.Count - 1; i++)
                                            {
                                                var cell = cells[i];
                                                if (Regex.IsMatch(cell.InnerText, @"Placeholder\d+"))
                                                {
                                                    if (drugNames.Count > 0)
                                                    {
                                                        if (placeholderIndex < drugNames.Count)
                                                        {
                                                            var dataItem = drugNames[placeholderIndex];
                                                            UpdateCellContent(cell, dataItem ?? "");
                                                            placeholderIndex++;
                                                            isSlideUsed = true;
                                                        }
                                                    }
                                                    else if (drugNames.Count == 0)
                                                    {
                                                        var textBody = cell.GetFirstChild<A.TextBody>();
                                                        if (textBody != null)
                                                        {
                                                            var para = textBody.GetFirstChild<A.Paragraph>();
                                                            if (para != null)
                                                            {
                                                                var run = para.GetFirstChild<A.Run>();
                                                                if (run != null)
                                                                {
                                                                    var text = run.GetFirstChild<A.Text>();
                                                                    if (text != null)
                                                                    {
                                                                        text.Text = "No existing drug names found.";
                                                                        isSlideUsed = true;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                }
                                            }

                                        }
                                        rowIndex++;
                                    }
                                }
                                frameIndex++;
                                dataIndex++;
                            }

                            foreach (var graphicFrameContent in graphicFrameList)
                            {
                                A.Graphic graphic = graphicFrameContent.GetFirstChild<A.Graphic>();

                                foreach (var graphicData in graphic.Elements<A.GraphicData>())
                                {
                                    A.Table table = graphicData.GetFirstChild<A.Table>();
                                    if (table != null)
                                    {
                                        foreach (var row in table.Elements<A.TableRow>().ToList())
                                        {
                                            var cells = row.Elements<A.TableCell>().ToList();
                                            bool allPlaceholders = cells.All(cell => Regex.IsMatch(cell.InnerText, @"Placeholder\d+"));

                                            if (allPlaceholders)
                                            {
                                                row.Remove();
                                            }
                                            else
                                            {
                                                foreach (var cell in cells.ToList())
                                                {
                                                    if (Regex.IsMatch(cell.InnerText, @"Placeholder\d+"))
                                                    {
                                                        RemovePlaceholder(cell);
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }

                            foreach (var graphicFrameContent in graphicFrameList)
                            {
                                A.Graphic graphic = graphicFrameContent.GetFirstChild<A.Graphic>();

                                foreach (var graphicData in graphic.Elements<A.GraphicData>())
                                {
                                    A.Table table = graphicData.GetFirstChild<A.Table>();
                                    if (table != null)
                                    {
                                        foreach (var row in table.Elements<A.TableRow>().Skip(3).ToList())
                                        {
                                            var cells = row.Elements<A.TableCell>().ToList();
                                            bool allPlaceholders = cells.All(cell => Regex.IsMatch(cell.InnerText, @"No existing drug names found."));

                                            if (allPlaceholders)
                                            {
                                                row.Remove();
                                            }
                                            else
                                            {
                                                foreach (var cell in cells.ToList())
                                                {
                                                    if (Regex.IsMatch(cell.InnerText, @"No existing drug names found."))
                                                    {
                                                        RemovePlaceholder(cell);
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }

                            slidePart.Slide.Save();
                            slideIndex++;
                        }

                        var slideIdList1 = presentationDocument.PresentationPart.Presentation.SlideIdList;
                        var orderedSlideParts1 = slideIdList1
                                                    .ChildElements
                                                    .OfType<SlideId>()
                                                    .Select(slideId =>
                                                    presentationDocument.PresentationPart.GetPartById(slideId.RelationshipId) as SlidePart
                                                    ).ToList();


                        foreach (SlidePart slidePartList1 in orderedSlideParts1)
                        {
                            Slide slide1 = slidePartList1.Slide;
                            CommonSlideData commonSlideData1 = slide1.GetFirstChild<CommonSlideData>();
                            ShapeTree shapeTree1 = commonSlideData1.GetFirstChild<ShapeTree>();

                            var graphicFrameList = shapeTree1.Elements<P.GraphicFrame>().Reverse().ToList();

                            var unusedGraphicFrames = graphicFrameList
                                    .Where(gf => gf.InnerText.Contains("TESTNAME"))
                                    .ToList();

                            foreach (var unusedFrames in unusedGraphicFrames)
                            {
                                unusedFrames.Remove();
                            }

                            if (!isSlideUsed || !shapeTree1.Elements<P.GraphicFrame>().Any())
                            {
                                slidesToDelete.Add(slidePartList1);
                            }

                            foreach (var slideToDelete in slidesToDelete)
                            {
                                RemoveSlide(presentationDocument, slideToDelete);
                            }
                        }

                        presentationDocument.Save();

                        var slideIdList3 = presentationDocument.PresentationPart.Presentation.SlideIdList;

                        int dataIndex2 = 0;
                        int slideIndex2 = 0;

                        while (dataIndex2 < groupApiData.Count && slideIndex2 < slideIdList3.Count())
                        {
                            SlideId slideId3 = slideIdList3.ChildElements[slideIndex2] as SlideId;
                            SlidePart slidePart3 = (SlidePart)presentationDocument.PresentationPart.GetPartById(slideId3.RelationshipId);

                            Slide slide3 = slidePart3.Slide;
                            CommonSlideData commonSlideData3 = slide3.GetFirstChild<CommonSlideData>();
                            ShapeTree shapeTree3 = commonSlideData3.GetFirstChild<ShapeTree>();

                            var graphicFrameList3 = shapeTree3.Elements<P.GraphicFrame>()
                                            .OrderBy(frame => frame.Descendants<A.Text>().FirstOrDefault()?.Text).ToList();

                            isSlideUsed = false;
                            int frameIndex2 = 0;

                            while (dataIndex2 < groupApiData.Count && frameIndex2 < graphicFrameList3.Count)
                            {
                                var graphicFrameContent = graphicFrameList3[frameIndex2];
                                var graphic = graphicFrameContent.GetFirstChild<A.Graphic>();

                                var testNameGroup = groupApiData[dataIndex2];
                                var testNameData = testNameGroup;

                                foreach (var graphicData in graphic.Elements<A.GraphicData>())
                                {
                                    A.Table table = graphicData.GetFirstChild<A.Table>();

                                    foreach (var row in table.Elements<A.TableRow>().Skip(2))
                                    {
                                        var cells = row.Elements<A.TableCell>().ToList();

                                        if (cells.Count == 2)
                                        {
                                            var x = cells[0].InnerText;
                                            var y = cells[1].InnerText;

                                            if ((x != "") && (y != ""))
                                            {
                                                // do nothing
                                            }
                                            else
                                            {
                                                A.TableCell tableCell1 = row.GetFirstChild<A.TableCell>();
                                                A.TableCell tableCell2 = row.Elements<A.TableCell>().ElementAt(1);
                                                tableCell1.GridSpan = 2;
                                                tableCell2.HorizontalMerge = true;
                                            }
                                        }
                                    }
                                }
                                frameIndex2++;
                                dataIndex2++;
                            }
                            slideIndex2++;
                            slidePart3.Slide.Save();
                        }

                        var slideIdList4 = presentationDocument.PresentationPart.Presentation.SlideIdList;

                        int dataIndex4 = 0;
                        int slideIndex4 = 0;

                        while (dataIndex4 < groupApiData.Count && slideIndex4 < slideIdList4.Count())
                        {
                            SlideId slideId3 = slideIdList4.ChildElements[slideIndex4] as SlideId;
                            SlidePart slidePart3 = (SlidePart)presentationDocument.PresentationPart.GetPartById(slideId3.RelationshipId);

                            Slide slide3 = slidePart3.Slide;
                            CommonSlideData commonSlideData3 = slide3.GetFirstChild<CommonSlideData>();
                            ShapeTree shapeTree3 = commonSlideData3.GetFirstChild<ShapeTree>();

                            var graphicFrameList3 = shapeTree3.Elements<P.GraphicFrame>()
                                            .OrderBy(frame => frame.Descendants<A.Text>().FirstOrDefault()?.Text).ToList();

                            isSlideUsed = false;
                            int frameIndex2 = 0;

                            while (dataIndex4 < groupApiData.Count && frameIndex2 < graphicFrameList3.Count)
                            {
                                var graphicFrameContent = graphicFrameList3[frameIndex2];
                                var graphic = graphicFrameContent.GetFirstChild<A.Graphic>();

                                var testNameGroup = groupApiData[dataIndex4];
                                var testNameData = testNameGroup;

                                foreach (var graphicData in graphic.Elements<A.GraphicData>())
                                {
                                    A.Table table = graphicData.GetFirstChild<A.Table>();

                                    foreach (var row in table.Elements<A.TableRow>().Skip(2))
                                    {
                                        var cells = row.Elements<A.TableCell>().ToList();

                                        if (cells.Count == 2)
                                        {
                                            var x = cells[0].InnerText;
                                            var y = cells[1].InnerText;

                                            if ((x == "No existing drug names found.") && (y == "No existing drug names found."))
                                            {
                                                A.TableCell tableCell1 = row.GetFirstChild<A.TableCell>();
                                                A.TableCell tableCell2 = row.Elements<A.TableCell>().ElementAt(1);
                                                tableCell1.GridSpan = 2;
                                                tableCell2.HorizontalMerge = true;
                                            }
                                            else
                                            {
                                                // do nothing
                                            }
                                        }
                                    }
                                }
                                frameIndex2++;
                                dataIndex4++;
                            }
                            slideIndex4++;
                            slidePart3.Slide.Save();
                        }

                        presentationDocument.Save();


                    }

                    presentationDocument.Save();                 
                }             
            }
            catch (Exception ex)
            {
                Console.WriteLine("Error processing presentation: " + ex.Message);
            }
        }

        // QTC 
        public void QTCTemplate(string destination, List<QTCModel> apiData)
        {
            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(destination, true))
                {
                    SlidePart slidePart = presentationDocument?.PresentationPart.SlideParts.FirstOrDefault();
                    if (slidePart != null)
                    {
                        for (int row = 1; row <= apiData.Count; row++)
                        {
                            for (int cell = 1; cell < 11; cell++)
                            {
                                var testname = string.Empty;
                                bool isBold = false;
                                var chartValue = 0.00;
                                var color = string.Empty;

                                var api = apiData[row - 1];

                                if (cell == 1)
                                {
                                    testname = api.strTestNamePage1;
                                    isBold = (bool)api.boolBoldPage1;
                                    color = $"#{(int)api.intRedPage1:X2}{(int)api.intGreenPage1:X2}{(int)api.intBluePage1:X2}";
                                    ChangeSlidePartFillACell(slidePart, testname, row, cell, color, isBold);
                                }
                                else if (cell == 2)
                                {
                                    isBold = (bool)api.boolBoldPage1;
                                    chartValue = Math.Round(Convert.ToDouble(api.dblAveragePage1), 2);
                                    color = $"#{(int)api.intRedPage1:X2}{(int)api.intGreenPage1:X2}{(int)api.intBluePage1:X2}";
                                    ChangeSlidePartFillACellForInteger(slidePart, chartValue, row, cell, color, isBold);
                                }
                                else if (cell == 3)
                                {
                                    testname = api.strTestNamePage2;
                                    isBold = (bool)api.boolBoldPage2;
                                    color = $"#{(int)api.intRedPage2:X2}{(int)api.intGreenPage2:X2}{(int)api.intBluePage2:X2}";
                                    ChangeSlidePartFillACell(slidePart, testname, row, cell, color, isBold);
                                }
                                else if (cell == 4)
                                {
                                    isBold = (bool)api.boolBoldPage2;
                                    chartValue = Math.Round(Convert.ToDouble(api.dblAveragePage2), 2);
                                    color = $"#{(int)api.intRedPage2:X2}{(int)api.intGreenPage2:X2}{(int)api.intBluePage2:X2}";
                                    ChangeSlidePartFillACellForInteger(slidePart, chartValue, row, cell, color, isBold);
                                }
                                else if (cell == 5)
                                {
                                    //memorability
                                    testname = api.strTestNamePage3;
                                    isBold = (bool)api.boolBoldPage3;
                                    color = $"#{(int)api.intRedPage3:X2}{(int)api.intGreenPage3:X2}{(int)api.intBluePage3:X2}";
                                    ChangeSlidePartFillACell(slidePart, testname, row, cell, color, isBold);
                                }

                                else if (cell == 6)
                                {
                                    isBold = (bool)api.boolBoldPage3;
                                    chartValue = Math.Round(Convert.ToDouble(api.dblPercentagePage3), 2);
                                    color = $"#{(int)api.intRedPage3:X2}{(int)api.intGreenPage3:X2}{(int)api.intBluePage3:X2}";
                                    FillBrandexSafetyValuesForMemorability(slidePart, chartValue, row, cell, color, isBold);
                                }

                                else if (cell == 7)
                                {
                                    testname = api.strTestNamePage4;
                                    isBold = (bool)api.boolBoldPage4;
                                    color = $"#{(int)api.intRedPage4:X2}{(int)api.intGreenPage4:X2}{(int)api.intBluePage4:X2}";
                                    ChangeSlidePartFillACell(slidePart, testname, row, cell, color, isBold);
                                }

                                else if (cell == 8)
                                {
                                    isBold = (bool)api.boolBoldPage4;
                                    chartValue = Math.Round(Convert.ToDouble(api.dblAveragePage4), 2);
                                    color = $"#{(int)api.intRedPage4:X2}{(int)api.intGreenPage4:X2}{(int)api.intBluePage4:X2}";
                                    ChangeSlidePartFillACellForInteger(slidePart, chartValue, row, cell, color, isBold);
                                }

                                else if (cell == 9)
                                {
                                    testname = api.strTestNamePage5;
                                    isBold = (bool)api.boolBoldPage5;
                                    color = $"#{(int)api.intRedPage5:X2}{(int)api.intGreenPage5:X2}{(int)api.intBluePage5:X2}";
                                    ChangeSlidePartFillACell(slidePart, testname, row, cell, color, isBold);
                                }

                                else if (cell == 10)
                                {
                                    isBold = (bool)api.boolBoldPage5;
                                    chartValue = Math.Round(Convert.ToDouble(api.dblAveragePage5), 2);
                                    color = $"#{(int)api.intRedPage5:X2}{(int)api.intGreenPage5:X2}{(int)api.intBluePage5:X2}";
                                    ChangeSlidePartFillACellForInteger(slidePart, chartValue, row, cell, color, isBold);
                                }
                            }
                        }

                        Slide slide1 = slidePart.Slide;
                        if (slide1 != null)
                        {
                            CommonSlideData commonSlideData1 = slide1?.GetFirstChild<CommonSlideData>();
                            if (commonSlideData1 != null)
                            {
                                ShapeTree shapeTree1 = commonSlideData1?.GetFirstChild<ShapeTree>();
                                if (shapeTree1 != null)
                                {
                                    var firstShape = shapeTree1?.GetFirstChild<P.Shape>();
                                    if (firstShape != null)
                                    {
                                        var firstShapeTextBody = firstShape?.GetFirstChild<P.TextBody>();
                                        if (firstShapeTextBody != null)
                                        {
                                            var firstParagraph = firstShapeTextBody?.GetFirstChild<A.Paragraph>();
                                            if (firstParagraph != null)
                                            {
                                                foreach (var run in firstParagraph.Elements<A.Run>())
                                                {
                                                    if (run != null)
                                                    {
                                                        A.Text text2 = run?.GetFirstChild<A.Text>();
                                                        if (text2 != null)
                                                        {
                                                            if (text2.Text.Contains("Quantitative Topline Chart - Marketing "))
                                                            {
                                                                continue;
                                                            }

                                                            else if (text2.Text.Contains("Results (<<Breakdown>>)"))
                                                            {
                                                                text2.Text = $"Results (Overall Text)";
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }

                                P.GraphicFrame graphicFrame1 = shapeTree1?.GetFirstChild<P.GraphicFrame>();
                                if (graphicFrame1 != null)
                                {
                                    A.Graphic graphic1 = graphicFrame1?.GetFirstChild<A.Graphic>();
                                    if (graphic1 != null)
                                    {
                                        A.GraphicData graphicData1 = graphic1?.GetFirstChild<A.GraphicData>();
                                        if (graphicData1 != null)
                                        {
                                            A.Table table1 = graphicData1?.GetFirstChild<A.Table>();
                                            if (table1 != null)
                                            {
                                                var tableRows = table1.Elements<A.TableRow>().ToList();
                                                if (tableRows.Count > 0)
                                                {
                                                    for (int rowIndex = apiData.Count + 1; rowIndex < tableRows.Count; rowIndex++)
                                                    {
                                                        tableRows[rowIndex].Remove();
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }



        public string formulaChanges(char cell, int length)
        {
            var f = $"Sheet1!${cell.ToString()}$2:${cell.ToString()}${length.ToString()}";
            return f;
        }


        public void ChangeSlidePartFillACell(SlidePart slidePart1, string celltext, int row, int cell, string color, bool isBold)
        {
            Slide slide1 = slidePart1.Slide;

            CommonSlideData commonSlideData1 = slide1.GetFirstChild<CommonSlideData>();

            ShapeTree shapeTree1 = commonSlideData1.GetFirstChild<ShapeTree>();

            P.GraphicFrame graphicFrame1 = shapeTree1.GetFirstChild<P.GraphicFrame>();

            P.NonVisualGraphicFrameProperties nonVisualGraphicFrameProperties1 = graphicFrame1.GetFirstChild<P.NonVisualGraphicFrameProperties>();

            A.Graphic graphic1 = graphicFrame1.GetFirstChild<A.Graphic>();

            A.GraphicData graphicData1 = graphic1.GetFirstChild<A.GraphicData>();

            A.Table table1 = graphicData1.GetFirstChild<A.Table>();

            A.TableRow tableRow1 = table1.Elements<A.TableRow>().ElementAt(row);

            A.TableCell tableCell1 = tableRow1.Elements<A.TableCell>().ElementAt(cell);

            A.TextBody textBody1 = tableCell1.GetFirstChild<A.TextBody>();

            A.Paragraph paragraph1 = textBody1.GetFirstChild<A.Paragraph>();

            A.EndParagraphRunProperties endParagraphRunProperties1 = paragraph1.GetFirstChild<A.EndParagraphRunProperties>();

            A.Run run1 = new A.Run();

            A.RunProperties runProperties1 = new A.RunProperties() { Language = "en-US", FontSize = 1400, Bold = isBold, Italic = false, Underline = A.TextUnderlineValues.None, Strike = A.TextStrikeValues.NoStrike, Dirty = false };

            A.SolidFill solidFill1 = new A.SolidFill();

            A.RgbColorModelHex rgbColorModelHex1 = new A.RgbColorModelHex() { Val = color.TrimStart('#') };

            solidFill1.Append(rgbColorModelHex1);

            A.EffectList effectList1 = new A.EffectList();

            A.LatinFont latinFont1 = new A.LatinFont() { Typeface = "+mn-lt" };

            runProperties1.Append(solidFill1);

            runProperties1.Append(effectList1);

            runProperties1.Append(latinFont1);

            A.Text text1 = new A.Text();

            text1.Text = celltext;

            run1.Append(runProperties1);

            run1.Append(text1);

            paragraph1.InsertBefore(run1, endParagraphRunProperties1);

            // endParagraphRunProperties1.Remove();

        }

        public void ChangeSlidePartFillACellForInteger(SlidePart slidePart1, double chartValue, int row, int cell, string color, bool isBold)
        {
            Slide slide1 = slidePart1.Slide;

            CommonSlideData commonSlideData1 = slide1.GetFirstChild<CommonSlideData>();

            ShapeTree shapeTree1 = commonSlideData1.GetFirstChild<ShapeTree>();

            P.GraphicFrame graphicFrame1 = shapeTree1.GetFirstChild<P.GraphicFrame>();

            P.NonVisualGraphicFrameProperties nonVisualGraphicFrameProperties1 = graphicFrame1.GetFirstChild<P.NonVisualGraphicFrameProperties>();

            A.Graphic graphic1 = graphicFrame1.GetFirstChild<A.Graphic>();

            A.GraphicData graphicData1 = graphic1.GetFirstChild<A.GraphicData>();

            A.Table table1 = graphicData1.GetFirstChild<A.Table>();

            A.TableRow tableRow1 = table1.Elements<A.TableRow>().ElementAt(row);

            A.TableCell tableCell1 = tableRow1.Elements<A.TableCell>().ElementAt(cell);

            A.TextBody textBody1 = tableCell1.GetFirstChild<A.TextBody>();

            A.Paragraph paragraph1 = textBody1.GetFirstChild<A.Paragraph>();

            A.EndParagraphRunProperties endParagraphRunProperties1 = paragraph1.GetFirstChild<A.EndParagraphRunProperties>();

            A.Run run1 = new A.Run();

            A.RunProperties runProperties1 = new A.RunProperties() { Language = "en-US", FontSize = 1400, Bold = isBold, Italic = false, Underline = A.TextUnderlineValues.None, Strike = A.TextStrikeValues.NoStrike, Dirty = false };

            A.SolidFill solidFill1 = new A.SolidFill();

            A.RgbColorModelHex rgbColorModelHex1 = new A.RgbColorModelHex() { Val = color.TrimStart('#') };

            solidFill1.Append(rgbColorModelHex1);

            A.EffectList effectList1 = new A.EffectList();

            A.LatinFont latinFont1 = new A.LatinFont() { Typeface = "+mn-lt" };

            runProperties1.Append(solidFill1);

            runProperties1.Append(effectList1);

            runProperties1.Append(latinFont1);

            A.Text text1 = new A.Text();

            text1.Text = chartValue.ToString("F2");

            run1.Append(runProperties1);

            run1.Append(text1);

            paragraph1.InsertBefore(run1, endParagraphRunProperties1);




            // endParagraphRunProperties1.Remove();

        }


        public void FillBrandexSafetyValuesForMemorability(SlidePart slidePart1, double chartValue, int row, int cell, string color, bool isBold)
        {
            Slide slide1 = slidePart1.Slide;

            CommonSlideData commonSlideData1 = slide1.GetFirstChild<CommonSlideData>();

            ShapeTree shapeTree1 = commonSlideData1.GetFirstChild<ShapeTree>();

            P.GraphicFrame graphicFrame1 = shapeTree1.GetFirstChild<P.GraphicFrame>();

            P.NonVisualGraphicFrameProperties nonVisualGraphicFrameProperties1 = graphicFrame1.GetFirstChild<P.NonVisualGraphicFrameProperties>();

            A.Graphic graphic1 = graphicFrame1.GetFirstChild<A.Graphic>();

            A.GraphicData graphicData1 = graphic1.GetFirstChild<A.GraphicData>();

            A.Table table1 = graphicData1.GetFirstChild<A.Table>();

            A.TableRow tableRow1 = table1.Elements<A.TableRow>().ElementAt(row);

            A.TableCell tableCell1 = tableRow1.Elements<A.TableCell>().ElementAt(cell);

            A.TextBody textBody1 = tableCell1.GetFirstChild<A.TextBody>();

            A.Paragraph paragraph1 = textBody1.GetFirstChild<A.Paragraph>();

            A.EndParagraphRunProperties endParagraphRunProperties1 = paragraph1.GetFirstChild<A.EndParagraphRunProperties>();

            A.Run run1 = new A.Run();

            A.RunProperties runProperties1 = new A.RunProperties() { Language = "en-US", FontSize = 1200, Bold = isBold, Italic = false, Underline = A.TextUnderlineValues.None, Strike = A.TextStrikeValues.NoStrike, Dirty = false };

            A.SolidFill solidFill1 = new A.SolidFill();

            A.RgbColorModelHex rgbColorModelHex1 = new A.RgbColorModelHex() { Val = color.TrimStart('#') };

            solidFill1.Append(rgbColorModelHex1);

            A.EffectList effectList1 = new A.EffectList();

            A.LatinFont latinFont1 = new A.LatinFont() { Typeface = "+mn-lt" };

            runProperties1.Append(solidFill1);

            runProperties1.Append(effectList1);

            runProperties1.Append(latinFont1);

            A.Text text1 = new A.Text();

            text1.Text = chartValue.ToString("F1");

            run1.Append(runProperties1);

            run1.Append(text1);

            paragraph1.InsertBefore(run1, endParagraphRunProperties1);
        }


        private void RemoveSlide(PresentationDocument presentationDocument, SlidePart slidePart)
        {
            var slideIdList = presentationDocument?.PresentationPart?.Presentation.SlideIdList;
            var slideId = slideIdList?.Elements<SlideId>()
                                     .FirstOrDefault(sid => slidePart == presentationDocument?.PresentationPart.GetPartById(sid.RelationshipId));

            if (slideId != null)
            {
                slideIdList?.RemoveChild(slideId);
                presentationDocument.PresentationPart.DeletePart(slidePart);
            }
        }

        private static void RemovePlaceholder(A.TableCell cell)
        {
            var textBody = cell?.GetFirstChild<A.TextBody>();

            var paragraph = textBody?.GetFirstChild<A.Paragraph>();

            var run = paragraph?.GetFirstChild<A.Run>();

            var text = run?.GetFirstChild<A.Text>();
            if (text != null)
            {
                text.Text = ""; // Clear the placeholder text
            }
        }

        private static void UpdateCellContent(A.TableCell cell, string newText)
        {
            var textBody = cell?.GetFirstChild<A.TextBody>();

            var paragraph = textBody?.GetFirstChild<A.Paragraph>();

            var run = paragraph?.GetFirstChild<A.Run>();

            var text = run?.GetFirstChild<A.Text>();
            if (text != null)
            {
                text.Text = newText;
            }
        }

        private static void UpdateCellContentForSALA(A.TableCell cell, string newText, string color)
        {
            var textBody = cell?.GetFirstChild<A.TextBody>();

            var paragraph = textBody?.GetFirstChild<A.Paragraph>();

            var run = paragraph?.GetFirstChild<A.Run>();

            var runProp = run?.GetFirstChild<A.RunProperties>();

            if (color.TrimStart('#') == "FF0000")
            {
                runProp.Bold = false;
            }

            var solidFill1 = runProp?.GetFirstChild<A.SolidFill>();

            var schemeColor1 = solidFill1?.GetFirstChild<A.SchemeColor>();

            A.RgbColorModelHex rgbColorModelHex1 = new A.RgbColorModelHex() { Val = color.TrimStart('#') };
            solidFill1.InsertBefore(rgbColorModelHex1, schemeColor1);

            schemeColor1?.Remove();

            var text = run?.GetFirstChild<A.Text>();
            if (text != null)
            {
                text.Text = newText;
            }
        }

    }


}
